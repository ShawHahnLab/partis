[92mcache-parameters-data[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --infname test/paired-data/all-seqs.fa --parameter-dir test/paired/new-results/test/parameters/data --n-max-queries 100 --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[91mrun[0m /home/dralph/work/partis/bin/extract-pairing-info.py test/paired-data/all-seqs.fa /tmp/dralph/hmms/137792/meta.yaml --n-max-queries 100
  --n-max-queries: chose 48 / 48 droplets (first 100, after sorting alphabetically by droplet id) which had 100 / 100 seqs
  extract_pairing_info(): read 100 sequences with 48 droplet ids
    droplet id separators (set automatically): _  indices: [0]
       e.g. uid 'AAACCTGAGAGACGAA-1_contig_2' --> droplet id 'AAACCTGAGAGACGAA-1' contig id '2'
    contigs per
      droplet     count   fraction
        1            2     0.042
        2           42     0.875
        3            2     0.042
        4            2     0.042
[91mrun[0m /home/dralph/work/partis/bin/split-loci.py test/paired-data/all-seqs.fa --outdir /tmp/dralph/hmms/137792 --input-metafname /tmp/dralph/hmms/137792/meta.yaml --n-max-queries 100
  --n-max-queries: chose 48 / 48 droplets (first 100, after sorting alphabetically by droplet id) which had 100 / 100 seqs
  --input-metafnames: added meta info for 100 sequences from /tmp/dralph/hmms/137792/meta.yaml: paired-uids
    read pairing info for 100 seqs from input meta file
  running vsearch on 100 sequences:
    igh:   49 / 100 v annotations (51 failed) with 28 v genes in 0.1 sec
    igk:   40 / 100 v annotations (60 failed) with 18 v genes in 0.1 sec
    igl:   15 / 100 v annotations (85 failed) with 12 v genes in 0.1 sec
totals: igh 48 igk 37 igl 15
  removed 0 failed uids from paired_uids
            count  frac  paired with
       [94mh[0m      31   0.65   [95mk[0m
              11   0.23   [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [95mk[0m
               1   0.02   [92ml[0m [92ml[0m
               1   0.02   [95mk[0m [92ml[0m
       [95mk[0m      31   0.84   [94mh[0m
               2   0.05   
               2   0.05   [94mh[0m [94mh[0m [95mk[0m
               1   0.03   [94mh[0m [94mh[0m [92ml[0m
               1   0.03   [94mh[0m [92ml[0m
       [92ml[0m      11   0.73   [94mh[0m
               2   0.13   [94mh[0m [92ml[0m
               1   0.07   [94mh[0m [94mh[0m [95mk[0m
               1   0.07   [94mh[0m [95mk[0m
writing to /tmp/dralph/hmms/137792/
  igh: 48 to 137792/igh.fa
  igk: 37 to 137792/igk.fa
  igl: 15 to 137792/igl.fa
writing to paired subdirs
    36/48 igh seqs pair with igk
      igh: 36 to igh+igk/igh.fa
      igk: 37 to igh+igk/igk.fa
    15/48 igh seqs pair with igl
      igh: 15 to igh+igl/igh.fa
      igl: 15 to igh+igl/igl.fa
[44mcache-parameters[0m [94migh[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --infname /tmp/dralph/hmms/137792/igh.fa --parameter-dir test/paired/new-results/test/parameters/data/igh --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results/test/parameters/data/igh/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/137792/meta.yaml
  --input-metafnames: added meta info for 48 sequences from /tmp/dralph/hmms/137792/meta.yaml: paired-uids
caching parameters
  vsearch: 48 / 48 v annotations (0 failed) with 27 v genes in 0.1 sec
    keeping 23 / 198 v genes
smith-waterman  (new-allele fitting)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/data/igh/sw-cache.yaml
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
        writing sw results to test/paired/new-results/test/parameters/data/igh/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igh/sw (2.5 sec)
    water time: 2.7  (ig-sw 2.6  processing 0.1)
  writing hmms     removed 13 genes from glfo (leaving v 23  d 19  j 6)
(0.2 sec)
hmm
    reading output
        read 48 hmm output lines with 48 sequences in 48 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igh/hmm (2.3 sec)
         infra time: 2.4
      hmm step time: 2.8
  writing hmms     removed 1  genes from glfo (leaving v 23  d 18  j 6)
(0.2 sec)
      total time: 6.5
[44mcache-parameters[0m [94migk[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --infname /tmp/dralph/hmms/137792/igk.fa --parameter-dir test/paired/new-results/test/parameters/data/igk --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results/test/parameters/data/igk/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/137792/meta.yaml
  --input-metafnames: added meta info for 37 sequences from /tmp/dralph/hmms/137792/meta.yaml: paired-uids
caching parameters
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    keeping 16 / 64 v genes
smith-waterman  (new-allele fitting)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/data/igk/sw-cache.yaml
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.0 sec
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
        writing sw results to test/paired/new-results/test/parameters/data/igk/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igk/sw (1.8 sec)
    water time: 2.0  (ig-sw 1.9  processing 0.1)
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)
(0.1 sec)
hmm
    reading output
        read 37 hmm output lines with 37 sequences in 37 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igk/hmm (1.6 sec)
         infra time: 1.7
      hmm step time: 1.9
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)
(0.1 sec)
      total time: 4.6
[44mcache-parameters[0m [94migl[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --infname /tmp/dralph/hmms/137792/igl.fa --parameter-dir test/paired/new-results/test/parameters/data/igl --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results/test/parameters/data/igl/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/137792/meta.yaml
  --input-metafnames: added meta info for 15 sequences from /tmp/dralph/hmms/137792/meta.yaml: paired-uids
caching parameters
  vsearch: 15 / 15 v annotations (0 failed) with 12 v genes in 0.1 sec
    keeping 10 / 80 v genes
smith-waterman  (new-allele fitting)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/data/igl/sw-cache.yaml
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.0 sec
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
        writing sw results to test/paired/new-results/test/parameters/data/igl/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igl/sw (1.3 sec)
    water time: 1.4  (ig-sw 1.3  processing 0.1)
  writing hmms     removed 6  genes from glfo (leaving v 10  d 1  j 3)
(0.1 sec)
hmm
    reading output
        read 15 hmm output lines with 15 sequences in 15 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igl/hmm (1.0 sec)
         infra time: 1.0
      hmm step time: 1.2
  writing hmms     removed 0  genes from glfo (leaving v 10  d 1  j 3)
(0.1 sec)
      total time: 3.1
      [93mwarning[0m expected to remove 1/11 files+dirs that weren't in /tmp/dralph/hmms/137792/: failed.fa
      total time: 16.0
[92msimulate[0m                         /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --paired-loci --parameter-dir test/paired/new-results/test/parameters/data --n-sim-events 10 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/test/simu --indel-frequency 0.2
    cleaning paired files in test/paired/new-results/test/simu/
[94migh+igk[0m: simulating 7 events
[44mgenerate-trees[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-trees 7 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 2003260051 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results/test/simu/igh+igk/trees.nwk
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 7 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 7 trees:   depth 0.01927   leaves 5.57
    writing trees to test/paired/new-results/test/simu/igh+igk/trees.nwk
      total time: 1.5
[44msimulate[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-sim-events 7 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 2003260051 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results/test/simu/igh+igk/igh.yaml --input-simulation-treefname test/paired/new-results/test/simu/igh+igk/trees.nwk
  note: reducing --n-procs to 7 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 0
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/988927/trees-sub-0.nwk
    made 1 event with 12 seqs in 0.3s (0.2s of which was running bppseqgen)
      total time: 0.6

      --> proc 1
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/988927/trees-sub-1.nwk
    made 1 event with 3 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.5

      --> proc 2
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/988927/trees-sub-2.nwk
    made 1 event with 3 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.5

      --> proc 3
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/988927/trees-sub-3.nwk
    made 1 event with 2 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.5

      --> proc 4
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/988927/trees-sub-4.nwk
    made 1 event with 2 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.5

      --> proc 5
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/988927/trees-sub-5.nwk
    made 1 event with 9 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.5

      --> proc 6
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/988927/trees-sub-6.nwk
    made 1 event with 8 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.5

   read 7 events with 39 seqs from 7 .yaml files
      total time: 1.4
[44msimulate[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igk --n-sim-events 7 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 2077655082 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results/test/simu/igh+igk/igk.yaml --input-simulation-treefname test/paired/new-results/test/simu/igh+igk/trees.nwk
  note: reducing --n-procs to 7 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 0
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/528837/trees-sub-0.nwk
    made 1 event with 12 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.6

      --> proc 1
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/528837/trees-sub-1.nwk
    made 1 event with 3 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 2
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/528837/trees-sub-2.nwk
    made 1 event with 3 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.5

      --> proc 3
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/528837/trees-sub-3.nwk
    made 1 event with 2 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.5

      --> proc 4
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/528837/trees-sub-4.nwk
    made 1 event with 2 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.5

      --> proc 5
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/528837/trees-sub-5.nwk
    made 1 event with 9 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.4

      --> proc 6
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/528837/trees-sub-6.nwk
    made 1 event with 8 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.6

   read 7 events with 39 seqs from 7 .yaml files
      total time: 1.4
[94migh+igl[0m: simulating 3 events
[44mgenerate-trees[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-trees 3 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 982264879 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results/test/simu/igh+igl/trees.nwk
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 3 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 3 trees:   depth 0.04762   leaves 9.00
    writing trees to test/paired/new-results/test/simu/igh+igl/trees.nwk
      total time: 1.5
[44msimulate[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-sim-events 3 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 982264879 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results/test/simu/igh+igl/igh.yaml --input-simulation-treefname test/paired/new-results/test/simu/igh+igl/trees.nwk
  note: reducing --n-procs to 3 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 0
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/299504/trees-sub-0.nwk
    made 1 event with 14 seqs in 0.3s (0.2s of which was running bppseqgen)
      total time: 0.5

      --> proc 1
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/299504/trees-sub-1.nwk
    made 1 event with 3 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 2
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/299504/trees-sub-2.nwk
    made 1 event with 10 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.5

   read 3 events with 27 seqs from 3 .yaml files
      total time: 1.2
[44msimulate[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igl --n-sim-events 3 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 1083609742 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results/test/simu/igh+igl/igl.yaml --input-simulation-treefname test/paired/new-results/test/simu/igh+igl/trees.nwk
  note: reducing --n-procs to 3 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 0
    reco params: test/paired/new-results/test/parameters/data/igl/hmm     shm params: test/paired/new-results/test/parameters/data/igl/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/242475/trees-sub-0.nwk
    made 1 event with 14 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.5

      --> proc 1
    reco params: test/paired/new-results/test/parameters/data/igl/hmm     shm params: test/paired/new-results/test/parameters/data/igl/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/242475/trees-sub-1.nwk
    made 1 event with 3 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 2
    reco params: test/paired/new-results/test/parameters/data/igl/hmm     shm params: test/paired/new-results/test/parameters/data/igl/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/242475/trees-sub-2.nwk
    made 1 event with 10 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.4

   read 3 events with 27 seqs from 3 .yaml files
      total time: 1.1
[94migh+igk[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results/test/simu/igh+igk/
[94migh+igl[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results/test/simu/igh+igl/
  apportioned 132 seqs among 52 droplets (mean/2 1.3): 4 2 2 2 2 4 2 2 2 2 2 2 4 2 2 2 4 4 2 2 4 2 2 2 2 2 2 4 2 2 4 2 4 2 2 2 2 2 2 2 2 2 4 4 2 4 2 2 2 4 4 2
  removed 19 / 132 = 0.14 seqs from outfos (leaving 7 / 113 unpaired)
    writing combined h/l info to fasta and meta files in test/paired/new-results/test/simu
      total time: 10.4
[92mcache-parameters-simu[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --paired-indir test/paired/new-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --is-simu --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[44mcache-parameters[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results/test/simu/igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 56 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 56 / 56 v annotations (0 failed) with 9 v genes in 0.1 sec
    keeping 6 / 198 v genes
    [91mmissing[0m 17 simulation genes (counts): [95mh[0m[91mv[0m[95m1[0m[95m-18[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-46[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-8[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-5[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-11[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-15[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-20[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-21[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-23[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-48[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-66[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-74[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-9[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-31[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-4[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93m01[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 56 / 56 v annotations (0 failed) with 6 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
    running 10 procs for 56 seqs
      info for 56 / 56 = 1.000   (removed: 0 failed)
      kept 25 (0.446) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 56 / 56 v annotations (0 failed) with 6 v genes in 0.1 sec
    running 10 procs for 56 seqs
      info for 56 / 56 = 1.000   (removed: 0 failed)
      kept 25 (0.446) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igh/sw (0.9 sec)
    water time: 1.1  (ig-sw 1.0  processing 0.1)
  writing hmms     removed 16 genes from glfo (leaving v 6  d 18  j 4)
(0.1 sec)
hmm
    reading output
        read 56 hmm output lines with 56 sequences in 56 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igh/hmm (0.6 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igh/true (0.5 sec)
         infra time: 1.2
      hmm step time: 1.6
  writing hmms     removed 3  genes from glfo (leaving v 6  d 15  j 4)
(0.1 sec)
      total time: 3.3
[44mcache-parameters[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results/test/simu/igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 36 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 36 / 36 v annotations (0 failed) with 6 v genes in 0.0 sec
    keeping 5 / 64 v genes
    [91mmissing[0m 11 simulation genes (counts): [95mk[0m[91mv[0m[95m1[0m[95m-12[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-27[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-5[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-8[0m[93m03[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-9[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1D[0m[95m-39[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m2[0m[95m-24[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m2D[0m[95m-28[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m3[0m[95m-20[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m4[0m[95m-1[0m[93m02[0m 0  [95mk[0m[91mv[0m[95m6[0m[95m-21[0m[93m01[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
    running 10 procs for 36 seqs
    running 11 procs for 2 seqs
      info for 36 / 36 = 1.000   (removed: 0 failed)
      kept 14 (0.389) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.1 sec
    running 10 procs for 36 seqs
    running 11 procs for 2 seqs
      info for 36 / 36 = 1.000   (removed: 0 failed)
      kept 14 (0.389) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igk/sw (0.8 sec)
    water time: 1.0  (ig-sw 0.9  processing 0.1)
  writing hmms     removed 2  genes from glfo (leaving v 5  d 1  j 5)
(0.1 sec)
hmm
    reading output
        read 36 hmm output lines with 36 sequences in 36 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igk/hmm (0.5 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igk/true (0.5 sec)
         infra time: 1.1
      hmm step time: 1.3
  writing hmms     removed 0  genes from glfo (leaving v 5  d 1  j 5)
(0.1 sec)
      total time: 2.9
[44mcache-parameters[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results/test/simu/igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 21 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.0 sec
    keeping 3 / 80 v genes
    [91mmissing[0m 7 simulation genes (counts): [95ml[0m[91mv[0m[95m1[0m[95m-51[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-1[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-19[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-27[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m4[0m[95m-60[0m[93m03[0m 0  [95ml[0m[91mv[0m[95m7[0m[95m-46[0m[93m04[0m 0  [95ml[0m[91mv[0m[95m8[0m[95m-61[0m[93m01[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
    running 10 procs for 21 seqs
      info for 21 / 21 = 1.000   (removed: 0 failed)
      kept 14 (0.667) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.0 sec
    running 10 procs for 21 seqs
      info for 21 / 21 = 1.000   (removed: 0 failed)
      kept 14 (0.667) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igl/sw (0.5 sec)
    water time: 0.7  (ig-sw 0.6  processing 0.1)
  writing hmms     removed 7  genes from glfo (leaving v 3  d 1  j 2)
(0.1 sec)
hmm
    reading output
        read 21 hmm output lines with 21 sequences in 21 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igl/hmm (0.3 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igl/true (0.3 sec)
         infra time: 0.7
      hmm step time: 0.9
  writing hmms     removed 0  genes from glfo (leaving v 3  d 1  j 2)
(0.1 sec)
      total time: 2.0
      total time: 9.3
[92mpartition-new-simu[0m               /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/partition-new-simu
  [93mwarning[0m ignoring --plot-annotation-performance for paired clustering since it's going to be a bit fiddly to implement
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/test/simu/igh.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 56 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 56 / 56 v annotations (0 failed) with 6 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 56 / 56 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 25 (0.446) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 1 queries with different true and inferred net shm indel lengths: db63559ea9-igh
(0.0 sec)
        water time: 0.5
hmm
  caching all 56 naive sequences (0.4s)
    collapsed 56 queries into 50 clusters with identical naive seqs (0.0 sec)
  50 clusters with 10 procs (0.4s)
   44 clusters with 7 procs (0.5s)
   36 clusters with 5 procs (0.4s)
   33 clusters with 3 procs (0.5s)
   27 clusters with 2 procs (0.5s)
   23 clusters with 1 proc (0.9s)
   [93mnote[0m not merging entire cpath history
      partition loop time: 3.2
getting annotations for final partition
  subcluster annotating 19 clusters with steps:  (0.3s) (0.2s)   plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 1 queries with different true and inferred net shm indel lengths: db63559ea9-igh
(0.0 sec)

    subcluster annotation time 0.6
      total time: 4.8
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igk --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/test/simu/igk.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 36 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 36 / 36 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.389) unproductive
  plotting performance (0.0 sec)
        water time: 0.5
hmm
  caching all 36 naive sequences (0.2s)
    collapsed 36 queries into 7 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 7
  7 clusters with 7 procs (0.2s)
   7 clusters with 5 procs (0.2s)
   7 clusters with 3 procs (0.2s)
   6 clusters with 2 procs (0.2s)
   6 clusters with 1 proc (0.3s)
       partition loop time: 0.9
getting annotations for final partition
  subcluster annotating 6 clusters with steps:  (0.2s) (0.1s) (0.1s)   plotting performance (0.0 sec)

    subcluster annotation time 0.5
      total time: 2.2
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igl --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/test/simu/igl.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 21 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 21 / 21 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.667) unproductive
  plotting performance (0.0 sec)
        water time: 0.4
hmm
  caching all 21 naive sequences (0.2s)
    collapsed 21 queries into 3 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 3
  3 clusters with 3 procs (0.1s)
   3 clusters with 2 procs (0.1s)
   3 clusters with 1 proc (0.2s)
       partition loop time: 0.4
getting annotations for final partition
  subcluster annotating 3 clusters with steps:  (0.2s) (0.1s) (0.1s)   plotting performance (0.0 sec)

    subcluster annotation time 0.4
      total time: 1.5
[44mcombining[0m chains
   cleaning pair info for 113 seqs
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
    truncating x bins 3 --> 12 and ybins 5 --> 12
    truncating x bins 6 --> 15 and ybins 13 --> 15
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:      [93mwarning[0m adding missing per-seq key: mut_positions
  note: added 1 new input meta key to allowed keys (add 's'/plural to access it in the final annotations): mut_position (mut_positions)
11 total unpaired,  [94mh[0m 7  [95mk[0m 4
    merging igh+igk partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m   14 --> 15   [91m+1[0m
        [95mk[0m    6 --> 15   [91m+9[0m
    re-added unpaired seqs ([94mh[0m 7, [95mk[0m 4) to give total seqs in joint partitions: [94mh[0m 39  [95mk[0m 36
    [93mwarning[0m removed 2/34 uids (leaving 32) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 2 / 39 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 5 / 39 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   0.964  0.675
       joint   0.915  0.732
  [95mk[0m ccfs:     purity  completeness
      single   0.949  1.000
       joint   0.963  0.594
  merge time 0.0
  need to get annotations for 11/18 joint igh clusters
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igk/meta-igh.yaml --input-partition-fname test/paired/new-results/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 39 sequences from test/paired/new-results/partition-new-simu/igh+igk/meta-igh.yaml: loci paired-uids
  --input-partition-fname: read best partition with 39 sequences in 18 clusters from test/paired/new-results/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 39 / 39 v annotations (0 failed) with 6 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 39 / 39 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.359) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '09f5010bd3-igh': [['09f5010bd3-igl', 'cfe3b29587-igh', 'cfe3b29587-igk']] --> [['cfe3b29587-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'eee6809ad6-igh': [['bc11af4843-igh', 'bc11af4843-igk', 'eee6809ad6-igl']] --> [['bc11af4843-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'e11acbe3ab-igh': [['db63559ea9-igh', 'db63559ea9-igk']] --> [['db63559ea9-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'eee2c7797d-igh': [['52387a89c7-igh', '52387a89c7-igk']] --> [['52387a89c7-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'f094dfd68a-igh': [['21cea6e4d0-igh', '21cea6e4d0-igl', 'f094dfd68a-igk']] --> [['f094dfd68a-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'c0fcfe005f-igh': [['971ac047ee-igl', 'c0fcfe005f-igk']] --> [['c0fcfe005f-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'a4b090d0be-igh': [['8807c8ff04-igl', 'a4b090d0be-igk']] --> [['a4b090d0be-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '52387a89c7-igh': [['52387a89c7-igk', 'eee2c7797d-igh']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '7ba384a461-igh': [['57537e5f22-igh', '57537e5f22-igl', '7ba384a461-igk']] --> [['7ba384a461-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '7d4166ae48-igh': [['9ed10b6475-igh']] --> [[]]
[93mwarning[0m replaced input metafo for 1 total key in 13 seqs (13 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
             paired-uids        0       39        0       26        0       13
                    loci        0       39        0       39        0        0
        water time: 0.0
hmm
  subcluster annotating 18 clusters with steps:  (0.2s) (0.2s) 
    subcluster annotation time 0.4
      total time: 0.5
  need to get annotations for 15/15 joint igk clusters
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igk/meta-igk.yaml --input-partition-fname test/paired/new-results/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
  --input-metafnames: added meta info for 36 sequences from test/paired/new-results/partition-new-simu/igh+igk/meta-igk.yaml: loci paired-uids
  --input-partition-fname: read best partition with 36 sequences in 15 clusters from test/paired/new-results/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 36 / 36 v annotations (0 failed) with 5 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 36 / 36 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.389) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'cfe3b29587-igk': [['09f5010bd3-igh', '09f5010bd3-igl', 'cfe3b29587-igh']] --> [['09f5010bd3-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'bc11af4843-igk': [['bc11af4843-igh', 'eee6809ad6-igh', 'eee6809ad6-igl']] --> [['eee6809ad6-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'db63559ea9-igk': [['db63559ea9-igh', 'e11acbe3ab-igh']] --> [['e11acbe3ab-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '52387a89c7-igk': [['52387a89c7-igh', 'eee2c7797d-igh']] --> [['eee2c7797d-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'f094dfd68a-igk': [['21cea6e4d0-igh', '21cea6e4d0-igl', 'f094dfd68a-igh']] --> [['f094dfd68a-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'c0fcfe005f-igk': [['971ac047ee-igl', 'c0fcfe005f-igh']] --> [['c0fcfe005f-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'a4b090d0be-igk': [['8807c8ff04-igl', 'a4b090d0be-igh']] --> [['a4b090d0be-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '7ba384a461-igk': [['57537e5f22-igh', '57537e5f22-igl', '7ba384a461-igh']] --> [['7ba384a461-igh']]
[93mwarning[0m replaced input metafo for 1 total key in 8 seqs (8 clusters): paired-uids
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
             paired-uids        0       36        0       28        0        8
                    loci        0       36        0       36        0        0
        water time: 0.0
hmm
  subcluster annotating 15 clusters with steps:  (0.2s) (0.1s) 
    subcluster annotation time 0.3
      total time: 0.4
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:  11 total unpaired,  [94mh[0m 7  [92ml[0m 4
    merging igh+igl partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    6 --> 7    [91m+1[0m
        [92ml[0m    3 --> 7    [91m+4[0m
    re-added unpaired seqs ([94mh[0m 7, [92ml[0m 4) to give total seqs in joint partitions: [94mh[0m 24  [92ml[0m 21
    [93mwarning[0m removed 5/22 uids (leaving 17) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 5 / 24 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 2 / 24 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   0.964  0.675
       joint   0.958  0.715
  [92ml[0m ccfs:     purity  completeness
      single   1.000  1.000
       joint   1.000  0.627
  merge time 0.0
  need to get annotations for 9/11 joint igh clusters
[44mannotate[0m [94migh+igl[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igl/input-seqs-igh.fa --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igl/meta-igh.yaml --input-partition-fname test/paired/new-results/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 24 sequences from test/paired/new-results/partition-new-simu/igh+igl/meta-igh.yaml: loci paired-uids
  --input-partition-fname: read best partition with 24 sequences in 11 clusters from test/paired/new-results/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 24 / 24 v annotations (0 failed) with 6 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 24 / 24 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 12 (0.500) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '9ed10b6475-igh': [['7d4166ae48-igh']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'cb8a759f1a-igh': [['7588f09c07-igh', '7588f09c07-igl']] --> [['7588f09c07-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '14195e4958-igh': [['14195e4958-igl', 'd5ddf0c2ec-igl']] --> [['14195e4958-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '21cea6e4d0-igh': [['21cea6e4d0-igl', 'f094dfd68a-igh', 'f094dfd68a-igk']] --> [['21cea6e4d0-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '57537e5f22-igh': [['57537e5f22-igl', '7ba384a461-igh', '7ba384a461-igk']] --> [['57537e5f22-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '253ca59333-igh': [['253ca59333-igl', 'b739ce37b7-igh', 'b739ce37b7-igl']] --> [['253ca59333-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '7588f09c07-igh': [['7588f09c07-igl', 'cb8a759f1a-igh']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'cfe3b29587-igh': [['09f5010bd3-igh', '09f5010bd3-igl', 'cfe3b29587-igk']] --> [['09f5010bd3-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '7d4166ae48-igh': [['9ed10b6475-igh']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'b739ce37b7-igh': [['253ca59333-igh', '253ca59333-igl', 'b739ce37b7-igl']] --> [['b739ce37b7-igl']]
[93mwarning[0m replaced input metafo for 1 total key in 13 seqs (13 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
             paired-uids        0       24        0       11        0       13
                    loci        0       24        0       24        0        0
        water time: 0.0
hmm
  subcluster annotating 11 clusters with steps:  (0.2s) (0.2s) 
    subcluster annotation time 0.4
      total time: 0.5
  need to get annotations for 7/7 joint igl clusters
[44mannotate[0m [94migh+igl[0m:[94m igl[0m
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igl/input-seqs-igl.fa --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results/partition-new-simu/igh+igl/meta-igl.yaml --input-partition-fname test/paired/new-results/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
  --input-metafnames: added meta info for 21 sequences from test/paired/new-results/partition-new-simu/igh+igl/meta-igl.yaml: loci paired-uids
  --input-partition-fname: read best partition with 21 sequences in 7 clusters from test/paired/new-results/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 21 / 21 v annotations (0 failed) with 3 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 21 / 21 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 14 (0.667) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'd5ddf0c2ec-igl': [['14195e4958-igh', '14195e4958-igl']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '7588f09c07-igl': [['7588f09c07-igh', 'cb8a759f1a-igh']] --> [['cb8a759f1a-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '14195e4958-igl': [['14195e4958-igh', 'd5ddf0c2ec-igl']] --> [['14195e4958-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '21cea6e4d0-igl': [['21cea6e4d0-igh', 'f094dfd68a-igh', 'f094dfd68a-igk']] --> [['21cea6e4d0-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '57537e5f22-igl': [['57537e5f22-igh', '7ba384a461-igh', '7ba384a461-igk']] --> [['57537e5f22-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '971ac047ee-igl': [['c0fcfe005f-igh', 'c0fcfe005f-igk']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '8807c8ff04-igl': [['a4b090d0be-igh', 'a4b090d0be-igk']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '253ca59333-igl': [['253ca59333-igh', 'b739ce37b7-igh', 'b739ce37b7-igl']] --> [['253ca59333-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '09f5010bd3-igl': [['09f5010bd3-igh', 'cfe3b29587-igh', 'cfe3b29587-igk']] --> [['cfe3b29587-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'b739ce37b7-igl': [['253ca59333-igh', '253ca59333-igl', 'b739ce37b7-igh']] --> [['b739ce37b7-igh']]
[93mwarning[0m replaced input metafo for 1 total key in 11 seqs (11 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
             paired-uids        0       21        0       10        0       11
                    loci        0       21        0       21        0        0
        water time: 0.0
hmm
  subcluster annotating 7 clusters with steps:  (0.2s) (0.1s) 
    subcluster annotation time 0.3
      total time: 0.3
/home/dralph/work/partis/python/plotting.py:1275: MatplotlibDeprecationWarning: You are modifying the state of a globally registered colormap. In future versions, you will not be able to modify a registered colormap in-place. To remove this warning, you can make a copy of the colormap first. cmap = copy.copy(mpl.cm.get_cmap("viridis"))
  cmap.set_under('w')
   N clusters with all seqs:
        [94mh[0m   19 --> 25   [91m+6[0m
        [95mk[0m    6 --> 15   [91m+9[0m
        [92ml[0m    3 --> 7    [91m+4[0m
      total time: 15.5
[92mseed-partition-new-simu[0m          /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --max-ccf-fail-frac 0.10 --is-simu --seed-unique-id 3542bd38d8-igh:3542bd38d8-igk --seed-loci igh:igk --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/seed-partition-new-simu
   removing seqs very different from seed seq
                           wrong/no     removed      singly         kept   missing
           locus  before   pairing    cdr3  hfrac    added   after  frac   true ids
             [94mh[0m       56       32        18     0        5      11   0.196    [91m2[0m
             [95mk[0m       36       12        18     0        5      11   0.306    [91m2[0m
     adding seqs paired with uids we kept
           locus  before  added  after  kept frac
             [94mh[0m      11       6     17    0.304
             [95mk[0m      11       1     12    0.333
             [92ml[0m       0       4      4    0.190
      taken 22, paired with taken 11 (total 33)
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/input-seqs-igh.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 17 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 17 / 17 v annotations (0 failed) with 3 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 17 / 17 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 8 (0.471) unproductive
        water time: 0.0
hmm
  caching all 17 naive sequences (0.2s)
    collapsed 17 queries into 17 clusters with identical naive seqs (0.0 sec)
  17 clusters with 10 procs (0.2s)
   17 clusters with 7 procs (0.2s)
   17 clusters with 5 procs (0.2s)
   17 clusters with 3 procs (0.3s)
   14 clusters with 2 procs (0.3s)
   14 clusters with 1 proc (0.4s)
       partition loop time: 1.7
getting annotations for final partition
    reading output
        read 12 hmm output lines with 17 sequences in 12 events  (0 failures)
      hmm step time: 0.2
      total time: 2.1
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/input-seqs-igk.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 12 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 12 / 12 v annotations (0 failed) with 2 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 12 / 12 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 7 (0.583) unproductive
        water time: 0.0
hmm
  caching all 12 naive sequences (0.1s)
    collapsed 12 queries into 3 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 3
  3 clusters with 3 procs (0.1s)
   3 clusters with 2 procs (0.1s)
   3 clusters with 1 proc (0.1s)
       partition loop time: 0.3
getting annotations for final partition
  subcluster annotating 2 clusters with steps:  (0.1s) (0.1s) (0.1s) 
    subcluster annotation time 0.3
      total time: 0.8
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/input-seqs-igl.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results/test/simu/meta.yaml
  --input-metafnames: added meta info for 4 sequences from test/paired/new-results/test/simu/meta.yaml: loci paired-uids
  note: reducing N procs to the number of seqs 10 --> 4
partitioning     (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 4 / 4 v annotations (0 failed) with 2 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 4 / 4 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
        water time: 0.0
hmm
  caching all 4 naive sequences (0.1s)
    collapsed 4 queries into 2 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 4 --> 2
  2 clusters with 2 procs (0.1s)
   2 clusters with 1 proc (0.1s)
       partition loop time: 0.2
getting annotations for final partition
    reading output
        read 2 hmm output lines with 4 sequences in 2 events  (0 failures)
      hmm step time: 0.1
      total time: 0.5
[44mcombining[0m chains
   cleaning pair info for 33 seqs
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:      [93mwarning[0m adding missing per-seq key: mut_positions
  note: added 1 new input meta key to allowed keys (add 's'/plural to access it in the final annotations): mut_position (mut_positions)
5 total unpaired,  [94mh[0m 4  [95mk[0m 1
    merging igh+igk partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    8 --> 8   
        [95mk[0m    1 --> 8    [91m+7[0m
    re-added unpaired seqs ([94mh[0m 4, [95mk[0m 1) to give total seqs in joint partitions: [94mh[0m 15  [95mk[0m 12
    [93mwarning[0m removed 39/56 uids (leaving 17) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 24/34 uids (leaving 10) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 2 / 15 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 3 / 15 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   1.000  0.100
       joint   1.000  0.111
    [93mwarning[0m removed 24/36 uids (leaving 12) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 24/36 uids (leaving 12) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
  [95mk[0m ccfs:     purity  completeness
      single   0.909  1.000
       joint   1.000  0.100
  merge time 0.0
     removed 10 unseeded clusters (of 11 total, leaving 1) from igh joint partition
  seed cluster size in best joint partition: 1, excluding seed seq: 0
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id 3542bd38d8-igh:3542bd38d8-igk
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/meta-igh.yaml --input-partition-fname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 1 sequences from test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/meta-igh.yaml: loci paired-uids
  note: reducing N procs to the number of seqs 10 --> 1
  --input-partition-fname: read best partition with 1 sequences in 1 clusters from test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 1 / 1 v annotations (0 failed) with 1 v gene in 0.0 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 1 / 1 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
        water time: 0.0
hmm
    reading output
        read 1 hmm output lines with 1 sequences in 1 events  (0 failures)
      hmm step time: 0.1
      total time: 0.2
     removed 8 unseeded clusters (of 9 total, leaving 1) from igk joint partition
  need to get annotations for 1/1 joint igk clusters
  seed cluster size in best joint partition: 1, excluding seed seq: 0
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id 3542bd38d8-igh:3542bd38d8-igk
  note: adding input metafname from default location (test/paired/new-results/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/meta-igk.yaml --input-partition-fname test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igk-only-partition.yaml
  --input-metafnames: added meta info for 1 sequences from test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/meta-igk.yaml: loci paired-uids
  note: reducing N procs to the number of seqs 10 --> 1
  --input-partition-fname: read best partition with 1 sequences in 1 clusters from test/paired/new-results/seed-partition-new-simu/seeds/3542bd38d8-igh+3542bd38d8-igk/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 1 / 1 v annotations (0 failed) with 1 v gene in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 1 / 1 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 1 (1.000) unproductive
        water time: 0.0
hmm
    reading output
        read 1 hmm output lines with 1 sequences in 1 events  (0 failures)
      hmm step time: 0.1
      total time: 0.2
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:  6 total unpaired,  [94mh[0m 4  [92ml[0m 2
    merging igh+igl partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    2 --> 2   
        [92ml[0m    1 --> 2    [91m+1[0m
    re-added unpaired seqs ([94mh[0m 4, [92ml[0m 2) to give total seqs in joint partitions: [94mh[0m 6  [92ml[0m 4
  merge time 0.0
     removed 5 unseeded clusters (of 5 total, leaving 0) from igh joint partition
     removed 4 unseeded clusters (of 4 total, leaving 0) from igl joint partition
   N clusters with all seqs:
        [94mh[0m   12 --> 1    [91m-11[0m
        [95mk[0m    2 --> 1    [91m-1[0m
      total time: 5.7
[92mget-selection-metrics-new-simu[0m   /home/dralph/work/partis/bin/partis get-selection-metrics --dont-write-git-info --paired-loci --existing-output-run-cfg paired --min-selection-metric-cluster-size 3 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/partition-new-simu --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --min-selection-metric-cluster-size 3 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igh.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: by default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set). If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 5 clusters with sizes 7 6 3 3 3
      skipped 13 smaller than 3
    getting trees for 2 clusters with sizes: 7 6
      starting 2 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/140891/fasttree.out /tmp/dralph/tree-inference/140891/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/596853/fasttree.out /tmp/dralph/tree-inference/596853/input-seqs.fa
      made 2 fasttree trees (0.1s)
    tree origins: 2 ran fasttree
    skipped 3/5 clusters smaller than 4
      setting default tau to 1 / 385 = 0.0026
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0026
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 13/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: amz bnw bop dko ikn psz
      setting default tau to 1 / 385 = 0.0026
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0026
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 9/11 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: dst eov ily npq
    skipped 3/5 clusters that had no uids in common with tree
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igk/partition-igh-selection-metrics.yaml
      total time: 0.2
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igk --dont-write-git-info --min-selection-metric-cluster-size 3 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igk.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: by default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set). If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 4 clusters with sizes 7 7 3 3
      skipped 11 smaller than 3
    getting trees for 2 clusters with sizes: 7 7
      starting 2 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/140891/fasttree.out /tmp/dralph/tree-inference/140891/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/596853/fasttree.out /tmp/dralph/tree-inference/596853/input-seqs.fa
      made 2 fasttree trees (0.1s)
    tree origins: 2 ran fasttree
    skipped 2/4 clusters smaller than 4
      setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 3/9 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bnw
      setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 2/9 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: eov
    skipped 2/4 clusters that had no uids in common with tree
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igk/partition-igk-selection-metrics.yaml
      total time: 0.2
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --min-selection-metric-cluster-size 3 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igh.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: by default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set). If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 3 clusters with sizes 8 4 3
      skipped 8 smaller than 3
    getting trees for 2 clusters with sizes: 8 4
      starting 2 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/140891/fasttree.out /tmp/dralph/tree-inference/140891/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/596853/fasttree.out /tmp/dralph/tree-inference/596853/input-seqs.fa
      made 2 fasttree trees (0.1s)
    tree origins: 2 ran fasttree
    skipped 1/3 clusters smaller than 4
      setting default tau to 1 / 376 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0027
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 13/15 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: amz bev bnw bop dko ikn
      setting default tau to 1 / 376 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0027
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 7/8 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: eov flx npq
    skipped 1/3 clusters that had no uids in common with tree
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igl/partition-igh-selection-metrics.yaml
      total time: 0.2
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igl --dont-write-git-info --min-selection-metric-cluster-size 3 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igl.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: by default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set). If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 3 clusters with sizes 8 6 3
      skipped 4 smaller than 3
    getting trees for 2 clusters with sizes: 8 6
      starting 2 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/140891/fasttree.out /tmp/dralph/tree-inference/140891/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/596853/fasttree.out /tmp/dralph/tree-inference/596853/input-seqs.fa
      made 2 fasttree trees (0.1s)
    tree origins: 2 ran fasttree
    skipped 1/3 clusters smaller than 4
      setting default tau to 1 / 334 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 10/13 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: amz bev dko ikn
      setting default tau to 1 / 334 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0030
    skipped 1/3 clusters that had no uids in common with tree
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igl/partition-igl-selection-metrics.yaml
      total time: 0.2
[44mgetting combined h/l selection metrics[0m
    igh+igk: 15 unpaired light clusters after finding h/l cluster pairs
    igh+igk: skipped 3 annotations with zero length paired uids
    igh+igk: skipped 15 annotations with N h or l ids < 10
    igh+igl: 7 unpaired light clusters after finding h/l cluster pairs
    igh+igl: skipped 4 annotations with zero length paired uids
    igh+igl: skipped 7 annotations with N h or l ids < 10
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 0 clusters with sizes 
      skipped 0 smaller than 3
      [93mwarning[0m no inferred annotations for selection metrics, returning without doing anything
      writing 0 chosen abs to test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv
      total time: 2.0
