[92mcache-parameters-data[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --paired-indir test/paired-data --parameter-dir test/paired/new-results/test/parameters/data --n-max-queries 50 --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-max-queries 50 --random-seed 1 --n-procs 10 --infname test/paired-data/igh.fa --sw-cachefname test/paired/new-results/test/parameters/data/igh/sw-cache.yaml
caching parameters
  vsearch: 48 / 48 v annotations (0 failed) with 29 v genes in 0.1 sec
    keeping 23 / 220 v genes
smith-waterman  (new-allele fitting)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/data/igh/sw-cache.yaml
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
        writing sw results to test/paired/new-results/test/parameters/data/igh/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igh/sw (1.8 sec)
    water time: 2.1  (ig-sw 2.0  processing 0.2)
  writing hmms (0.2 sec)
hmm
    running 10 procs
                    calcd:         vtb 48        fwd  0
             min-max time:  0.2 - 0.4 sec
    reading output
        read 48 hmm output lines with 48 sequences in 48 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igh/hmm (1.6 sec)
         infra time: 1.7
      hmm step time: 2.2
  writing hmms (0.2 sec)
      total time: 5.4
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igk --n-max-queries 50 --random-seed 1 --n-procs 10 --infname test/paired-data/igk.fa --sw-cachefname test/paired/new-results/test/parameters/data/igk/sw-cache.yaml
caching parameters
  vsearch: 37 / 37 v annotations (0 failed) with 17 v genes in 0.1 sec
    keeping 16 / 58 v genes
smith-waterman  (new-allele fitting)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/data/igk/sw-cache.yaml
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
        writing sw results to test/paired/new-results/test/parameters/data/igk/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igk/sw (1.3 sec)
    water time: 1.6  (ig-sw 1.4  processing 0.1)
  writing hmms (0.2 sec)
hmm
    running 10 procs
                    calcd:         vtb 37        fwd  0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 37 hmm output lines with 37 sequences in 37 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igk/hmm (1.1 sec)
         infra time: 1.2
      hmm step time: 1.5
  writing hmms (0.1 sec)
      total time: 3.8
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igl --n-max-queries 50 --random-seed 1 --n-procs 10 --infname test/paired-data/igl.fa --sw-cachefname test/paired/new-results/test/parameters/data/igl/sw-cache.yaml
caching parameters
  vsearch: 15 / 15 v annotations (0 failed) with 13 v genes in 0.1 sec
    keeping 10 / 70 v genes
smith-waterman  (new-allele fitting)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.0 sec
  removing old sw cache test/paired/new-results/test/parameters/data/igl/sw-cache.yaml
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.0 sec
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
        writing sw results to test/paired/new-results/test/parameters/data/igl/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/data/igl/sw (0.9 sec)
    water time: 1.0  (ig-sw 0.9  processing 0.1)
  writing hmms (0.1 sec)
hmm
    running 10 procs
                    calcd:         vtb 15        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 15 hmm output lines with 15 sequences in 15 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/data/igl/hmm (0.7 sec)
         infra time: 0.8
      hmm step time: 0.9
  writing hmms (0.1 sec)
      total time: 2.5
      total time: 12.7
[92msimulate[0m                         /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --paired-loci --parameter-dir test/paired/new-results/test/parameters/data --n-sim-events 10 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/test/simu --indel-frequency 0.2
    cleaning paired files in test/paired/new-results/test/simu/
[94migh+igk[0m: simulating 7 events
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-trees 7 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 845101047 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results/test/simu/igh+igk/trees.nwk
  generating 7 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 7 trees:   depth 0.04071   leaves 6.71
    writing trees to test/paired/new-results/test/simu/igh+igk/trees.nwk
      total time: 1.3
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-sim-events 7 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 845101047 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --input-simulation-treefname test/paired/new-results/test/simu/igh+igk/trees.nwk --outfname test/paired/new-results/test/simu/igh+igk/igh.yaml
  note: reducing --n-procs to 7 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 1
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/648364/trees-sub-1.nwk
    made 1 event with 4 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.5

      --> proc 6
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/648364/trees-sub-6.nwk
    made 1 event with 1 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 4
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/648364/trees-sub-4.nwk
    made 1 event with 1 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 5
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/648364/trees-sub-5.nwk
    made 1 event with 3 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 2
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/648364/trees-sub-2.nwk
    made 1 event with 7 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.5

      --> proc 0
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/648364/trees-sub-0.nwk
    made 1 event with 10 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.6

      --> proc 3
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/648364/trees-sub-3.nwk
    made 1 event with 21 seqs in 0.3s (0.3s of which was running bppseqgen)
      total time: 0.6

   read 7 events with 47 seqs from 7 .yaml files
      total time: 1.2
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igk --n-sim-events 7 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 845101047 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --input-simulation-treefname test/paired/new-results/test/simu/igh+igk/trees.nwk --outfname test/paired/new-results/test/simu/igh+igk/igk.yaml
  note: reducing --n-procs to 7 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 4
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/703178/trees-sub-4.nwk
    made 1 event with 1 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 1
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/703178/trees-sub-1.nwk
    made 1 event with 4 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 5
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/703178/trees-sub-5.nwk
    made 1 event with 3 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 6
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/703178/trees-sub-6.nwk
    made 1 event with 1 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 0
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/703178/trees-sub-0.nwk
    made 1 event with 10 seqs in 0.2s (0.1s of which was running bppseqgen)
      total time: 0.5

      --> proc 2
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/703178/trees-sub-2.nwk
    made 1 event with 7 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 3
    reco params: test/paired/new-results/test/parameters/data/igk/hmm     shm params: test/paired/new-results/test/parameters/data/igk/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/703178/trees-sub-3.nwk
    made 1 event with 21 seqs in 0.3s (0.3s of which was running bppseqgen)
      total time: 0.6

   read 7 events with 47 seqs from 7 .yaml files
      total time: 1.2
[94migh+igl[0m: simulating 3 events
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-trees 3 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 848101038 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results/test/simu/igh+igl/trees.nwk
  generating 3 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 3 trees:   depth 0.01833   leaves 8.00
    writing trees to test/paired/new-results/test/simu/igh+igl/trees.nwk
      total time: 1.2
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igh --n-sim-events 3 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 848101038 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --input-simulation-treefname test/paired/new-results/test/simu/igh+igl/trees.nwk --outfname test/paired/new-results/test/simu/igh+igl/igh.yaml
  note: reducing --n-procs to 3 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 1
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/646320/trees-sub-1.nwk
    made 1 event with 1 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.4

      --> proc 0
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/646320/trees-sub-0.nwk
    made 1 event with 13 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.5

      --> proc 2
    reco params: test/paired/new-results/test/parameters/data/igh/hmm     shm params: test/paired/new-results/test/parameters/data/igh/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/646320/trees-sub-2.nwk
    made 1 event with 10 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.4

   read 3 events with 24 seqs from 3 .yaml files
      total time: 0.9
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/data/igl --n-sim-events 3 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 848101038 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --input-simulation-treefname test/paired/new-results/test/simu/igh+igl/trees.nwk --outfname test/paired/new-results/test/simu/igh+igl/igl.yaml
  note: reducing --n-procs to 3 (was 10) so it isn't bigger than --n-sim-events
simulating
      --> proc 1
    reco params: test/paired/new-results/test/parameters/data/igl/hmm     shm params: test/paired/new-results/test/parameters/data/igl/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/934034/trees-sub-1.nwk
    made 1 event with 1 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 0.3

      --> proc 2
    reco params: test/paired/new-results/test/parameters/data/igl/hmm     shm params: test/paired/new-results/test/parameters/data/igl/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/934034/trees-sub-2.nwk
    made 1 event with 10 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.4

      --> proc 0
    reco params: test/paired/new-results/test/parameters/data/igl/hmm     shm params: test/paired/new-results/test/parameters/data/igl/hmm
    resetting --n-trees from 10 to 1 to match trees read from /tmp/dralph/hmms/934034/trees-sub-0.nwk
    made 1 event with 13 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 0.5

   read 3 events with 24 seqs from 3 .yaml files
      total time: 1.0
[94migh+igk[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results/test/simu/igh+igk/
[94migh+igl[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results/test/simu/igh+igl/
[91mrun[0m cd test/paired/new-results/test/simu && ln -sf igh+igk/igk.yaml igk.yaml
[91mrun[0m cd test/paired/new-results/test/simu && ln -sf igh+igl/igl.yaml igl.yaml
      total time: 8.6
[92mcache-parameters-simu[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --paired-indir test/paired/new-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --is-simu --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
  note: adding --input-metafname from default location test/paired/new-results/test/simu/meta.yaml
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results/test/simu/igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafname test/paired/new-results/test/simu/meta.yaml
  --input-metafname: added meta info for 71 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
caching parameters
  vsearch: 71 / 71 v annotations (0 failed) with 11 v genes in 0.1 sec
    keeping 5 / 220 v genes
    [91mmissing[0m 19 simulation genes (counts): [95mh[0m[91mv[0m[95m1[0m[95m-18[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-46[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-8[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-5[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-70[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-11[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-20[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-21[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-23[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-33[0m[93m01[0m 10  [95mh[0m[91mv[0m[95m3[0m[95m-48[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-66[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-7[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-74[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-9[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-31[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-39[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-4[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93mi02[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 71 / 71 v annotations (0 failed) with 5 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
    running 10 procs for 71 seqs
    running 11 procs for 3 seqs
      info for 71 / 71 = 1.000   (removed: 0 failed)
      kept 45 (0.634) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 71 / 71 v annotations (0 failed) with 5 v genes in 0.1 sec
    running 10 procs for 71 seqs
    running 11 procs for 3 seqs
      info for 71 / 71 = 1.000   (removed: 0 failed)
      kept 45 (0.634) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igh/sw (0.6 sec)
    water time: 0.9  (ig-sw 0.7  processing 0.1)
  writing hmms (0.1 sec)
hmm
    running 10 procs
                    calcd:         vtb 71        fwd  0
             min-max time:  0.2 - 0.3 sec
    reading output
        read 71 hmm output lines with 71 sequences in 71 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igh/hmm (0.4 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igh/true (0.3 sec)
         infra time: 0.8
      hmm step time: 1.2
  writing hmms (0.1 sec)
      total time: 2.9
  note: adding --input-metafname from default location test/paired/new-results/test/simu/meta.yaml
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results/test/simu/igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafname test/paired/new-results/test/simu/meta.yaml
  --input-metafname: added meta info for 47 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
caching parameters
  vsearch: 47 / 47 v annotations (0 failed) with 7 v genes in 0.0 sec
    keeping 7 / 58 v genes
    [91mmissing[0m 9 simulation genes (counts): [95mk[0m[91mv[0m[95m1[0m[95m-12[0m[93m02[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-13[0m[93m02[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-27[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-33[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-5[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-8[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m1[0m[95m-9[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m4[0m[95m-1[0m[93m01[0m 0  [95mk[0m[91mv[0m[95m6[0m[95m-21[0m[93m01[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 47 / 47 v annotations (0 failed) with 7 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
    running 10 procs for 47 seqs
    running 11 procs for 3 seqs
      info for 47 / 47 = 1.000   (removed: 0 failed)
      kept 13 (0.277) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 47 / 47 v annotations (0 failed) with 7 v genes in 0.1 sec
    running 10 procs for 47 seqs
    running 11 procs for 3 seqs
      info for 47 / 47 = 1.000   (removed: 0 failed)
      kept 13 (0.277) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igk/sw (0.7 sec)
    water time: 1.0  (ig-sw 0.8  processing 0.1)
  writing hmms (0.1 sec)
hmm
    running 10 procs
                    calcd:         vtb 47        fwd  0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 47 hmm output lines with 47 sequences in 47 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igk/hmm (0.5 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igk/true (0.5 sec)
         infra time: 1.2
      hmm step time: 1.4
  writing hmms (0.1 sec)
      total time: 3.2
  note: adding --input-metafname from default location test/paired/new-results/test/simu/meta.yaml
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results/test/simu/igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafname test/paired/new-results/test/simu/meta.yaml
  --input-metafname: added meta info for 24 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
caching parameters
  vsearch: 24 / 24 v annotations (0 failed) with 4 v genes in 0.0 sec
    keeping 3 / 70 v genes
    [91mmissing[0m 7 simulation genes (counts): [95ml[0m[91mv[0m[95m1[0m[95m-51[0m[93m02[0m 0  [95ml[0m[91mv[0m[95m2[0m[95m-14[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m2[0m[95m-23[0m[93m02[0m 0  [95ml[0m[91mv[0m[95m3[0m[95m-19[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m4[0m[95m-60[0m[93m03[0m 0  [95ml[0m[91mv[0m[95m7[0m[95m-46[0m[93m01[0m 0  [95ml[0m[91mv[0m[95m8[0m[95m-61[0m[93m01[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 24 / 24 v annotations (0 failed) with 3 v genes in 0.1 sec
  removing old sw cache test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
    running 10 procs for 24 seqs
    running 11 procs for 2 seqs
      info for 24 / 24 = 1.000   (removed: 0 failed)
      kept 15 (0.625) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 24 / 24 v annotations (0 failed) with 3 v genes in 0.1 sec
    running 10 procs for 24 seqs
    running 11 procs for 2 seqs
      info for 24 / 24 = 1.000   (removed: 0 failed)
      kept 15 (0.625) unproductive
        writing sw results to test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
    writing parameters to test/paired/new-results/test/parameters/simu/igl/sw (0.4 sec)
    water time: 0.7  (ig-sw 0.5  processing 0.1)
  writing hmms (0.1 sec)
hmm
    running 10 procs
                    calcd:         vtb 24        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 24 hmm output lines with 24 sequences in 24 events  (0 failures)
    writing parameters to test/paired/new-results/test/parameters/simu/igl/hmm (0.2 sec)
    writing parameters to test/paired/new-results/test/parameters/simu/igl/true (0.2 sec)
         infra time: 0.5
      hmm step time: 0.7
  writing hmms (0.1 sec)
      total time: 2.0
      total time: 9.0
[92mpartition-new-simu[0m               /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results/test/simu --parameter-dir test/paired/new-results/test/parameters/simu --n-precache-procs 10 --plot-annotation-performance --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/partition-new-simu
  note: adding --input-metafname from default location test/paired/new-results/test/simu/meta.yaml
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --n-precache-procs 10 --plot-annotation-performance --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/test/simu/igh.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafname test/paired/new-results/test/simu/meta.yaml
  --input-metafname: added meta info for 71 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 71 / 71 v annotations (0 failed) with 5 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 71 / 71 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 45 (0.634) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 3 queries with different true and inferred net shm indel lengths: 2526701238527187326-igh 0700854878525538757-igh 4170268835807223480-igh
(0.0 sec)
        water time: 0.4
hmm
caching all 71 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 71        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.2 - 0.3 sec
      hmm step time: 0.4
   collapsed 71 queries into 39 clusters with identical naive seqs (0.0 sec)
39 clusters with 10 procs
       naive hfrac bounds: 0.015 0.077
    running 10 procs
          read from cache:  naive-seqs 71   logprobs  0
                    calcd:         vtb 12        fwd 20
                   merged:       hfrac  4     lratio  2
             min-max time:  0.0 - 0.2 sec
         infra time: 0.1
      hmm step time: 0.4
33 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 83   logprobs 20
                    calcd:         vtb 11        fwd  5
                   merged:       hfrac  6     lratio  1
             min-max time:  0.0 - 0.2 sec
      hmm step time: 0.3
26 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 94   logprobs 25
                    calcd:         vtb  3        fwd  4
                   merged:       hfrac  3     lratio  0
             min-max time:  0.0 - 0.2 sec
      hmm step time: 0.3
23 clusters with 3 procs
    running 3 procs
          read from cache:  naive-seqs 97   logprobs 29
                    calcd:         vtb  3        fwd  4
                   merged:       hfrac  1     lratio  0
             min-max time:  0.1 - 0.3 sec
      hmm step time: 0.3
22 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 100   logprobs 33
                    calcd:         vtb  6        fwd  2
                   merged:       hfrac  5     lratio  0
             min-max time:  0.1 - 0.3 sec
      hmm step time: 0.4
17 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 106   logprobs 35
                    calcd:         vtb  4        fwd 19
                   merged:       hfrac  4     lratio  0
                     time:  0.7 sec
      hmm step time: 0.8
  [93mnote[0m not merging entire cpath history
      loop time: 2.6
getting annotations for final partition
  subcluster annotating 13 clusters: 
    running 10 procs
                    calcd:         vtb 30        fwd  0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 30 hmm output lines with 71 sequences in 30 events  (0 failures)
      hmm step time: 0.4
    read 30 new subcluster annotations: added hashid 23   whole finished 7   subcl finished 0
    running 10 procs
                    calcd:         vtb 10        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 10 hmm output lines with 23 sequences in 10 events  (0 failures)
      hmm step time: 0.2
    read 10 new subcluster annotations: added hashid 10   whole finished 0   subcl finished 3
    running 10 procs
                    calcd:         vtb   3        fwd   0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 3 hmm output lines with 7 sequences in 3 events  (0 failures)
      hmm step time: 0.2
    read 3 new subcluster annotations: added hashid 3   whole finished 0   subcl finished 3
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 3 queries with different true and inferred net shm indel lengths: 0700854878525538757-igh 2526701238527187326-igh 4170268835807223480-igh
(0.0 sec)
    subcluster annotation time 0.9
      total time: 4.4
  note: adding --input-metafname from default location test/paired/new-results/test/simu/meta.yaml
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --n-precache-procs 10 --plot-annotation-performance --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igk --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/test/simu/igk.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafname test/paired/new-results/test/simu/meta.yaml
  --input-metafname: added meta info for 47 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 47 / 47 v annotations (0 failed) with 7 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 47 / 47 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 13 (0.277) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 2 queries with different true and inferred net shm indel lengths: 3625511351946820617-igk 1518614211193872963-igk
(0.0 sec)
        water time: 0.4
hmm
caching all 47 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 47        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.1 - 0.2 sec
      hmm step time: 0.3
   collapsed 47 queries into 10 clusters with identical naive seqs (0.0 sec)
10 clusters with 10 procs
       naive hfrac bounds: 0.015 0.065
    running 10 procs
          read from cache:  naive-seqs 47   logprobs  0
                    calcd:         vtb  0        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/482322/hmm_cached_info.csv
         infra time: 0.1
      hmm step time: 0.2
10 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 47   logprobs  0
                    calcd:         vtb  2        fwd  0
                   merged:       hfrac  1     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
9 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 49   logprobs  0
                    calcd:         vtb  2        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
9 clusters with 3 procs
    running 3 procs
          read from cache:  naive-seqs 51   logprobs  0
                    calcd:         vtb  0        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/482322/hmm_cached_info.csv
      hmm step time: 0.1
9 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 51   logprobs  0
                    calcd:         vtb  1        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.1
9 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 52   logprobs  0
                    calcd:         vtb  0        fwd  9
                   merged:       hfrac  0     lratio  0
                     time:  0.3 sec
      hmm step time: 0.3
      loop time: 1.2
getting annotations for final partition
  subcluster annotating 9 clusters: 
    running 9 procs
                    calcd:         vtb 20        fwd  0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 20 hmm output lines with 47 sequences in 20 events  (0 failures)
         infra time: 0.1
      hmm step time: 0.3
    read 20 new subcluster annotations: added hashid 15   whole finished 5   subcl finished 0
    running 9 procs
                    calcd:         vtb  6        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 6 hmm output lines with 15 sequences in 6 events  (0 failures)
      hmm step time: 0.1
    read 6 new subcluster annotations: added hashid 6   whole finished 0   subcl finished 3
    running 9 procs
                    calcd:         vtb  1        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 1 hmm output lines with 3 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 2 queries with different true and inferred net shm indel lengths: 1518614211193872963-igk 3625511351946820617-igk
(0.0 sec)
    subcluster annotation time 0.6
      total time: 2.6
  note: adding --input-metafname from default location test/paired/new-results/test/simu/meta.yaml
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --n-precache-procs 10 --plot-annotation-performance --is-simu --plotdir test/paired/new-results/partition-new-simu-annotation-performance/single-chain/plots/igl --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/test/simu/igl.yaml --outfname test/paired/new-results/partition-new-simu/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafname test/paired/new-results/test/simu/meta.yaml
  --input-metafname: added meta info for 24 sequences from test/paired/new-results/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 24 / 24 v annotations (0 failed) with 3 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 24 / 24 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 15 (0.625) unproductive
  plotting performance (0.0 sec)
        water time: 0.4
hmm
caching all 24 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 24        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.1 - 0.1 sec
      hmm step time: 0.2
   collapsed 24 queries into 3 clusters with identical naive seqs (0.0 sec)
3 clusters with 10 procs
       naive hfrac bounds: 0.015 0.069
    running 10 procs
          read from cache:  naive-seqs 24   logprobs  0
                    calcd:         vtb  0        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/781387/hmm_cached_info.csv
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
         infra time: 0.1
      hmm step time: 0.2
3 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 24   logprobs  0
                    calcd:         vtb  0        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/781387/hmm_cached_info.csv
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
      hmm step time: 0.2
3 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 24   logprobs  0
                    calcd:         vtb  0        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/781387/hmm_cached_info.csv
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
    [91mwarning[0m null partition (one of the processes probably got passed zero sequences)
      hmm step time: 0.1
3 clusters with 3 procs
    running 3 procs
          read from cache:  naive-seqs 24   logprobs  0
                    calcd:         vtb  0        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/781387/hmm_cached_info.csv
      hmm step time: 0.1
3 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 24   logprobs  0
                    calcd:         vtb  0        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/781387/hmm_cached_info.csv
      hmm step time: 0.1
3 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 24   logprobs  0
                    calcd:         vtb  1        fwd  3
                   merged:       hfrac  0     lratio  0
                     time:  0.1 sec
      hmm step time: 0.2
      loop time: 0.9
getting annotations for final partition
  subcluster annotating 3 clusters: 
    running 3 procs
                    calcd:         vtb 10        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 10 hmm output lines with 24 sequences in 10 events  (0 failures)
      hmm step time: 0.2
    read 10 new subcluster annotations: added hashid 9   whole finished 1   subcl finished 0
    running 3 procs
                    calcd:         vtb  4        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 4 hmm output lines with 9 sequences in 4 events  (0 failures)
      hmm step time: 0.1
    read 4 new subcluster annotations: added hashid 4   whole finished 0   subcl finished 0
    running 3 procs
                    calcd:         vtb  2        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 2 hmm output lines with 4 sequences in 2 events  (0 failures)
      hmm step time: 0.1
    read 2 new subcluster annotations: added hashid 2   whole finished 0   subcl finished 2
  plotting performance (0.0 sec)
    subcluster annotation time 0.5
      total time: 2.1
    truncating x bins 2 --> 12 and ybins 2 --> 12
    truncating x bins 3 --> 15 and ybins 3 --> 15
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
  intersection and complement both ok
   N clusters without bad/unpaired seqs:
        [94mh[0m    8 --> 10   [91m+2[0m
        [95mk[0m    9 --> 10   [91m+1[0m
  [94mh[0m ccfs:     purity  completeness
      single   1.000  0.922
       joint   1.000  0.883
  [95mk[0m ccfs:     purity  completeness
      single   1.000  0.921
       joint   1.000  0.883
  need to get annotations for 7/10 joint igh clusters
    removed 2 arg strs that were specific to action 'partition': --n-precache-procs 10
  note: adding --input-metafname from default location test/paired/new-results/test/simu/meta.yaml
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafname test/paired/new-results/partition-new-simu/igh+igk/meta-igh.yaml --input-partition-fname test/paired/new-results/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
  --input-metafname: added meta info for 47 sequences from test/paired/new-results/partition-new-simu/igh+igk/meta-igh.yaml: paired-uids
  --input-partition-fname: read best partition with 47 sequences in 10 clusters from test/paired/new-results/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 47 / 47 v annotations (0 failed) with 5 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 47 / 47 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 31 (0.660) unproductive
        water time: 0.0
hmm
  subcluster annotating 10 clusters: 
    running 10 procs
                    calcd:         vtb 21        fwd  0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 21 hmm output lines with 47 sequences in 21 events  (0 failures)
      hmm step time: 0.2
    read 21 new subcluster annotations: added hashid 15   whole finished 6   subcl finished 0
    running 10 procs
                    calcd:         vtb  6        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 6 hmm output lines with 15 sequences in 6 events  (0 failures)
      hmm step time: 0.2
    read 6 new subcluster annotations: added hashid 6   whole finished 0   subcl finished 3
    running 10 procs
                    calcd:         vtb  1        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 1 hmm output lines with 3 sequences in 1 events  (0 failures)
      hmm step time: 0.2
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.6
      total time: 0.7
  need to get annotations for 6/10 joint igk clusters
    removed 2 arg strs that were specific to action 'partition': --n-precache-procs 10
  note: adding --input-metafname from default location test/paired/new-results/test/simu/meta.yaml
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igk --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml --input-metafname test/paired/new-results/partition-new-simu/igh+igk/meta-igk.yaml --input-partition-fname test/paired/new-results/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
  --input-metafname: added meta info for 47 sequences from test/paired/new-results/partition-new-simu/igh+igk/meta-igk.yaml: paired-uids
  --input-partition-fname: read best partition with 47 sequences in 10 clusters from test/paired/new-results/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 47 / 47 v annotations (0 failed) with 7 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igk/sw-cache.yaml
      info for 47 / 47 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 13 (0.277) unproductive
        water time: 0.0
hmm
  subcluster annotating 10 clusters: 
    running 10 procs
                    calcd:         vtb 21        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 21 hmm output lines with 47 sequences in 21 events  (0 failures)
      hmm step time: 0.2
    read 21 new subcluster annotations: added hashid 15   whole finished 6   subcl finished 0
    running 10 procs
                    calcd:         vtb  6        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 6 hmm output lines with 15 sequences in 6 events  (0 failures)
      hmm step time: 0.1
    read 6 new subcluster annotations: added hashid 6   whole finished 0   subcl finished 3
    running 10 procs
                    calcd:         vtb  1        fwd  0
             min-max time:  0.0 - 0.0 sec
    reading output
        read 1 hmm output lines with 3 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.5
      total time: 0.6
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
  intersection and complement both ok
   N clusters without bad/unpaired seqs:
        [94mh[0m    5 --> 5   
        [92ml[0m    3 --> 5    [91m+2[0m
  [94mh[0m ccfs:     purity  completeness
      single   1.000  0.922
       joint   1.000  0.848
  [92ml[0m ccfs:     purity  completeness
      single   1.000  1.000
       joint   1.000  0.848
  need to get annotations for 2/5 joint igh clusters
    removed 2 arg strs that were specific to action 'partition': --n-precache-procs 10
  note: adding --input-metafname from default location test/paired/new-results/test/simu/meta.yaml
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igl/input-seqs-igh.fa --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igh.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml --input-metafname test/paired/new-results/partition-new-simu/igh+igl/meta-igh.yaml --input-partition-fname test/paired/new-results/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
  --input-metafname: added meta info for 24 sequences from test/paired/new-results/partition-new-simu/igh+igl/meta-igh.yaml: paired-uids
  --input-partition-fname: read best partition with 24 sequences in 5 clusters from test/paired/new-results/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 24 / 24 v annotations (0 failed) with 3 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igh/sw-cache.yaml
      info for 24 / 24 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 14 (0.583) unproductive
        water time: 0.0
hmm
  subcluster annotating 5 clusters: 
    running 10 procs
                    calcd:         vtb 10        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 10 hmm output lines with 24 sequences in 10 events  (0 failures)
      hmm step time: 0.2
    read 10 new subcluster annotations: added hashid 7   whole finished 3   subcl finished 0
    running 10 procs
                    calcd:         vtb  3        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 3 hmm output lines with 7 sequences in 3 events  (0 failures)
      hmm step time: 0.2
    read 3 new subcluster annotations: added hashid 3   whole finished 0   subcl finished 1
    running 10 procs
                    calcd:         vtb  1        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.2
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.5
      total time: 0.7
  need to get annotations for 4/5 joint igl clusters
    removed 2 arg strs that were specific to action 'partition': --n-precache-procs 10
  note: adding --input-metafname from default location test/paired/new-results/test/simu/meta.yaml
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results/test/parameters/simu/igl --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results/partition-new-simu/igh+igl/input-seqs-igl.fa --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igl.yaml --sw-cachefname test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml --input-metafname test/paired/new-results/partition-new-simu/igh+igl/meta-igl.yaml --input-partition-fname test/paired/new-results/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
  --input-metafname: added meta info for 24 sequences from test/paired/new-results/partition-new-simu/igh+igl/meta-igl.yaml: paired-uids
  --input-partition-fname: read best partition with 24 sequences in 5 clusters from test/paired/new-results/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
annotating    (with test/paired/new-results/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 24 / 24 v annotations (0 failed) with 3 v genes in 0.1 sec
        reading sw results from test/paired/new-results/test/parameters/simu/igl/sw-cache.yaml
      info for 24 / 24 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 15 (0.625) unproductive
        water time: 0.0
hmm
  subcluster annotating 5 clusters: 
    running 10 procs
                    calcd:         vtb 10        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 10 hmm output lines with 24 sequences in 10 events  (0 failures)
      hmm step time: 0.2
    read 10 new subcluster annotations: added hashid 7   whole finished 3   subcl finished 0
    running 10 procs
                    calcd:         vtb  3        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 3 hmm output lines with 7 sequences in 3 events  (0 failures)
      hmm step time: 0.1
    read 3 new subcluster annotations: added hashid 3   whole finished 0   subcl finished 1
    running 10 procs
                    calcd:         vtb  1        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.4
      total time: 0.5
[91mrun[0m cd test/paired/new-results/partition-new-simu && ln -sf igh+igk/partition-igk.yaml partition-igk.yaml
[91mrun[0m cd test/paired/new-results/partition-new-simu && ln -sf igh+igl/partition-igl.yaml partition-igl.yaml
   N clusters with all seqs:
        [94mh[0m   13 --> 15   [91m+2[0m
        [95mk[0m    9 --> 10   [91m+1[0m
        [92ml[0m    3 --> 5    [91m+2[0m
    [94mh[0m single vs joint concat'd correct cluster fractions:
       clusters uids
          15     71  joint
          13     71  single
      purity:       67.3 / 71 = 0.948
      completeness: 71.0 / 71 = 1.000
    [95mk[0m single vs joint concat'd correct cluster fractions:
       clusters uids
          10     47  joint
           9     47  single
      purity:       45.1 / 47 = 0.960
      completeness: 47.0 / 47 = 1.000
    [92ml[0m single vs joint concat'd correct cluster fractions:
       clusters uids
           5     24  joint
           3     24  single
      purity:       20.4 / 24 = 0.848
      completeness: 24.0 / 24 = 1.000
  [93mwarning[0m ignoring --plot-annotation-performance for paired clustering since it's going to be a bit fiddly to implement
      total time: 15.0
[92mget-selection-metrics-new-simu[0m   /home/dralph/work/partis/bin/partis get-selection-metrics --dont-write-git-info --paired-loci --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results/partition-new-simu --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igh.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
getting selection metrics
    calculating selection metrics for 1 cluster with size: 19
      skipping 9 smaller than 10
    inf tree: calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 20 = 0.0500 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 31/34 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
    (AA inf tree, iclust 0): calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 20 = 0.0500 (lbr)
      tree origins: 1 made from cpath
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igk/partition-igh-selection-metrics.yaml
      total time: 0.2
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igk --dont-write-git-info --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igk/partition-igk.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
getting selection metrics
    calculating selection metrics for 1 cluster with size: 19
      skipping 9 smaller than 10
    inf tree: calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 20 = 0.0500 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 16/26 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
    (AA inf tree, iclust 0): calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 20 = 0.0500 (lbr)
      tree origins: 1 made from cpath
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igk/partition-igk-selection-metrics.yaml
      total time: 0.2
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igh.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
getting selection metrics
    calculating selection metrics for 1 cluster with size: 12
      skipping 4 smaller than 10
    inf tree: calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 20 = 0.0500 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 19/21 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
    (AA inf tree, iclust 0): calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 20 = 0.0500 (lbr)
      tree origins: 1 made from cpath
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igl/partition-igh-selection-metrics.yaml
      total time: 0.2
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igl --dont-write-git-info --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv --refuse-to-cache-parameters --outfname test/paired/new-results/partition-new-simu/igh+igl/partition-igl.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
getting selection metrics
    calculating selection metrics for 1 cluster with size: 12
      skipping 4 smaller than 10
    inf tree: calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 20 = 0.0500 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 19/21 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
    (AA inf tree, iclust 0): calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 20 = 0.0500 (lbr)
      tree origins: 1 made from cpath
  writing selection metrics to test/paired/new-results/partition-new-simu/igh+igl/partition-igl-selection-metrics.yaml
      total time: 0.2
  ab choice cfg:
[91mrun[0m cat /home/dralph/work/partis/data/selection-metrics/ab-choice.yaml
        n-families: 2
        include-unobs-cons-seqs: True
        vars:
          # sort each family by the indicated variable, with direction <sort>, then take the top <n> seqs that haven't already been taken and that pass all other criteria
          aa-cfrac: {sort: low, n: [5, 3]}
          # shm-aa: {sort: high, n: [3, 3, 3, 3, 3, 2, 2, 2, 2, 2]}
        # cell-types: [pb]
        max-ambig-positions: 2  # summed over h+l amino acid seqs
        # min-umis: 1000
        # n-per-family: [3, 2]
        # min-median-nuc-shm-%: 2
        min-hdist-to-already-chosen: 3  # only choose abs whose h/l seqs are at least this far from previously-chosen seqs (in amino acid hamming distance, summed over h+l)
        
    no tree info in 9 annotations (probably smaller than min tree metric cluster size)
    no tree info in 4 annotations (probably smaller than min tree metric cluster size)
    2 h/l pairs: 19 19,  12 12
      writing 0 chosen abs to test/paired/new-results/get-selection-metrics-new-simu-chosen-abs.csv
      total time: 1.8
