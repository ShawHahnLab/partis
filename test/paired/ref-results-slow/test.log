[92mcache-parameters-data[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --infname test/paired-data/all-seqs.fa --parameter-dir test/paired/new-results-slow/test/parameters/data --n-max-queries -1 --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[91mrun[0m /home/dralph/work/partis/bin/extract-pairing-info.py test/paired-data/all-seqs.fa /tmp/dralph/hmms/766525/meta.yaml
  extract_pairing_info(): read 100 sequences with 48 droplet ids
    droplet id separators (set automatically): _  indices: [0]
       e.g. uid 'AAACCTGAGAGACGAA-1_contig_2' --> droplet id 'AAACCTGAGAGACGAA-1' contig id '2'
    contigs per
      droplet     count   fraction
        1            2     0.042
        2           42     0.875
        3            2     0.042
        4            2     0.042
[91mrun[0m /home/dralph/work/partis/bin/split-loci.py test/paired-data/all-seqs.fa --outdir /tmp/dralph/hmms/766525 --input-metafname /tmp/dralph/hmms/766525/meta.yaml
  --input-metafnames: added meta info for 100 sequences from /tmp/dralph/hmms/766525/meta.yaml: paired-uids
    read pairing info for 100 seqs from input meta file
  running vsearch on 100 sequences:
    igh:   49 / 100 v annotations (51 failed) with 28 v genes in 0.1 sec
    igk:   40 / 100 v annotations (60 failed) with 18 v genes in 0.1 sec
    igl:   15 / 100 v annotations (85 failed) with 12 v genes in 0.1 sec
totals: igh 48 igk 37 igl 15
  removed 0 failed uids from paired_uids
            count  frac  paired with
       [94mh[0m      31   0.65   [95mk[0m
              11   0.23   [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [95mk[0m
               1   0.02   [92ml[0m [92ml[0m
               1   0.02   [95mk[0m [92ml[0m
       [95mk[0m      31   0.84   [94mh[0m
               2   0.05   
               2   0.05   [94mh[0m [94mh[0m [95mk[0m
               1   0.03   [94mh[0m [94mh[0m [92ml[0m
               1   0.03   [94mh[0m [92ml[0m
       [92ml[0m      11   0.73   [94mh[0m
               2   0.13   [94mh[0m [92ml[0m
               1   0.07   [94mh[0m [94mh[0m [95mk[0m
               1   0.07   [94mh[0m [95mk[0m
writing to /tmp/dralph/hmms/766525/
  igh: 48 to 766525/igh.fa
  igk: 37 to 766525/igk.fa
  igl: 15 to 766525/igl.fa
writing to paired subdirs
    36/48 igh seqs pair with igk
      igh: 36 to igh+igk/igh.fa
      igk: 37 to igh+igk/igk.fa
    15/48 igh seqs pair with igl
      igh: 15 to igh+igl/igh.fa
      igl: 15 to igh+igl/igl.fa
[44mcache-parameters[0m [94migh[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --infname /tmp/dralph/hmms/766525/igh.fa --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results-slow/test/parameters/data/igh/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/766525/meta.yaml
  --input-metafnames: added meta info for 48 sequences from /tmp/dralph/hmms/766525/meta.yaml: paired-uids
caching parameters
  vsearch: 48 / 48 v annotations (0 failed) with 27 v genes in 0.1 sec
    keeping 23 / 198 v genes
smith-waterman  (new-allele fitting)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/data/igh/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/data/igh/sw (2.6 sec)
    water time: 2.8  (ig-sw 2.7  processing 0.1)
  writing hmms     removed 13 genes from glfo (leaving v 23  d 19  j 6)
(0.2 sec)
hmm
    reading output
        read 48 hmm output lines with 48 sequences in 48 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/data/igh/hmm (2.3 sec)
         infra time: 2.4
      hmm step time: 2.8
  writing hmms     removed 1  genes from glfo (leaving v 23  d 18  j 6)
(0.2 sec)
      total time: 6.6
[44mcache-parameters[0m [94migk[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --infname /tmp/dralph/hmms/766525/igk.fa --parameter-dir test/paired/new-results-slow/test/parameters/data/igk --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results-slow/test/parameters/data/igk/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/766525/meta.yaml
  --input-metafnames: added meta info for 37 sequences from /tmp/dralph/hmms/766525/meta.yaml: paired-uids
caching parameters
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    keeping 16 / 64 v genes
smith-waterman  (new-allele fitting)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/data/igk/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/data/igk/sw (1.8 sec)
    water time: 2.0  (ig-sw 1.9  processing 0.1)
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)
(0.1 sec)
hmm
    reading output
        read 37 hmm output lines with 37 sequences in 37 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/data/igk/hmm (1.6 sec)
         infra time: 1.7
      hmm step time: 1.9
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)
(0.1 sec)
      total time: 4.6
[44mcache-parameters[0m [94migl[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --infname /tmp/dralph/hmms/766525/igl.fa --parameter-dir test/paired/new-results-slow/test/parameters/data/igl --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results-slow/test/parameters/data/igl/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/766525/meta.yaml
  --input-metafnames: added meta info for 15 sequences from /tmp/dralph/hmms/766525/meta.yaml: paired-uids
caching parameters
  vsearch: 15 / 15 v annotations (0 failed) with 12 v genes in 0.1 sec
    keeping 10 / 80 v genes
smith-waterman  (new-allele fitting)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.1 sec
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.1 sec
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
        writing sw results to test/paired/new-results-slow/test/parameters/data/igl/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/data/igl/sw (1.2 sec)
    water time: 1.4  (ig-sw 1.3  processing 0.1)
  writing hmms     removed 6  genes from glfo (leaving v 10  d 1  j 3)
(0.1 sec)
hmm
    reading output
        read 15 hmm output lines with 15 sequences in 15 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/data/igl/hmm (1.0 sec)
         infra time: 1.0
      hmm step time: 1.2
  writing hmms     removed 0  genes from glfo (leaving v 10  d 1  j 3)
(0.1 sec)
      total time: 3.0
      [93mwarning[0m expected to remove 1/11 files+dirs that weren't in /tmp/dralph/hmms/766525/: failed.fa
      total time: 16.1
[92msimulate[0m                         /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --paired-loci --parameter-dir test/paired/new-results-slow/test/parameters/data --n-sim-events 200 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/test/simu --indel-frequency 0.2
[94migh+igk[0m: simulating 134 events
[44mgenerate-trees[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-trees 134 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 2003260051 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 134 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 134 trees:   depth 0.02330   leaves 5.16
    writing trees to test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
      total time: 1.9
[44msimulate[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-sim-events 134 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 2003260051 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igk/igh.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
simulating
      --> proc 0
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/346548/trees-sub-0.nwk
    made 13 events with 63 seqs in 2.7s (2.4s of which was running bppseqgen)
      total time: 3.2

      --> proc 1
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/346548/trees-sub-1.nwk
    made 13 events with 54 seqs in 2.4s (2.0s of which was running bppseqgen)
      total time: 2.8

      --> proc 2
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/346548/trees-sub-2.nwk
    made 13 events with 67 seqs in 2.9s (2.6s of which was running bppseqgen)
      total time: 3.4

      --> proc 3
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/346548/trees-sub-3.nwk
    made 13 events with 51 seqs in 2.6s (2.3s of which was running bppseqgen)
      total time: 3.0

      --> proc 4
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/346548/trees-sub-4.nwk
    made 13 events with 74 seqs in 2.8s (2.4s of which was running bppseqgen)
      total time: 3.2

      --> proc 5
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/346548/trees-sub-5.nwk
    made 13 events with 41 seqs in 2.2s (1.7s of which was running bppseqgen)
      total time: 2.6

      --> proc 6
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/346548/trees-sub-6.nwk
    made 13 events with 94 seqs in 3.1s (2.7s of which was running bppseqgen)
      total time: 3.5

      --> proc 7
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/346548/trees-sub-7.nwk
    made 13 events with 56 seqs in 2.8s (2.3s of which was running bppseqgen)
      total time: 3.2

      --> proc 8
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/346548/trees-sub-8.nwk
    made 13 events with 79 seqs in 3.1s (2.6s of which was running bppseqgen)
      total time: 3.3

      --> proc 9
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 17 to match trees read from /tmp/dralph/hmms/346548/trees-sub-9.nwk
    made 17 events with 112 seqs in 3.6s (3.0s of which was running bppseqgen)
      total time: 3.9

   read 134 events with 691 seqs from 10 .yaml files
      total time: 4.9
[44msimulate[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igk --n-sim-events 134 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 2077655082 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igk/igk.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
simulating
      --> proc 0
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/353788/trees-sub-0.nwk
    made 13 events with 63 seqs in 2.2s (1.8s of which was running bppseqgen)
      total time: 2.6

      --> proc 1
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/353788/trees-sub-1.nwk
    made 13 events with 54 seqs in 2.1s (1.8s of which was running bppseqgen)
      total time: 2.5

      --> proc 2
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/353788/trees-sub-2.nwk
    made 13 events with 67 seqs in 2.2s (1.9s of which was running bppseqgen)
      total time: 2.6

      --> proc 3
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/353788/trees-sub-3.nwk
    made 13 events with 51 seqs in 2.5s (2.1s of which was running bppseqgen)
      total time: 2.9

      --> proc 4
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/353788/trees-sub-4.nwk
    made 13 events with 74 seqs in 2.2s (1.9s of which was running bppseqgen)
      total time: 2.6

      --> proc 5
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/353788/trees-sub-5.nwk
    made 13 events with 41 seqs in 2.2s (1.9s of which was running bppseqgen)
      total time: 2.6

      --> proc 6
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/353788/trees-sub-6.nwk
    made 13 events with 94 seqs in 2.5s (2.3s of which was running bppseqgen)
      total time: 2.9

      --> proc 7
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/353788/trees-sub-7.nwk
    made 13 events with 56 seqs in 2.0s (1.7s of which was running bppseqgen)
      total time: 2.4

      --> proc 8
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/353788/trees-sub-8.nwk
    made 13 events with 79 seqs in 2.5s (2.1s of which was running bppseqgen)
      total time: 2.8

      --> proc 9
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 17 to match trees read from /tmp/dralph/hmms/353788/trees-sub-9.nwk
    made 17 events with 112 seqs in 3.2s (2.9s of which was running bppseqgen)
      total time: 3.5

   read 134 events with 691 seqs from 10 .yaml files
      total time: 4.5
[94migh+igl[0m: simulating 66 events
[44mgenerate-trees[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-trees 66 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 982264879 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 66 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 66 trees:   depth 0.02637   leaves 4.85
    writing trees to test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
      total time: 1.7
[44msimulate[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-sim-events 66 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 982264879 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igl/igh.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
simulating
      --> proc 0
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/734708/trees-sub-0.nwk
    made 6 events with 35 seqs in 1.3s (1.1s of which was running bppseqgen)
      total time: 1.7

      --> proc 1
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/734708/trees-sub-1.nwk
    made 6 events with 31 seqs in 1.1s (1.0s of which was running bppseqgen)
      total time: 1.6

      --> proc 2
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/734708/trees-sub-2.nwk
    made 6 events with 39 seqs in 1.3s (1.1s of which was running bppseqgen)
      total time: 1.8

      --> proc 3
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/734708/trees-sub-3.nwk
    made 6 events with 16 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.5

      --> proc 4
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/734708/trees-sub-4.nwk
    made 6 events with 28 seqs in 1.4s (1.2s of which was running bppseqgen)
      total time: 1.8

      --> proc 5
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/734708/trees-sub-5.nwk
    made 6 events with 28 seqs in 1.0s (0.9s of which was running bppseqgen)
      total time: 1.5

      --> proc 6
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/734708/trees-sub-6.nwk
    made 6 events with 25 seqs in 1.1s (1.0s of which was running bppseqgen)
      total time: 1.5

      --> proc 7
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/734708/trees-sub-7.nwk
    made 6 events with 26 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.4

      --> proc 8
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/734708/trees-sub-8.nwk
    made 6 events with 52 seqs in 1.5s (1.2s of which was running bppseqgen)
      total time: 1.8

      --> proc 9
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 12 to match trees read from /tmp/dralph/hmms/734708/trees-sub-9.nwk
    made 12 events with 40 seqs in 2.0s (1.7s of which was running bppseqgen)
      total time: 2.4

   read 66 events with 320 seqs from 10 .yaml files
      total time: 3.3
[44msimulate[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igl --n-sim-events 66 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.25 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 1083609742 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igl/igl.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
simulating
      --> proc 0
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/27958/trees-sub-0.nwk
    made 6 events with 35 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.5

      --> proc 1
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/27958/trees-sub-1.nwk
    made 6 events with 31 seqs in 1.3s (1.1s of which was running bppseqgen)
      total time: 1.7

      --> proc 2
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/27958/trees-sub-2.nwk
    made 6 events with 39 seqs in 1.1s (1.0s of which was running bppseqgen)
      total time: 1.5

      --> proc 3
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/27958/trees-sub-3.nwk
    made 6 events with 16 seqs in 1.0s (0.9s of which was running bppseqgen)
      total time: 1.5

      --> proc 4
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/27958/trees-sub-4.nwk
    made 6 events with 28 seqs in 1.0s (0.9s of which was running bppseqgen)
      total time: 1.5

      --> proc 5
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/27958/trees-sub-5.nwk
    made 6 events with 28 seqs in 1.1s (1.0s of which was running bppseqgen)
      total time: 1.5

      --> proc 6
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/27958/trees-sub-6.nwk
    made 6 events with 25 seqs in 0.9s (0.8s of which was running bppseqgen)
      total time: 1.2

      --> proc 7
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/27958/trees-sub-7.nwk
    made 6 events with 26 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.5

      --> proc 8
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/27958/trees-sub-8.nwk
    made 6 events with 52 seqs in 1.3s (1.1s of which was running bppseqgen)
      total time: 1.5

      --> proc 9
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 12 to match trees read from /tmp/dralph/hmms/27958/trees-sub-9.nwk
    made 12 events with 40 seqs in 1.6s (1.3s of which was running bppseqgen)
      total time: 1.9

   read 66 events with 320 seqs from 10 .yaml files
      total time: 3.0
[94migh+igk[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results-slow/test/simu/igh+igk/
[94migh+igl[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results-slow/test/simu/igh+igl/
  apportioned 2022 seqs among 808 droplets (mean/2 1.3): 2 4 2 4 2 2 4 2 4 2 2 4 4 4 2 2 4 4 4 2 2 2 2 2 4 4 4 2 2 2 2 4 2 2 4 4 2 4 4 2 4 2 2 2 2 2 4 2 2 2 2 2 2 2 4 4 2 2 2 4 4 2 2 2 2 4 4 4 2 4 4 2 2 2 2 2 4 2 4 2 2 4 2 2 2 2 2 4 4 2 2 4 2 2 2 2 2 4 2 4 2 2 2 4 2 2 4 2 2 2 2 2 4 2 2 4 2 2 2 2 2 2 2 2 2 4 4 4 2 2 2 2 2 2 2 4 2 2 4 2 4 2 2 2 2 4 4 4 2 2 2 4 2 2 4 2 2 2 4 2 4 2 4 2 4 2 2 4 2 2 2 2 2 2 4 2 2 2 2 4 4 4 2 2 2 4 2 4 2 2 2 2 2 2 4 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 2 2 2 2 2 2 2 2 4 2 4 4 2 2 2 2 4 2 4 2 2 2 2 4 2 2 4 2 4 2 2 2 4 2 2 2 2 2 2 4 2 2 4 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 2 2 2 2 4 4 4 4 4 2 2 4 2 2 4 2 2 2 4 2 2 2 2 2 2 4 2 2 4 2 2 2 2 2 4 2 2 2 2 2 2 2 2 2 4 2 4 2 4 4 2 2 4 2 2 2 2 2 2 4 2 2 2 4 2 2 2 2 2 2 2 4 2 4 2 2 2 4 2 2 2 4 2 2 4 2 4 2 4 2 2 2 2 2 2 4 2 2 4 4 2 4 2 2 2 2 2 2 4 2 2 2 4 2 2 2 2 2 4 4 2 2 4 4 2 4 2 2 2 2 4 2 2 4 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 2 4 4 2 2 4 2 2 2 2 2 2 4 2 2 2 2 2 2 2 2 2 2 2 4 2 2 2 2 2 4 2 2 2 2 2 4 4 2 2 2 4 2 2 2 2 2 2 2 2 2 4 2 2 2 2 4 2 4 4 2 2 4 2 2 2 2 4 4 2 2 4 2 2 2 2 2 2 4 4 2 2 2 2 2 4 4 4 2 4 2 2 4 2 2 2 4 2 2 2 4 2 2 2 4 4 2 4 2 2 2 2 2 2 2 2 4 4 2 2 2 2 2 2 2 2 4 2 2 2 2 2 2 2 2 2 2 2 2 4 4 2 2 2 2 2 4 2 2 2 2 2 2 2 4 2 4 4 4 2 2 4 2 2 4 2 2 2 4 4 2 2 2 2 2 2 2 2 2 4 2 4 2 4 2 2 2 2 4 2 2 4 2 2 2 2 2 4 2 2 4 2 4 4 2 2 2 2 2 2 2 2 4 2 2 4 2 2 2 2 2 2 2 2 2 2 4 2 2 2 2 2 2 4 2 2 2 2 2 2 2 2 2 4 4 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 2 4 2 4 2 4 2 2 2 2 2 2 2 4 2 2 2 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 2 2 2 2 4 2 2 2 2 4 2 2 2 2 2 2 4 2 4 4 2 2 2 4 2 2 2 2 2 2 2 2 2 2 2 2 4 2 2 2 4 2 2 2 2 2 2 2 4 2 4 4 2 2 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 2 2 4 2 2 2
  removed 303 / 2022 = 0.15 seqs from outfos (leaving 161 / 1719 unpaired)
    writing combined h/l info to fasta and meta files in test/paired/new-results-slow/test/simu
      total time: 23.6
[92mcache-parameters-simu[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --paired-indir test/paired/new-results-slow/test/simu --parameter-dir test/paired/new-results-slow/test/parameters/simu --is-simu --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[44mcache-parameters[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results-slow/test/simu/igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 864 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 864 / 864 v annotations (0 failed) with 36 v genes in 0.1 sec
    keeping 24 / 198 v genes
smith-waterman  (new-allele fitting)
  vsearch: 864 / 864 v annotations (0 failed) with 24 v genes in 0.2 sec
    running 10 procs for 864 seqs
    running 11 procs for 20 seqs
      info for 864 / 864 = 1.000   (removed: 0 failed)
      kept 255 (0.295) unproductive
    water time: 1.1  (ig-sw 0.1  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 864 / 864 v annotations (0 failed) with 24 v genes in 0.2 sec
    running 10 procs for 864 seqs
    running 11 procs for 20 seqs
      info for 864 / 864 = 1.000   (removed: 0 failed)
      kept 255 (0.295) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igh/sw (2.4 sec)
    water time: 4.1  (ig-sw 2.9  processing 0.2)
  writing hmms     removed 3  genes from glfo (leaving v 23  d 30  j 6)
(0.2 sec)
hmm
    reading output
        read 864 hmm output lines with 864 sequences in 864 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igh/hmm (2.1 sec)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igh/true (2.1 sec)
         infra time: 5.2
      hmm step time: 6.9
  writing hmms     removed 2  genes from glfo (leaving v 23  d 28  j 6)
(0.2 sec)
      total time: 13.7
[44mcache-parameters[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results-slow/test/simu/igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 586 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 586 / 586 v annotations (0 failed) with 18 v genes in 0.1 sec
    keeping 16 / 64 v genes
smith-waterman  (new-allele fitting)
  vsearch: 586 / 586 v annotations (0 failed) with 16 v genes in 0.2 sec
    running 10 procs for 586 seqs
    running 12 procs for 18 seqs
      info for 586 / 586 = 1.000   (removed: 0 failed)
      kept 113 (0.193) unproductive
    water time: 0.7  (ig-sw 0.1  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 586 / 586 v annotations (0 failed) with 16 v genes in 0.1 sec
    running 10 procs for 586 seqs
    running 12 procs for 18 seqs
      info for 586 / 586 = 1.000   (removed: 0 failed)
      kept 113 (0.193) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igk/sw (1.7 sec)
    water time: 2.7  (ig-sw 2.0  processing 0.1)
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)
(0.1 sec)
hmm
    reading output
        read 586 hmm output lines with 584 sequences in 584 events  (2 failures)
          [91mwarning[0m no valid paths: 3a1b73dc89-igk 7307ea6392-igk
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igk/hmm (1.5 sec)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igk/true (1.5 sec)
         infra time: 3.9
      hmm step time: 4.8
  writing hmms     removed 0  genes from glfo (leaving v 16  d 1  j 7)
(0.1 sec)
      total time: 9.2
[44mcache-parameters[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results-slow/test/simu/igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 269 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
caching parameters
  vsearch: 269 / 269 v annotations (0 failed) with 13 v genes in 0.1 sec
    keeping 10 / 80 v genes
smith-waterman  (new-allele fitting)
  vsearch: 269 / 269 v annotations (0 failed) with 10 v genes in 0.1 sec
    running 10 procs for 269 seqs
    running 11 procs for 6 seqs
      info for 269 / 269 = 1.000   (removed: 0 failed)
      kept 85 (0.316) unproductive
    water time: 0.3  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 269 / 269 v annotations (0 failed) with 10 v genes in 0.1 sec
    running 10 procs for 269 seqs
    running 11 procs for 6 seqs
      info for 269 / 269 = 1.000   (removed: 0 failed)
      kept 85 (0.316) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igl/sw (1.1 sec)
    water time: 1.6  (ig-sw 1.3  processing 0.1)
  writing hmms     removed 6  genes from glfo (leaving v 10  d 1  j 3)
(0.1 sec)
hmm
    reading output
        read 269 hmm output lines with 269 sequences in 269 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igl/hmm (0.9 sec)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igl/true (0.9 sec)
         infra time: 2.3
      hmm step time: 2.8
  writing hmms     removed 0  genes from glfo (leaving v 10  d 1  j 3)
(0.1 sec)
      total time: 5.5
      total time: 29.6
[92mpartition-new-simu[0m               /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results-slow/test/simu --parameter-dir test/paired/new-results-slow/test/parameters/simu --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/partition-new-simu
  [93mwarning[0m ignoring --plot-annotation-performance for paired clustering since it's going to be a bit fiddly to implement
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance/single-chain/plots/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/test/simu/igh.yaml --outfname test/paired/new-results-slow/partition-new-simu/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 864 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 864 / 864 v annotations (0 failed) with 23 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 864 / 864 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 255 (0.295) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 31 queries with different true and inferred net shm indel lengths: db63559ea9-igh d81bd3655b-igh f6b26be73e-igh ea3c3be216-igh bc0e4d7a98-igh ac93dacab5-igh 8a8accb2dc-igh 8809038230-igh 5818dcdbbb-igh 0e548085bb-igh 91676ac70f-igh d4aca00bb8-igh a3bb3ca569-igh 730900f3e4-igh a4e1836067-igh 846c794ab8-igh 207c08bd32-igh a536c77952-igh 35ca9d2511-igh d3477753e6-igh 55ee088bc2-igh 35ff731a60-igh 01cc8ef8c2-igh 7b141ee707-igh 838e405a5a-igh 1832733a2a-igh cd9e404090-igh dd88da13cb-igh 0baf317e46-igh aba7da7343-igh 627425bdbe-igh
(0.0 sec)
        water time: 0.9
hmm
  caching all 864 naive sequences (1.8s)
    collapsed 864 queries into 359 clusters with identical naive seqs (0.0 sec)
  359 clusters with 10 procs (1.6s)
   320 clusters with 7 procs (1.5s)
   285 clusters with 5 procs (1.7s)
   245 clusters with 3 procs (2.6s)
   210 clusters with 2 procs (2.8s)
   190 clusters with 2 procs (1.6s)
   184 clusters with 1 proc (4.6s)
   [93mnote[0m not merging entire cpath history
      partition loop time: 16.3
getting annotations for final partition
  subcluster annotating 177 clusters with steps:  (1.6s) (0.8s) (0.4s) (0.2s)   plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 31 queries with different true and inferred net shm indel lengths: 838e405a5a-igh 207c08bd32-igh dd88da13cb-igh 01cc8ef8c2-igh 0baf317e46-igh 0e548085bb-igh 1832733a2a-igh 35ca9d2511-igh 35ff731a60-igh 55ee088bc2-igh 5818dcdbbb-igh 627425bdbe-igh 730900f3e4-igh 7b141ee707-igh 846c794ab8-igh 8809038230-igh 8a8accb2dc-igh 91676ac70f-igh a3bb3ca569-igh a4e1836067-igh a536c77952-igh aba7da7343-igh ac93dacab5-igh bc0e4d7a98-igh cd9e404090-igh d3477753e6-igh d4aca00bb8-igh d81bd3655b-igh db63559ea9-igh ea3c3be216-igh f6b26be73e-igh
(0.0 sec)

    subcluster annotation time 3.7
      total time: 23.1
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance/single-chain/plots/igk --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/test/simu/igk.yaml --outfname test/paired/new-results-slow/partition-new-simu/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 586 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 586 / 586 v annotations (0 failed) with 16 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 586 / 586 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 113 (0.193) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 17 queries with different true and inferred net shm indel lengths: 2fd8b5c8f5-igk 44b03dcfc3-igk 2464510a36-igk c772a368e2-igk 4db7ef7858-igk 65a28e40fb-igk 9c5f4ab5e1-igk e82c2853d6-igk 85430008df-igk c47eea84c4-igk 41548f26c9-igk 3a1b73dc89-igk 6576e7b730-igk 7307ea6392-igk a536c77952-igk 3d19bd28fd-igk da0b397897-igk
(0.0 sec)
        water time: 0.7
hmm
  caching all 586 naive sequences (1.0s)
     [93mwarning:[0m missing 2 queries from hmm cache file (using sw naive sequence instead): 7307ea6392-igk 3a1b73dc89-igk
   collapsed 586 queries into 57 clusters with identical naive seqs (0.0 sec)
  57 clusters with 10 procs (0.5s)
   53 clusters with 7 procs (0.3s)
   51 clusters with 5 procs (0.2s)
   48 clusters with 3 procs (0.3s)
   46 clusters with 2 procs (0.3s)
   43 clusters with 1 proc (0.9s)
   [93mnote[0m not merging entire cpath history
  [93mwarning[0m all 12 partitions in cluster path have log prob -inf, so setting last (best) to zero
      partition loop time: 2.6
getting annotations for final partition
  subcluster annotating 42 clusters with steps:            [91mwarning[0m no valid paths: 3a1b73dc89-igk 7307ea6392-igk
(1.1s)     missing 2 annotations
      removing failed cluster for 3a1b73dc89-igk:
      removing failed cluster for 7307ea6392-igk:
(0.5s) (0.3s) (0.1s)   plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 15 queries with different true and inferred net shm indel lengths: 2464510a36-igk 6576e7b730-igk e82c2853d6-igk 41548f26c9-igk c772a368e2-igk 4db7ef7858-igk 44b03dcfc3-igk 2fd8b5c8f5-igk 3d19bd28fd-igk 65a28e40fb-igk 85430008df-igk 9c5f4ab5e1-igk a536c77952-igk c47eea84c4-igk da0b397897-igk
(0.0 sec)

    subcluster annotation time 2.5
      total time: 7.2
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance/single-chain/plots/igl --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/test/simu/igl.yaml --outfname test/paired/new-results-slow/partition-new-simu/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 269 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 269 / 269 v annotations (0 failed) with 10 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
      info for 269 / 269 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 85 (0.316) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 10 queries with different true and inferred net shm indel lengths: a51f8fd065-igl 071c033964-igl d061b99110-igl 24874450e7-igl e8ba97562f-igl 1936ca7664-igl 18003d0839-igl 6d4a8668f0-igl 9e8f0f5941-igl 219799f5d8-igl
(0.0 sec)
        water time: 0.5
hmm
  caching all 269 naive sequences (0.6s)
    collapsed 269 queries into 32 clusters with identical naive seqs (0.0 sec)
  32 clusters with 10 procs (0.3s)
   32 clusters with 7 procs (0.3s)
   28 clusters with 5 procs (0.3s)
   26 clusters with 3 procs (0.2s)
   22 clusters with 2 procs (0.2s)
   19 clusters with 1 proc (0.5s)
   [93mnote[0m not merging entire cpath history
      partition loop time: 1.9
getting annotations for final partition
  subcluster annotating 19 clusters with steps:  (0.7s) (0.3s) (0.2s) (0.1s)   plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 10 queries with different true and inferred net shm indel lengths: a51f8fd065-igl 24874450e7-igl 9e8f0f5941-igl 071c033964-igl 18003d0839-igl 1936ca7664-igl 219799f5d8-igl 6d4a8668f0-igl d061b99110-igl e8ba97562f-igl
(0.0 sec)

    subcluster annotation time 1.5
      total time: 4.7
[44mcombining[0m chains
      removed 2 failed queries when reading partition: 3a1b73dc89-igk 7307ea6392-igk
   cleaning pair info for 1717 seqs
   2/1717 (0.00) missing uids when cleaning pair info
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
    truncating x bins 3 --> 12 and ybins 5 --> 12
    truncating x bins 6 --> 15 and ybins 14 --> 15
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:      [93mwarning[0m adding missing per-seq key: mut_positions
  note: added 1 new input meta key to allowed keys (add 's'/plural to access it in the final annotations): mut_position (mut_positions)
231 total unpaired,  [94mh[0m 139  [95mk[0m 92
    merging igh+igk partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m  121 --> 162  [91m+41[0m
        [95mk[0m   40 --> 162  [91m+122[0m
    re-added unpaired seqs ([94mh[0m 139, [95mk[0m 92) to give total seqs in joint partitions: [94mh[0m 631  [95mk[0m 584
    [93mwarning[0m removed 11/581 uids (leaving 570) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 44 / 631 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 17 / 631 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   0.754  0.921
       joint   0.927  0.887
    [93mwarning[0m removed 2/586 uids (leaving 584) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 2/586 uids (leaving 584) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
  [95mk[0m ccfs:     purity  completeness
      single   0.349  0.977
       joint   0.878  0.790
  merge time 0.1
  need to get annotations for 153/196 joint igh clusters
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igh.yaml --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 631 sequences from test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igh.yaml: loci paired-uids
  --input-partition-fname: read best partition with 631 sequences in 196 clusters from test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 631 / 631 v annotations (0 failed) with 23 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 631 / 631 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 181 (0.287) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '00aea3f40e-igh': [['00aea3f40e-igk', 'f96837bced-igl']] --> [['00aea3f40e-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '97384be497-igh': [['2e9002b072-igh', '97384be497-igk']] --> [['97384be497-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'd7bea32657-igh': [['d7bea32657-igk', 'dae849c535-igh', 'dae849c535-igl']] --> [['d7bea32657-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'dc34dd0f12-igh': [['c63849ce98-igh', 'dc34dd0f12-igk']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '6c897f6d54-igh': [['11ce4a6475-igh', '6c897f6d54-igk']] --> [['6c897f6d54-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '8bf1825cb1-igh': [['2640869bf5-igh', '8bf1825cb1-igk']] --> [['8bf1825cb1-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'a4197ef4d6-igh': [['797ee65f5b-igh', '797ee65f5b-igl', 'a4197ef4d6-igk']] --> [['a4197ef4d6-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'c1fec1c7ee-igh': [['a4f229a17c-igh', 'a4f229a17c-igl', 'c1fec1c7ee-igk']] --> [['c1fec1c7ee-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3204353335-igh': [['3204353335-igk', 'bb34bee5ba-igh', 'bb34bee5ba-igl']] --> [['3204353335-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'ec4e415d18-igh': [['25b6cfbefe-igh', '25b6cfbefe-igk', 'ec4e415d18-igl']] --> [['25b6cfbefe-igk']]
[93mwarning[0m replaced input metafo for 1 total key in 181 seqs (181 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
             paired-uids        0      631        0      450        0      181
                    loci        0      631        0      631        0        0
        water time: 0.2
hmm
  subcluster annotating 196 clusters with steps:  (1.4s) (0.6s) (0.2s) 
    subcluster annotation time 2.4
      total time: 2.7
  need to get annotations for 152/162 joint igk clusters
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igk.yaml --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
  --input-metafnames: added meta info for 584 sequences from test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igk.yaml: loci paired-uids
  --input-partition-fname: read best partition with 584 sequences in 162 clusters from test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 584 / 584 v annotations (0 failed) with 16 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 584 / 584 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 111 (0.190) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '00aea3f40e-igk': [['00aea3f40e-igh', 'f96837bced-igl']] --> [['00aea3f40e-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '97384be497-igk': [['2e9002b072-igh', '97384be497-igh']] --> [['97384be497-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'd7bea32657-igk': [['d7bea32657-igh', 'dae849c535-igh', 'dae849c535-igl']] --> [['d7bea32657-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '6c897f6d54-igk': [['11ce4a6475-igh', '6c897f6d54-igh']] --> [['6c897f6d54-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '8bf1825cb1-igk': [['2640869bf5-igh', '8bf1825cb1-igh']] --> [['8bf1825cb1-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'a4197ef4d6-igk': [['797ee65f5b-igh', '797ee65f5b-igl', 'a4197ef4d6-igh']] --> [['a4197ef4d6-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'c1fec1c7ee-igk': [['a4f229a17c-igh', 'a4f229a17c-igl', 'c1fec1c7ee-igh']] --> [['c1fec1c7ee-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '418838eefb-igk': [['b98928e1a3-igh', 'b98928e1a3-igl']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '372c6f84da-igk': [['7e0b0501ad-igh', '7e0b0501ad-igl']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3204353335-igk': [['3204353335-igh', 'bb34bee5ba-igh', 'bb34bee5ba-igl']] --> [['3204353335-igh']]
[93mwarning[0m replaced input metafo for 1 total key in 142 seqs (142 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
             paired-uids        0      584        0      442        0      142
                    loci        0      584        0      584        0        0
        water time: 0.1
hmm
  subcluster annotating 162 clusters with steps:  (1.2s) (0.5s) (0.2s) 
    subcluster annotation time 1.9
      total time: 2.2
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:  175 total unpaired,  [94mh[0m 139  [92ml[0m 36
    merging igh+igl partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m   61 --> 79   [91m+18[0m
        [92ml[0m   18 --> 79   [91m+61[0m
    re-added unpaired seqs ([94mh[0m 139, [92ml[0m 36) to give total seqs in joint partitions: [94mh[0m 372  [92ml[0m 269
    [93mwarning[0m removed 17/283 uids (leaving 266) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 95 / 372 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 11 / 372 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   0.754  0.921
       joint   0.813  0.887
  [92ml[0m ccfs:     purity  completeness
      single   0.265  0.960
       joint   0.840  0.771
  merge time 0.0
  need to get annotations for 119/135 joint igh clusters
[44mannotate[0m [94migh+igl[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igl/input-seqs-igh.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igh.yaml --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 372 sequences from test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igh.yaml: loci paired-uids
  --input-partition-fname: read best partition with 372 sequences in 135 clusters from test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 372 / 372 v annotations (0 failed) with 22 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 372 / 372 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 107 (0.288) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '01fc9f0e61-igh': [['01fc9f0e61-igl', '06b4332e25-igh', '06b4332e25-igk']] --> [['01fc9f0e61-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5a4183dc03-igh': [['5a4183dc03-igl', '5e7481d653-igh', '5e7481d653-igk']] --> [['5a4183dc03-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '8b8d99a7fb-igh': [['8b8d99a7fb-igl', 'd25308e265-igh', 'd25308e265-igk']] --> [['8b8d99a7fb-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'd10b894b81-igh': [['0a2d0bfa65-igh', '0a2d0bfa65-igk', 'd10b894b81-igl']] --> [['d10b894b81-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'dae849c535-igh': [['d7bea32657-igh', 'd7bea32657-igk', 'dae849c535-igl']] --> [['dae849c535-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'f41b19a0e5-igh': [['e46b2f67ac-igh', 'e46b2f67ac-igk', 'f41b19a0e5-igl']] --> [['f41b19a0e5-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'd0244ff0a5-igh': [['4295daa7ac-igh']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'c1c48672e9-igh': [['66a3e1ee24-igh', '66a3e1ee24-igl', 'c1c48672e9-igl']] --> [['c1c48672e9-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'ccd70428ff-igh': [['936d128c00-igh', '936d128c00-igk', 'ccd70428ff-igl']] --> [['ccd70428ff-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '699778c6e1-igh': [['55ee088bc2-igh', '55ee088bc2-igk', '699778c6e1-igl']] --> [['699778c6e1-igl']]
[93mwarning[0m replaced input metafo for 1 total key in 221 seqs (221 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
             paired-uids        0      372        0      151        0      221
                    loci        0      372        0      372        0        0
        water time: 0.1
hmm
  subcluster annotating 135 clusters with steps:  (1.0s) (0.4s) (0.2s) 
    subcluster annotation time 1.6
      total time: 1.9
  need to get annotations for 74/80 joint igl clusters
[44mannotate[0m [94migh+igl[0m:[94m igl[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igl/input-seqs-igl.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igl.yaml --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
  --input-metafnames: added meta info for 269 sequences from test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igl.yaml: loci paired-uids
  --input-partition-fname: read best partition with 269 sequences in 80 clusters from test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 269 / 269 v annotations (0 failed) with 10 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
      info for 269 / 269 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 85 (0.316) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '01fc9f0e61-igl': [['01fc9f0e61-igh', '06b4332e25-igh', '06b4332e25-igk']] --> [['01fc9f0e61-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5a4183dc03-igl': [['5a4183dc03-igh', '5e7481d653-igh', '5e7481d653-igk']] --> [['5a4183dc03-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '8b8d99a7fb-igl': [['8b8d99a7fb-igh', 'd25308e265-igh', 'd25308e265-igk']] --> [['8b8d99a7fb-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'd10b894b81-igl': [['0a2d0bfa65-igh', '0a2d0bfa65-igk', 'd10b894b81-igh']] --> [['d10b894b81-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'dae849c535-igl': [['d7bea32657-igh', 'd7bea32657-igk', 'dae849c535-igh']] --> [['dae849c535-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'f41b19a0e5-igl': [['e46b2f67ac-igh', 'e46b2f67ac-igk', 'f41b19a0e5-igh']] --> [['f41b19a0e5-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '80935fa7a9-igl': [['f7eddbba3a-igh', 'f7eddbba3a-igk']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'd5ee884dfb-igl': [['5827111aff-igh', '5827111aff-igk']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'c0ac4c2456-igl': [['fb5177cbe1-igh', 'fb5177cbe1-igk']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'c1c48672e9-igl': [['66a3e1ee24-igh', '66a3e1ee24-igl', 'c1c48672e9-igh']] --> [['c1c48672e9-igh']]
[93mwarning[0m replaced input metafo for 1 total key in 183 seqs (183 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
             paired-uids        0      269        0       86        0      183
                    loci        0      269        0      269        0        0
        water time: 0.1
hmm
  [93mwarning[0m split apart 4 clusters that contained multiple cdr3 lengths (total clusters: 80 --> 84)
      cluster splits:   3 --> 2 1,   2 --> 1 1,   4 --> 1 3,   6 --> 5 1
  subcluster annotating 84 clusters with steps:  (0.7s) (0.3s) (0.1s) 
    subcluster annotation time 1.1
      total time: 1.3
/home/dralph/work/partis/python/plotting.py:1275: MatplotlibDeprecationWarning: You are modifying the state of a globally registered colormap. In future versions, you will not be able to modify a registered colormap in-place. To remove this warning, you can make a copy of the colormap first. cmap = copy.copy(mpl.cm.get_cmap("viridis"))
  cmap.set_under('w')
   N clusters with all seqs:
        [94mh[0m  177 --> 275  [91m+98[0m
        [95mk[0m   40 --> 162  [91m+122[0m
        [92ml[0m   19 --> 80   [91m+61[0m
      total time: 49.4
[92mseed-partition-new-simu[0m          /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results-slow/test/simu --parameter-dir test/paired/new-results-slow/test/parameters/simu --max-ccf-fail-frac 0.10 --is-simu --seed-unique-id b1db196920-igh:b1db196920-igk --seed-loci igh:igk --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/seed-partition-new-simu
   removing seqs very different from seed seq
                           wrong/no     removed      singly         kept   missing
           locus  before   pairing    cdr3  hfrac    added   after  frac   true ids
             [94mh[0m      864      490       349    16       17      26   0.030    [91m2[0m
             [95mk[0m      586      212       349    16       15      24   0.041    [91m2[0m
     adding seqs paired with uids we kept
           locus  before  added  after  kept frac
             [94mh[0m      26      26     52    0.060
             [95mk[0m      24       9     33    0.056
             [92ml[0m       0      21     21    0.078
      taken 50, paired with taken 56 (total 106)
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/input-seqs-igh.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 52 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 52 / 52 v annotations (0 failed) with 11 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 52 / 52 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 22 (0.423) unproductive
        water time: 0.0
hmm
  caching all 52 naive sequences (0.4s)
    collapsed 52 queries into 30 clusters with identical naive seqs (0.0 sec)
  30 clusters with 10 procs (0.3s)
   28 clusters with 7 procs (0.3s)
   28 clusters with 5 procs (0.4s)
   26 clusters with 3 procs (0.8s)
   22 clusters with 2 procs (0.3s)
   22 clusters with 1 proc (1.0s)
       partition loop time: 3.0
getting annotations for final partition
  subcluster annotating 22 clusters with steps:  (0.4s) (0.2s) (0.1s) 
    subcluster annotation time 0.7
      total time: 4.2
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/input-seqs-igk.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 33 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 33 / 33 v annotations (0 failed) with 6 v genes in 0.0 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 33 / 33 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 4 (0.121) unproductive
        water time: 0.0
hmm
  caching all 33 naive sequences (0.2s)
    collapsed 33 queries into 9 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 9
  9 clusters with 9 procs (0.1s)
   9 clusters with 6 procs (0.1s)
   9 clusters with 4 procs (0.1s)
   8 clusters with 3 procs (0.1s)
   8 clusters with 2 procs (0.1s)
   8 clusters with 1 proc (0.3s)
       partition loop time: 0.9
getting annotations for final partition
  subcluster annotating 8 clusters with steps:  (0.2s) (0.1s) (0.1s) 
    subcluster annotation time 0.4
      total time: 1.6
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/input-seqs-igl.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 21 sequences from test/paired/new-results-slow/test/simu/meta.yaml: loci paired-uids
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 21 / 21 v annotations (0 failed) with 5 v genes in 0.0 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
      info for 21 / 21 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 3 (0.143) unproductive
        water time: 0.0
hmm
  caching all 21 naive sequences (0.2s)
    collapsed 21 queries into 5 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 5
  5 clusters with 5 procs (0.1s)
   5 clusters with 3 procs (0.1s)
   5 clusters with 2 procs (0.1s)
   5 clusters with 1 proc (0.2s)
       partition loop time: 0.5
getting annotations for final partition
  subcluster annotating 5 clusters with steps:  (0.2s) (0.1s) 
    subcluster annotation time 0.3
      total time: 1.0
[44mcombining[0m chains
   cleaning pair info for 106 seqs
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:      [93mwarning[0m adding missing per-seq key: mut_positions
  note: added 1 new input meta key to allowed keys (add 's'/plural to access it in the final annotations): mut_position (mut_positions)
6 total unpaired,  [94mh[0m 5  [95mk[0m 1
    merging igh+igk partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m   11 --> 12   [91m+1[0m
        [95mk[0m    8 --> 12   [91m+4[0m
    re-added unpaired seqs ([94mh[0m 5, [95mk[0m 1) to give total seqs in joint partitions: [94mh[0m 37  [95mk[0m 33
    [93mwarning[0m removed 812/864 uids (leaving 52) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 553/581 uids (leaving 28) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 4 / 37 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 5 / 37 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
  [94mh[0m ccfs:     purity  completeness
      single   1.000  1.000
       joint   1.000  1.000
    [93mwarning[0m removed 553/586 uids (leaving 33) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m removed 553/586 uids (leaving 33) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
  [95mk[0m ccfs:     purity  completeness
      single   0.750  1.000
       joint   1.000  0.933
  merge time 0.0
     removed 15 unseeded clusters (of 16 total, leaving 1) from igh joint partition
  need to get annotations for 1/1 joint igh clusters
  seed cluster size in best joint partition: 14, excluding seed seq: 13
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id b1db196920-igh:b1db196920-igk
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/meta-igh.yaml --input-partition-fname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 14 sequences from test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/meta-igh.yaml: loci paired-uids
  --input-partition-fname: read best partition with 14 sequences in 1 clusters from test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 14 / 14 v annotations (0 failed) with 1 v gene in 0.0 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 14 / 14 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 2 (0.143) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '404bd2c1db-igh': [['30e000dd2a-igh', '30e000dd2a-igl', '404bd2c1db-igk']] --> [['404bd2c1db-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5c6b83b080-igh': [['4a5be9ea90-igh', '4a5be9ea90-igl', '5c6b83b080-igk']] --> [['5c6b83b080-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '7e01d4b4f6-igh': [['7e01d4b4f6-igk', 'a40bd58cc5-igh']] --> [['7e01d4b4f6-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'd1ee25371f-igh': [['7828ab332e-igh', 'd1ee25371f-igk']] --> [['d1ee25371f-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'fbc62a592b-igh': [['ced05fae11-igh', 'ced05fae11-igl', 'fbc62a592b-igk']] --> [['fbc62a592b-igk']]
[93mwarning[0m replaced input metafo for 1 total key in 5 seqs (5 clusters): paired-uids
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
             paired-uids        0       14        0        9        0        5
                    loci        0       14        0       14        0        0
        water time: 0.0
hmm
  subcluster annotating 1 cluster with steps:  (0.1s) (0.1s) (0.1s) 
    subcluster annotation time 0.4
      total time: 0.5
     removed 11 unseeded clusters (of 12 total, leaving 1) from igk joint partition
  need to get annotations for 1/1 joint igk clusters
  seed cluster size in best joint partition: 14, excluding seed seq: 13
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id b1db196920-igh:b1db196920-igk
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/meta-igk.yaml --input-partition-fname test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igk-only-partition.yaml
  --input-metafnames: added meta info for 14 sequences from test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/meta-igk.yaml: loci paired-uids
  --input-partition-fname: read best partition with 14 sequences in 1 clusters from test/paired/new-results-slow/seed-partition-new-simu/seeds/b1db196920-igh+b1db196920-igk/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 14 / 14 v annotations (0 failed) with 1 v gene in 0.0 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 14 / 14 = 1.000   (removed: 0 failed, 0 duplicates [removed when cache file was written])
      kept 1 (0.071) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '404bd2c1db-igk': [['30e000dd2a-igh', '30e000dd2a-igl', '404bd2c1db-igh']] --> [['404bd2c1db-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5c6b83b080-igk': [['4a5be9ea90-igh', '4a5be9ea90-igl', '5c6b83b080-igh']] --> [['5c6b83b080-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '7e01d4b4f6-igk': [['7e01d4b4f6-igh', 'a40bd58cc5-igh']] --> [['7e01d4b4f6-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'd1ee25371f-igk': [['7828ab332e-igh', 'd1ee25371f-igh']] --> [['d1ee25371f-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster 'fbc62a592b-igk': [['ced05fae11-igh', 'ced05fae11-igl', 'fbc62a592b-igh']] --> [['fbc62a592b-igh']]
[93mwarning[0m replaced input metafo for 1 total key in 5 seqs (5 clusters): paired-uids
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
             paired-uids        0       14        0        9        0        5
                    loci        0       14        0       14        0        0
        water time: 0.0
hmm
  subcluster annotating 1 cluster with steps:  (0.1s) (0.1s) (0.1s) 
    subcluster annotation time 0.3
      total time: 0.4
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:  11 total unpaired,  [94mh[0m 5  [92ml[0m 6
    merging igh+igl partitions
  [93mwarning[0m paired uids in line, but <translate_pids> wasn't set, so they won't be translated
   N clusters without bad/unpaired seqs:
        [94mh[0m    9 --> 9   
        [92ml[0m    5 --> 9    [91m+4[0m
    re-added unpaired seqs ([94mh[0m 5, [92ml[0m 6) to give total seqs in joint partitions: [94mh[0m 20  [92ml[0m 21
  merge time 0.0
     removed 13 unseeded clusters (of 13 total, leaving 0) from igh joint partition
     removed 9 unseeded clusters (of 9 total, leaving 0) from igl joint partition
   N clusters with all seqs:
        [94mh[0m   22 --> 1    [91m-21[0m
        [95mk[0m    8 --> 1    [91m-7[0m
      total time: 10.2
[92mget-selection-metrics-new-simu[0m   /home/dralph/work/partis/bin/partis get-selection-metrics --dont-write-git-info --paired-loci --existing-output-run-cfg paired --min-selection-metric-cluster-size 10 --min-paired-cluster-size-to-read 10 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/partition-new-simu --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --min-selection-metric-cluster-size 10 --min-paired-cluster-size-to-read 10 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: by default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set). If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 10 clusters with sizes 19 18 13 12 12 11 11 10 10 10
      skipped 186 smaller than 10
    getting trees for 10 clusters with sizes: 19 18 13 12 12 11 11 10 10 10
      starting 10 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/140891/fasttree.out /tmp/dralph/tree-inference/140891/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/596853/fasttree.out /tmp/dralph/tree-inference/596853/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/888598/fasttree.out /tmp/dralph/tree-inference/888598/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/841235/fasttree.out /tmp/dralph/tree-inference/841235/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/800875/fasttree.out /tmp/dralph/tree-inference/800875/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/66172/fasttree.out /tmp/dralph/tree-inference/66172/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/267459/fasttree.out /tmp/dralph/tree-inference/267459/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/123646/fasttree.out /tmp/dralph/tree-inference/123646/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/519501/fasttree.out /tmp/dralph/tree-inference/519501/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/797926/fasttree.out /tmp/dralph/tree-inference/797926/input-seqs.fa
      made 10 fasttree trees (0.5s)
    tree origins: 10 ran fasttree
      setting default tau to 1 / 382 = 0.0026
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0026
      setting default tau to 1 / 382 = 0.0026
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0026
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 3): skipped 7/16 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: cik ivy mpy
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 7): skipped 2/12 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: den
                [94miclust 8: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 2/10 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.013  mfreq 0.012  diff 0.002  abs(frac diff) 17%  ratio 1.2
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0074    0.0056       1.3     0.0018     cec2fa39f4-igh
              0.0074    0.0056       1.3     0.0018     ed6f8d17b2-igh
          10 with highest+lowest ratios:
              0.0074    0.0056       1.3     0.0018     cec2fa39f4-igh
              0.0074    0.0056       1.3     0.0018     ed6f8d17b2-igh
              0.0074    0.0056       1.3     0.0018     cec2fa39f4-igh
              0.0074    0.0056       1.3     0.0018     ed6f8d17b2-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 8): skipped 11/16 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: aop atv gpx hks lor
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 9): skipped 2/12 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: dqs
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh-selection-metrics.yaml
      total time: 0.8
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igk --dont-write-git-info --min-selection-metric-cluster-size 10 --min-paired-cluster-size-to-read 10 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: by default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set). If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 12 clusters with sizes 19 17 17 15 15 13 11 11 11 10 10 10
      skipped 150 smaller than 10
    getting trees for 12 clusters with sizes: 19 17 17 15 15 13 11 11 11 10 10 10
      starting 12 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/140891/fasttree.out /tmp/dralph/tree-inference/140891/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/596853/fasttree.out /tmp/dralph/tree-inference/596853/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/888598/fasttree.out /tmp/dralph/tree-inference/888598/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/841235/fasttree.out /tmp/dralph/tree-inference/841235/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/800875/fasttree.out /tmp/dralph/tree-inference/800875/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/66172/fasttree.out /tmp/dralph/tree-inference/66172/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/267459/fasttree.out /tmp/dralph/tree-inference/267459/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/123646/fasttree.out /tmp/dralph/tree-inference/123646/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/519501/fasttree.out /tmp/dralph/tree-inference/519501/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/797926/fasttree.out /tmp/dralph/tree-inference/797926/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/471325/fasttree.out /tmp/dralph/tree-inference/471325/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/495185/fasttree.out /tmp/dralph/tree-inference/495185/input-seqs.fa
      made 12 fasttree trees (0.6s)
    tree origins: 12 ran fasttree
      setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 2/21 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: cgh
      setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0030
                [94miclust 5: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 9/13 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.005  mfreq 0.004  diff 0.001  abs(frac diff) 34%  ratio 1.3
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0048    0.0031       1.5     0.0017     84daff550c-igk
              0.0042    0.0031       1.4     0.0011     0d7575234a-igk
              0.0042    0.0031       1.4     0.0011     021cc021e5-igk
              0.0042    0.0031       1.4     0.0011     1de385032c-igk
              0.0042    0.0031       1.4     0.0011     67694388de-igk
              0.0042    0.0031       1.4     0.0011     fb5177cbe1-igk
              0.0042    0.0031       1.4     0.0011     6aaf9f116a-igk
              0.0042    0.0031       1.4     0.0011     b7acf21689-igk
              0.0042    0.0031       1.4     0.0011     df22339d53-igk
          10 with highest+lowest ratios:
              0.0048    0.0031       1.5     0.0017     84daff550c-igk
              0.0042    0.0031       1.4     0.0011     0d7575234a-igk
              0.0042    0.0031       1.4     0.0011     021cc021e5-igk
              0.0042    0.0031       1.4     0.0011     1de385032c-igk
              0.0042    0.0031       1.4     0.0011     67694388de-igk
              0.0042    0.0031       1.4     0.0011     67694388de-igk
              0.0042    0.0031       1.4     0.0011     fb5177cbe1-igk
              0.0042    0.0031       1.4     0.0011     6aaf9f116a-igk
              0.0042    0.0031       1.4     0.0011     b7acf21689-igk
              0.0042    0.0031       1.4     0.0011     df22339d53-igk
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 5): skipped 9/18 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: ckv mrt nor rvx
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 6): skipped 3/13 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: hix
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 10): skipped 17/19 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: agh aly bhr bsx gjr kvw prw tux
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk-selection-metrics.yaml
      total time: 0.8
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --min-selection-metric-cluster-size 10 --min-paired-cluster-size-to-read 10 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: by default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set). If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 5 clusters with sizes 13 12 12 11 11
      skipped 130 smaller than 10
    getting trees for 5 clusters with sizes: 13 12 12 11 11
      starting 5 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/140891/fasttree.out /tmp/dralph/tree-inference/140891/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/596853/fasttree.out /tmp/dralph/tree-inference/596853/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/888598/fasttree.out /tmp/dralph/tree-inference/888598/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/841235/fasttree.out /tmp/dralph/tree-inference/841235/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/800875/fasttree.out /tmp/dralph/tree-inference/800875/input-seqs.fa
      made 5 fasttree trees (0.3s)
    tree origins: 5 ran fasttree
      setting default tau to 1 / 370 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0027
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 2/15 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bnw
      setting default tau to 1 / 370 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0027
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 2/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: fnv
                [94miclust 3: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 6/11 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.123  mfreq 0.097  diff 0.026  abs(frac diff) 27%  ratio 1.3
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.1482    0.1090       1.4     0.0392     c2272283dc-igh
              0.1164    0.0824       1.4     0.0339     aa25e6c0ce-igh
              0.1217    0.0904       1.3     0.0312     73b7148c7e-igh
              0.1268    0.0957       1.3     0.0311     08ffa9f078-igh
              0.1257    0.0957       1.3     0.0299     9ed10b6475-igh
              0.1114    0.0878       1.3     0.0236     f0a62c811f-igh
          10 with highest+lowest ratios:
              0.1164    0.0824       1.4     0.0339     aa25e6c0ce-igh
              0.1482    0.1090       1.4     0.0392     c2272283dc-igh
              0.1217    0.0904       1.3     0.0312     73b7148c7e-igh
              0.1268    0.0957       1.3     0.0311     08ffa9f078-igh
              0.1257    0.0957       1.3     0.0299     9ed10b6475-igh
              0.1482    0.1090       1.4     0.0392     c2272283dc-igh
              0.1217    0.0904       1.3     0.0312     73b7148c7e-igh
              0.1268    0.0957       1.3     0.0311     08ffa9f078-igh
              0.1257    0.0957       1.3     0.0299     9ed10b6475-igh
              0.1114    0.0878       1.3     0.0236     f0a62c811f-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 3): skipped 21/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bez blu bvw cik fpy gno hiq ivy jks mpy
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh-selection-metrics.yaml
      total time: 0.4
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igl --dont-write-git-info --min-selection-metric-cluster-size 10 --min-paired-cluster-size-to-read 10 --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl.yaml
  note: --parameter-dir not set, so using default: x-dummy-x
  note: by default we print/operate on *all* annotations in the output file, which in general can include annotations from non-best partititons and non-seed clusters (e.g. if --n-final-clusters was set). If you want to restrict to particular annotations, use one of --only-print-best-partition, --only-print-seed-clusters, or --only-print-queries-to-include-clusters
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 5 clusters with sizes 14 13 13 11 10
      skipped 79 smaller than 10
    getting trees for 5 clusters with sizes: 14 13 13 11 10
      starting 5 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/140891/fasttree.out /tmp/dralph/tree-inference/140891/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/596853/fasttree.out /tmp/dralph/tree-inference/596853/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/888598/fasttree.out /tmp/dralph/tree-inference/888598/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/841235/fasttree.out /tmp/dralph/tree-inference/841235/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out /tmp/dralph/tree-inference/800875/fasttree.out /tmp/dralph/tree-inference/800875/input-seqs.fa
      made 5 fasttree trees (0.2s)
    tree origins: 5 ran fasttree
      setting default tau to 1 / 340 = 0.0029
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0029
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 2/16 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bnw
      setting default tau to 1 / 340 = 0.0029
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0029
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 20/23 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: awy doq dst eov eqs flx ily jpw npq
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 20/23 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: ajy apr bft dhq dij esv eyz twx uvx
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl-selection-metrics.yaml
      total time: 0.4
[44mgetting combined h/l selection metrics[0m
    igh+igk: 153 unpaired light clusters after finding h/l cluster pairs
    igh+igk: skipped 34 annotations with zero length paired uids
    igh+igk: skipped 153 annotations with N h or l ids < 10
    [93mwarning[0m check_concordance_of_cpath_and_annotations(): missing annotations for 4/80 clusters in best partition with sizes: 6, 4, 3, 2
        8 extra annotations (i.e. they're for clusters not in best partition) with sizes: 2 1 1 1 1 3 5 1
          missing 'best' cluster with size 3 overlaps with the following (overlap/size): 2/2  1/1
          missing 'best' cluster with size 2 overlaps with the following (overlap/size): 1/1  1/1
          missing 'best' cluster with size 4 overlaps with the following (overlap/size): 1/1  3/3
          missing 'best' cluster with size 6 overlaps with the following (overlap/size): 5/5  1/1
          extra annotation with size 2 overlaps with the following best clusters (overlap/size): 2/3
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/3
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/2
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/2
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/4
          extra annotation with size 3 overlaps with the following best clusters (overlap/size): 3/4
          extra annotation with size 5 overlaps with the following best clusters (overlap/size): 5/6
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/6
      [93mwarning[0m missing annotation for light chain (size 6, paired with size 8) when finding cluster pairs d73412efe7-igl:1508039a71-igl:d257d926e4-igl:80b4a5a06e-igl:936cae3652-igl:eb47515f79-igl 14ce7f9ce4-igh:1508039a71-igh:2af140f66a-igh:80b4a5a06e-igh:936cae3652-igh:eb47515f79-igh:cd06c437d5-igh:55d928454f-igh
      [93mwarning[0m missing annotation for light chain (size 4, paired with size 7) when finding cluster pairs 3a39953eef-igl:4d7f2878e3-igl:55bb220ea6-igl:9aecef6d2b-igl 3a39953eef-igh:4d7f2878e3-igh:7882852aca-igh:9aecef6d2b-igh:2640869bf5-igh:1ed69d5cb4-igh:7307ea6392-igh
      [93mwarning[0m missing annotation for light chain (size 3, paired with size 4) when finding cluster pairs 14da0288b1-igl:e3e75f4e21-igl:b3402431a8-igl 14da0288b1-igh:8fc745fa98-igh:a8efa7f387-igh:5cfe402b65-igh
      [93mwarning[0m missing annotation for light chain (size 2, paired with size 3) when finding cluster pairs 90d4aedf32-igl:5b490082c4-igl 90d4aedf32-igh:fe20cab695-igh:d4a0ff330d-igh
    igh+igl: 71 unpaired light clusters after finding h/l cluster pairs
    igh+igl: skipped 56 annotations with zero length paired uids
    igh+igl: skipped 70 annotations with N h or l ids < 10
           using observed cons seq
          [93mwarning[0m chose 8 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 2724325a23-igk 63b0b4990b-igk 761e05841a-igk 79fba38329-igk a65e53c6f8-igk b67761e063-igh c3dece8d2d-igk f051f6397d-igh
           using observed cons seq
          [93mwarning[0m chose 4 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 1d3b5e99a7-igh 404bd2c1db-igh 6110c1b238-igk ac8201e16b-igh
           using observed cons seq
          [93mwarning[0m chose 3 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 6385edc10e-igh 6385edc10e-igk 7be03be402-igh 85b221334a-igk
           using observed cons seq
          [93mwarning[0m chose 3 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 35fc655801-igk 6c897f6d54-igk a4197ef4d6-igh
           using observed cons seq
          [93mwarning[0m chose 7 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 0d7575234a-igh 0d7575234a-igk 41548f26c9-igk 67694388de-igh 6aaf9f116a-igh 84daff550c-igh df22339d53-igk fb5177cbe1-igh
           using observed cons seq
          [93mwarning[0m chose 2 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 3204353335-igh e0a0ffec99-igh e0a0ffec99-igk
           cons seq not observed
           less than 0.75 (3 / 12 = 0.25) of [91mh[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
           less than 0.75 (2 / 13 = 0.15) of [91ml[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
          [93mwarning[0m chose 4 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 09e451e585-igl 20db9afdb1-igl 2a4f74ab54-igh 75f8ff3130-igh
           using observed cons seq
          [93mwarning[0m chose 1 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 771472b9c9-igh
           cons seq not observed
           less than 0.75 (3 / 11 = 0.27) of [91mh[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
           less than 0.75 (1 / 13 = 0.08) of [91ml[0m seqs have indels, so using 'indel-reversed' seqs (rather than 'input' seqs) to calculate cons seq
          [93mwarning[0m chose 3 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: 39e0ae6e64-igh 3f337e6349-igl c2272283dc-igh
           using observed cons seq
          [93mwarning[0m chose 2 abs with shm indels): the consensus sequence may or may not reflect the indels (see previous lines -- whether 'input' or 'indel-reversed' seqs were used to calculate consensus depends on the fraction of seqs in the family with indels). uids: c1ead9832e-igk cfe3b29587-igh cfe3b29587-igk
    getting selection metrics (lbi lbr aa-lbi aa-lbr cons-dist-aa) with inferred lines: 10 clusters with sizes 15 12 12 12 11 11 11 10 10 10
      skipped 4 smaller than 10
    getting trees for 10 clusters with sizes: 15 12 12 12 11 11 11 10 10 10
      starting 10 jobs
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-0/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-0/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-1/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-1/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-2/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-2/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-3/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-3/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-4/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-4/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-5/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-5/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-6/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-6/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-7/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-7/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-8/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-8/input-seqs.fa
        [91mrun[0m /home/dralph/work/partis/bin/FastTree -gtr -nt -out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-9/fasttree.out test/paired/new-results-slow/partition-new-simu/fasttree/iclust-9/input-seqs.fa
      made 10 fasttree trees (0.5s)
    tree origins: 10 ran fasttree
      setting default tau to 1 / 714 = 0.0014
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0014
      setting default tau to 1 / 714 = 0.0014
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0014
                [94miclust 2: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 9/12 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.003  mfreq 0.002  diff 0.001  abs(frac diff) 89%  ratio 1.9
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0031    0.0014       2.2     0.0017     84daff550c_contig_igh+igk
              0.0031    0.0014       2.2     0.0017     6aaf9f116a_contig_igh+igk
              0.0031    0.0014       2.2     0.0017     b7acf21689_contig_igh+igk
              0.0031    0.0014       2.2     0.0017     df22339d53_contig_igh+igk
              0.0040    0.0028       1.4     0.0012     657c6a602d_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     0d7575234a_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     1de385032c_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     67694388de_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     fb5177cbe1_contig_igh+igk
          10 with highest+lowest ratios:
              0.0031    0.0014       2.2     0.0017     84daff550c_contig_igh+igk
              0.0031    0.0014       2.2     0.0017     6aaf9f116a_contig_igh+igk
              0.0031    0.0014       2.2     0.0017     b7acf21689_contig_igh+igk
              0.0031    0.0014       2.2     0.0017     df22339d53_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     0d7575234a_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     0d7575234a_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     1de385032c_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     67694388de_contig_igh+igk
              0.0026    0.0014       1.8     0.0012     fb5177cbe1_contig_igh+igk
              0.0040    0.0028       1.4     0.0012     657c6a602d_contig_igh+igk
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 9/17 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: apr fnv nox uvx
                [94miclust 3: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 4/12 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.009  mfreq 0.007  diff 0.001  abs(frac diff) 22%  ratio 1.2
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0110    0.0084       1.3     0.0026     21d47f73e7_contig_igh+igl
              0.0071    0.0056       1.3     0.0015     09e451e585_contig_igh+igl
              0.0056    0.0042       1.3     0.0014     3921af524b_contig_igh+igl
              0.0035    0.0028       1.3     0.0007     09f74ae679_contig_igh+igl
          10 with highest+lowest ratios:
              0.0056    0.0042       1.3     0.0014     3921af524b_contig_igh+igl
              0.0110    0.0084       1.3     0.0026     21d47f73e7_contig_igh+igl
              0.0071    0.0056       1.3     0.0015     09e451e585_contig_igh+igl
              0.0035    0.0028       1.3     0.0007     09f74ae679_contig_igh+igl
              0.0035    0.0028       1.3     0.0007     09f74ae679_contig_igh+igl
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 3): skipped 18/21 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bez bko blu bvw cik fpy gno hiq
                [94miclust 5: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 9/11 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.011  mfreq 0.009  diff 0.001  abs(frac diff) 34%  ratio 1.3
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0053    0.0043       1.3     0.0011     4ef071ea7c-igh+dcc6a48450-igk
              0.0020    0.0014       1.4     0.0006     577773b57d_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     7230f7a64a_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     7d4166ae48_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     b374f7dd77_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     c1ead9832e_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     cfe3b29587_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     dc78cbb7af_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     f7eddbba3a_contig_igh+igk
          10 with highest+lowest ratios:
              0.0020    0.0014       1.4     0.0006     577773b57d_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     7230f7a64a_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     7d4166ae48_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     b374f7dd77_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     c1ead9832e_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     c1ead9832e_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     cfe3b29587_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     dc78cbb7af_contig_igh+igk
              0.0020    0.0014       1.4     0.0006     f7eddbba3a_contig_igh+igk
              0.0053    0.0043       1.3     0.0011     4ef071ea7c-igh+dcc6a48450-igk
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 5): skipped 7/15 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: ckv hmy rvx
                [94miclust 8: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 5/10 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
                    mean values:  tree depth 0.077  mfreq 0.062  diff 0.015  abs(frac diff) 24%  ratio 1.2
          10 with highest abs(diff):
            tree depth   mfreq      ratio    diff
              0.0867    0.0664       1.3     0.0203     c2272283dc_contig_igh+igl
              0.0754    0.0567       1.3     0.0187     aa25e6c0ce_contig_igh+igl
              0.0791    0.0609       1.3     0.0183     08ffa9f078_contig_igh+igl
              0.0783    0.0609       1.3     0.0174     73b7148c7e_contig_igh+igl
              0.0756    0.0595       1.3     0.0161     9ed10b6475_contig_igh+igl
          10 with highest+lowest ratios:
              0.0754    0.0567       1.3     0.0187     aa25e6c0ce_contig_igh+igl
              0.0867    0.0664       1.3     0.0203     c2272283dc_contig_igh+igl
              0.0791    0.0609       1.3     0.0183     08ffa9f078_contig_igh+igl
              0.0783    0.0609       1.3     0.0174     73b7148c7e_contig_igh+igl
              0.0756    0.0595       1.3     0.0161     9ed10b6475_contig_igh+igl
              0.0754    0.0567       1.3     0.0187     aa25e6c0ce_contig_igh+igl
              0.0867    0.0664       1.3     0.0203     c2272283dc_contig_igh+igl
              0.0791    0.0609       1.3     0.0183     08ffa9f078_contig_igh+igl
              0.0783    0.0609       1.3     0.0174     73b7148c7e_contig_igh+igl
              0.0756    0.0595       1.3     0.0161     9ed10b6475_contig_igh+igl
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 8): skipped 19/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: aft aop atv gpx hks kxz lor ouz pwz
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/selection-metrics.yaml
      writing 51 chosen abs to test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv
      total time: 5.0
