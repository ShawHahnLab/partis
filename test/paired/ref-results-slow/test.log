[92mcache-parameters-data[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --paired-indir test/paired-data --parameter-dir test/paired/new-results-slow/test/parameters/data --n-max-queries -1 --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[44mcache-parameters[0m [94migh[0m:
  note: adding input metafname from default location (test/paired-data/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-max-queries -1 --random-seed 1 --n-procs 10 --infname test/paired-data/igh.fa --sw-cachefname test/paired/new-results-slow/test/parameters/data/igh/sw-cache.yaml --input-metafnames test/paired-data/meta.yaml
  --input-metafnames: added meta info for 48 sequences from test/paired-data/meta.yaml: paired-uids
caching parameters
  vsearch: 48 / 48 v annotations (0 failed) with 29 v genes in 0.1 sec
    keeping 23 / 220 v genes
smith-waterman  (new-allele fitting)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/data/igh/sw-cache.yaml
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/data/igh/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/data/igh/sw (2.0 sec)
    water time: 2.3  (ig-sw 2.1  processing 0.2)
  writing hmms (0.2 sec)
hmm
    running 10 procs
                    calcd:         vtb 48        fwd  0
             min-max time:  0.2 - 0.3 sec
    reading output
        read 48 hmm output lines with 48 sequences in 48 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/data/igh/hmm (1.8 sec)
         infra time: 1.8
      hmm step time: 2.3
  writing hmms (0.2 sec)
      total time: 5.7
[44mcache-parameters[0m [94migk[0m:
  note: adding input metafname from default location (test/paired-data/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igk --n-max-queries -1 --random-seed 1 --n-procs 10 --infname test/paired-data/igk.fa --sw-cachefname test/paired/new-results-slow/test/parameters/data/igk/sw-cache.yaml --input-metafnames test/paired-data/meta.yaml
  --input-metafnames: added meta info for 37 sequences from test/paired-data/meta.yaml: paired-uids
caching parameters
  vsearch: 37 / 37 v annotations (0 failed) with 17 v genes in 0.1 sec
    keeping 16 / 58 v genes
smith-waterman  (new-allele fitting)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/data/igk/sw-cache.yaml
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/data/igk/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/data/igk/sw (1.5 sec)
    water time: 1.7  (ig-sw 1.6  processing 0.1)
  writing hmms (0.1 sec)
hmm
    running 10 procs
                    calcd:         vtb 37        fwd  0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 37 hmm output lines with 37 sequences in 37 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/data/igk/hmm (1.2 sec)
         infra time: 1.3
      hmm step time: 1.5
  writing hmms (0.1 sec)
      total time: 4.0
[44mcache-parameters[0m [94migl[0m:
  note: adding input metafname from default location (test/paired-data/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igl --n-max-queries -1 --random-seed 1 --n-procs 10 --infname test/paired-data/igl.fa --sw-cachefname test/paired/new-results-slow/test/parameters/data/igl/sw-cache.yaml --input-metafnames test/paired-data/meta.yaml
  --input-metafnames: added meta info for 15 sequences from test/paired-data/meta.yaml: paired-uids
caching parameters
  vsearch: 15 / 15 v annotations (0 failed) with 13 v genes in 0.1 sec
    keeping 10 / 70 v genes
smith-waterman  (new-allele fitting)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.1 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/data/igl/sw-cache.yaml
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.0 sec
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
        writing sw results to test/paired/new-results-slow/test/parameters/data/igl/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/data/igl/sw (1.0 sec)
    water time: 1.2  (ig-sw 1.1  processing 0.1)
  writing hmms (0.1 sec)
hmm
    running 10 procs
                    calcd:         vtb 15        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 15 hmm output lines with 15 sequences in 15 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/data/igl/hmm (0.7 sec)
         infra time: 0.8
      hmm step time: 0.9
  writing hmms (0.1 sec)
      total time: 2.7
      total time: 13.4
[92msimulate[0m                         /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --paired-loci --parameter-dir test/paired/new-results-slow/test/parameters/data --n-sim-events 200 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/test/simu --indel-frequency 0.2
    cleaning paired files in test/paired/new-results-slow/test/simu/
[94migh+igk[0m: simulating 134 events
[44mgenerate-trees[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-trees 134 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 177687104 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 134 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 134 trees:   depth 0.02815   leaves 5.57
    writing trees to test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
      total time: 1.6
[44msimulate[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-sim-events 134 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 177687104 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igk/igh.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
simulating
      --> proc 8
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/919460/trees-sub-8.nwk
    made 13 events with 57 seqs in 2.4s (2.0s of which was running bppseqgen)
      total time: 2.7

      --> proc 5
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/919460/trees-sub-5.nwk
    made 13 events with 47 seqs in 2.4s (2.0s of which was running bppseqgen)
      total time: 2.8

      --> proc 4
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/919460/trees-sub-4.nwk
    made 13 events with 59 seqs in 2.5s (2.2s of which was running bppseqgen)
      total time: 2.9

      --> proc 6
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/919460/trees-sub-6.nwk
    made 13 events with 55 seqs in 2.7s (2.3s of which was running bppseqgen)
      total time: 3.0

      --> proc 1
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/919460/trees-sub-1.nwk
    made 13 events with 71 seqs in 2.8s (2.4s of which was running bppseqgen)
      total time: 3.2

      --> proc 7
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/919460/trees-sub-7.nwk
    made 13 events with 65 seqs in 2.8s (2.5s of which was running bppseqgen)
      total time: 3.1

      --> proc 3
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/919460/trees-sub-3.nwk
    made 13 events with 84 seqs in 2.8s (2.4s of which was running bppseqgen)
      total time: 3.2

      --> proc 0
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/919460/trees-sub-0.nwk
    made 13 events with 94 seqs in 2.9s (2.5s of which was running bppseqgen)
      total time: 3.3

      --> proc 2
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/919460/trees-sub-2.nwk
    made 13 events with 104 seqs in 2.9s (2.6s of which was running bppseqgen)
      total time: 3.4

      --> proc 9
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 17 to match trees read from /tmp/dralph/hmms/919460/trees-sub-9.nwk
    made 17 events with 111 seqs in 3.4s (2.8s of which was running bppseqgen)
      total time: 3.7

   read 134 events with 747 seqs from 10 .yaml files
      total time: 4.6
[44msimulate[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igk --n-sim-events 134 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 298017927 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igk/igk.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
simulating
      --> proc 1
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/740618/trees-sub-1.nwk
    made 13 events with 71 seqs in 2.1s (1.8s of which was running bppseqgen)
      total time: 2.5

      --> proc 5
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/740618/trees-sub-5.nwk
    made 13 events with 47 seqs in 2.1s (1.9s of which was running bppseqgen)
      total time: 2.4

      --> proc 3
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/740618/trees-sub-3.nwk
    made 13 events with 84 seqs in 2.1s (1.9s of which was running bppseqgen)
      total time: 2.5

      --> proc 7
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/740618/trees-sub-7.nwk
    made 13 events with 65 seqs in 2.2s (1.9s of which was running bppseqgen)
      total time: 2.5

      --> proc 6
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/740618/trees-sub-6.nwk
    made 13 events with 55 seqs in 2.2s (1.9s of which was running bppseqgen)
      total time: 2.5

      --> proc 8
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/740618/trees-sub-8.nwk
    made 13 events with 57 seqs in 2.3s (2.1s of which was running bppseqgen)
      total time: 2.6

      --> proc 4
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/740618/trees-sub-4.nwk
    made 13 events with 59 seqs in 2.4s (2.1s of which was running bppseqgen)
      total time: 2.7

      --> proc 2
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/740618/trees-sub-2.nwk
    made 13 events with 104 seqs in 2.4s (2.2s of which was running bppseqgen)
      total time: 2.8

      --> proc 0
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/740618/trees-sub-0.nwk
    made 13 events with 94 seqs in 2.6s (2.3s of which was running bppseqgen)
      total time: 3.0

      --> proc 9
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 17 to match trees read from /tmp/dralph/hmms/740618/trees-sub-9.nwk
    made 17 events with 111 seqs in 2.8s (2.6s of which was running bppseqgen)
      total time: 3.2

   read 134 events with 747 seqs from 10 .yaml files
      total time: 4.0
[94migh+igl[0m: simulating 66 events
[44mgenerate-trees[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-trees 66 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 172687121 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 66 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 66 trees:   depth 0.02433   leaves 6.45
    writing trees to test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
      total time: 1.5
[44msimulate[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-sim-events 66 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 172687121 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igl/igh.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
simulating
      --> proc 0
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/651759/trees-sub-0.nwk
    made 6 events with 15 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.5

      --> proc 4
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/651759/trees-sub-4.nwk
    made 6 events with 22 seqs in 1.2s (1.1s of which was running bppseqgen)
      total time: 1.5

      --> proc 3
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/651759/trees-sub-3.nwk
    made 6 events with 41 seqs in 1.2s (1.0s of which was running bppseqgen)
      total time: 1.6

      --> proc 6
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/651759/trees-sub-6.nwk
    made 6 events with 30 seqs in 1.2s (0.9s of which was running bppseqgen)
      total time: 1.4

      --> proc 5
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/651759/trees-sub-5.nwk
    made 6 events with 27 seqs in 1.2s (0.9s of which was running bppseqgen)
      total time: 1.4

      --> proc 7
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/651759/trees-sub-7.nwk
    made 6 events with 31 seqs in 1.2s (1.0s of which was running bppseqgen)
      total time: 1.5

      --> proc 2
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/651759/trees-sub-2.nwk
    made 6 events with 43 seqs in 1.3s (1.2s of which was running bppseqgen)
      total time: 1.7

      --> proc 1
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/651759/trees-sub-1.nwk
    made 6 events with 49 seqs in 1.5s (1.4s of which was running bppseqgen)
      total time: 1.9

      --> proc 8
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/651759/trees-sub-8.nwk
    made 6 events with 69 seqs in 1.8s (1.7s of which was running bppseqgen)
      total time: 2.1

      --> proc 9
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 12 to match trees read from /tmp/dralph/hmms/651759/trees-sub-9.nwk
    made 12 events with 99 seqs in 2.7s (2.4s of which was running bppseqgen)
      total time: 3.1

   read 66 events with 426 seqs from 10 .yaml files
      total time: 3.8
[44msimulate[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igl --n-sim-events 66 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --random-seed 1456246501 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igl/igl.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
simulating
      --> proc 0
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/831642/trees-sub-0.nwk
    made 6 events with 15 seqs in 1.0s (0.9s of which was running bppseqgen)
      total time: 1.4

      --> proc 4
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/831642/trees-sub-4.nwk
    made 6 events with 22 seqs in 1.0s (0.8s of which was running bppseqgen)
      total time: 1.3

      --> proc 6
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/831642/trees-sub-6.nwk
    made 6 events with 30 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.4

      --> proc 3
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/831642/trees-sub-3.nwk
    made 6 events with 41 seqs in 1.1s (1.0s of which was running bppseqgen)
      total time: 1.5

      --> proc 5
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/831642/trees-sub-5.nwk
    made 6 events with 27 seqs in 1.0s (0.9s of which was running bppseqgen)
      total time: 1.4

      --> proc 7
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/831642/trees-sub-7.nwk
    made 6 events with 31 seqs in 1.1s (1.0s of which was running bppseqgen)
      total time: 1.5

      --> proc 2
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/831642/trees-sub-2.nwk
    made 6 events with 43 seqs in 1.1s (1.0s of which was running bppseqgen)
      total time: 1.6

      --> proc 1
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/831642/trees-sub-1.nwk
    made 6 events with 49 seqs in 1.2s (1.1s of which was running bppseqgen)
      total time: 1.7

      --> proc 8
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/831642/trees-sub-8.nwk
    made 6 events with 69 seqs in 1.3s (1.2s of which was running bppseqgen)
      total time: 1.5

      --> proc 9
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 12 to match trees read from /tmp/dralph/hmms/831642/trees-sub-9.nwk
    made 12 events with 99 seqs in 2.1s (1.9s of which was running bppseqgen)
      total time: 2.4

   read 66 events with 426 seqs from 10 .yaml files
      total time: 3.3
[94migh+igk[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results-slow/test/simu/igh+igk/
[94migh+igl[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results-slow/test/simu/igh+igl/
[91mrun[0m cd test/paired/new-results-slow/test/simu && ln -sf igh+igk/igk.yaml igk.yaml
[91mrun[0m cd test/paired/new-results-slow/test/simu && ln -sf igh+igl/igl.yaml igl.yaml
      total time: 22.4
[92mcache-parameters-simu[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --paired-indir test/paired/new-results-slow/test/simu --parameter-dir test/paired/new-results-slow/test/parameters/simu --is-simu --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[44mcache-parameters[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results-slow/test/simu/igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 1173 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
  note: running on a lot of sequences (1173) without setting --outfname. Which is ok, but there will be no persistent record of the results (except the parameter directory).
caching parameters
  vsearch: 1173 / 1173 v annotations (0 failed) with 38 v genes in 0.2 sec
    keeping 23 / 220 v genes
smith-waterman  (new-allele fitting)
  vsearch: 1173 / 1173 v annotations (0 failed) with 23 v genes in 0.3 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
    running 10 procs for 1173 seqs
    running 11 procs for 45 seqs
      info for 1173 / 1173 = 1.000   (removed: 0 failed)
      kept 404 (0.344) unproductive
    water time: 1.7  (ig-sw 0.1  processing 0.2)
smith-waterman  (writing parameters)
  vsearch: 1173 / 1173 v annotations (0 failed) with 23 v genes in 0.4 sec
    running 10 procs for 1173 seqs
    running 11 procs for 45 seqs
      info for 1173 / 1173 = 1.000   (removed: 0 failed)
      kept 404 (0.344) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igh/sw (1.7 sec)
    water time: 4.3  (ig-sw 2.6  processing 0.3)
  writing hmms (0.4 sec)
hmm
    skipping matches from 4 genes without enough counts: [95mh[0m[91mj[0m[95m4[0m[93m01[0m [95mh[0m[91mj[0m[95m6[0m[93m04[0m [95mh[0m[91mj[0m[95m4[0m[93m03[0m [95mh[0m[91mj[0m[95m5[0m[93m01[0m
        hmm prep time: 0.1
    running 10 procs
                    calcd:         vtb 1173        fwd    0
             min-max time:  1.6 - 1.8 sec
    reading output
        read 1173 hmm output lines with 1173 sequences in 1173 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igh/hmm (1.6 sec)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igh/true (1.6 sec)
         infra time: 5.1
      hmm step time: 7.1
  writing hmms (0.3 sec)
      total time: 16.5
[44mcache-parameters[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results-slow/test/simu/igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 747 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
caching parameters
  vsearch: 747 / 747 v annotations (0 failed) with 17 v genes in 0.1 sec
    keeping 16 / 58 v genes
smith-waterman  (new-allele fitting)
  vsearch: 747 / 747 v annotations (0 failed) with 16 v genes in 0.2 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
    running 10 procs for 747 seqs
    running 11 procs for 14 seqs
      info for 747 / 747 = 1.000   (removed: 0 failed)
      kept 128 (0.171) unproductive
    water time: 0.8  (ig-sw 0.1  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 747 / 747 v annotations (0 failed) with 16 v genes in 0.2 sec
    running 10 procs for 747 seqs
    running 11 procs for 14 seqs
      info for 747 / 747 = 1.000   (removed: 0 failed)
      kept 128 (0.171) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igk/sw (1.1 sec)
    water time: 2.6  (ig-sw 1.7  processing 0.2)
  writing hmms (0.2 sec)
hmm
    skipping matches from 2 genes without enough counts: [95mk[0m[91mj[0m[95m4[0m[93m02[0m [95mk[0m[91mj[0m[95m2[0m[93m02[0m
    running 10 procs
                    calcd:         vtb 747        fwd   0
             min-max time:  0.7 - 0.8 sec
    reading output
        read 747 hmm output lines with 747 sequences in 747 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igk/hmm (1.1 sec)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igk/true (1.2 sec)
         infra time: 4.0
      hmm step time: 4.9
  writing hmms (0.3 sec)
      total time: 10.5
[44mcache-parameters[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results-slow/test/simu/igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 426 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
caching parameters
  vsearch: 426 / 426 v annotations (0 failed) with 12 v genes in 0.1 sec
    keeping 10 / 70 v genes
smith-waterman  (new-allele fitting)
  vsearch: 426 / 426 v annotations (0 failed) with 10 v genes in 0.1 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
    running 10 procs for 426 seqs
    running 11 procs for 8 seqs
      info for 426 / 426 = 1.000   (removed: 0 failed)
      kept 87 (0.204) unproductive
    water time: 0.5  (ig-sw 0.1  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 426 / 426 v annotations (0 failed) with 10 v genes in 0.1 sec
    running 10 procs for 426 seqs
    running 11 procs for 8 seqs
      info for 426 / 426 = 1.000   (removed: 0 failed)
      kept 87 (0.204) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igl/sw (0.9 sec)
    water time: 1.6  (ig-sw 1.2  processing 0.1)
  writing hmms (0.2 sec)
hmm
    running 10 procs
                    calcd:         vtb 426        fwd   0
             min-max time:  0.5 - 0.5 sec
    reading output
        read 426 hmm output lines with 424 sequences in 424 events  (2 failures)
          [91mwarning[0m no valid paths: 9184504695515260329-igl 2885609380885640393-igl
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igl/hmm (0.6 sec)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igl/true (0.7 sec)
         infra time: 2.3
      hmm step time: 2.9
  writing hmms (0.1 sec)
      total time: 6.2
      total time: 34.3
[92mpartition-new-simu[0m               /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results-slow/test/simu --parameter-dir test/paired/new-results-slow/test/parameters/simu --plot-annotation-performance --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/partition-new-simu
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --plot-annotation-performance --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance/single-chain/plots/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/test/simu/igh.yaml --outfname test/paired/new-results-slow/partition-new-simu/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 1173 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 1173 / 1173 v annotations (0 failed) with 23 v genes in 0.3 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 1173 / 1173 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 404 (0.344) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 51 queries with different true and inferred net shm indel lengths: 2140354615523209257-igh 3171790528442837239-igh 3785190254138251079-igh 0015836289824885101-igh 3344153475914336323-igh 1202949175819197746-igh 8034210568695520943-igh 5235663855169387750-igh 6700386955102474268-igh 8885014819426259245-igh 5378888161691847675-igh 2439049957655876274-igh 8585266049145533130-igh 4975135389751441864-igh 7788445019675643258-igh 5053390551094301741-igh 8979836157019047937-igh 1965327953427248067-igh 8659717766248920473-igh 7649652184084697594-igh 3767014294834279604-igh 1612791893288905975-igh 2420921955538524671-igh 7775775703694324620-igh 4440160995040218810-igh 4755071984689497058-igh 2435308346487042358-igh 4080921475674879727-igh 3332812478823208550-igh 6247378278939507338-igh 5584256691029793091-igh 0849823490602332668-igh 3645864798637182476-igh 2266557530034175766-igh 2877666911830896838-igh 5986985051134645429-igh 0497142986593355855-igh 3280466687811356157-igh 2941879260630713450-igh 7532600282966856898-igh 2148751831878089429-igh 4847540134030695462-igh 7452022174808169370-igh 3388849225779556607-igh 2316884101960894369-igh 2260506213630771760-igh 5479979364695988617-igh 1346405104640335780-igh 2443114284239806005-igh 2387080066609923455-igh 7117584031579204251-igh
(0.0 sec)
        water time: 1.3
hmm
caching all 1173 naive sequences
        hmm prep time: 0.1
    running 10 procs
                no/empty cache file
                    calcd:         vtb 1173        fwd    0
                   merged:       hfrac    0     lratio    0
             min-max time:  1.6 - 1.8 sec
         infra time: 0.1
      hmm step time: 2.0
   collapsed 1173 queries into 523 clusters with identical naive seqs (0.0 sec)
523 clusters with 10 procs
        hmm prep time: 0.1
       setting naive hfrac bounds: 0.015 0.064
    running 10 procs
          read from cache:  naive-seqs 1173   logprobs    0
                    calcd:         vtb  263        fwd  516
                   merged:       hfrac   66     lratio   51
             min-max time:  1.1 - 2.2 sec
         infra time: 0.4
      hmm step time: 2.6
406 clusters with 7 procs
        hmm prep time: 0.1
       naive hfrac bounds: 0.015 0.064
    running 7 procs
          read from cache:  naive-seqs 1436   logprobs  516
                    calcd:         vtb   73        fwd  257
                   merged:       hfrac   36     lratio   28
             min-max time:  1.0 - 1.5 sec
         infra time: 0.3
      hmm step time: 1.9
342 clusters with 5 procs
        hmm prep time: 0.1
       naive hfrac bounds: 0.015 0.064
    running 5 procs
          read from cache:  naive-seqs 1513   logprobs  773
                    calcd:         vtb   42        fwd  206
                   merged:       hfrac   23     lratio   18
             min-max time:  0.9 - 2.2 sec
         infra time: 0.3
      hmm step time: 2.5
301 clusters with 3 procs
       naive hfrac bounds: 0.015 0.064
    running 3 procs
          read from cache:  naive-seqs 1555   logprobs  979
                    calcd:         vtb   34        fwd  164
                   merged:       hfrac   17     lratio   17
             min-max time:  1.8 - 2.5 sec
         infra time: 0.2
      hmm step time: 2.8
267 clusters with 2 procs
       naive hfrac bounds: 0.015 0.064
    running 2 procs
          read from cache:  naive-seqs 1591   logprobs 1143
                    calcd:         vtb   30        fwd  173
                   merged:       hfrac   28     lratio    9
             min-max time:  3.6 - 3.7 sec
         infra time: 0.2
      hmm step time: 3.9
230 clusters with 2 procs
       naive hfrac bounds: 0.015 0.064
    running 2 procs
          read from cache:  naive-seqs 1631   logprobs 1316
                    calcd:         vtb    8        fwd   98
                   merged:       hfrac    5     lratio    3
             min-max time:  1.6 - 2.6 sec
         infra time: 0.2
      hmm step time: 2.8
222 clusters with 2 procs
       naive hfrac bounds: 0.015 0.064
    running 2 procs
          read from cache:  naive-seqs 1639   logprobs 1414
                    calcd:         vtb    2        fwd   36
                   merged:       hfrac    2     lratio    1
             min-max time:  0.8 - 0.9 sec
         infra time: 0.2
      hmm step time: 1.1
219 clusters with 1 proc
        hmm prep time: 0.1
       naive hfrac bounds: 0.015 0.064
    running 1 proc
          read from cache:  naive-seqs 1642   logprobs 1450
                    calcd:         vtb    9        fwd  129
                   merged:       hfrac    4     lratio    6
                     time:  5.1 sec
         infra time: 0.1
      hmm step time: 5.3
  [93mnote[0m not merging entire cpath history
      loop time: 23.0
getting annotations for final partition
  subcluster annotating 209 clusters: 
    running 10 procs
                    calcd:         vtb  482        fwd    0
             min-max time:  1.2 - 1.5 sec
    reading output
        read 482 hmm output lines with 1173 sequences in 482 events  (0 failures)
         infra time: 0.6
      hmm step time: 2.1
    read 482 new subcluster annotations: added hashid 376   whole finished 106   subcl finished 0
    running 10 procs
                    calcd:         vtb  157        fwd    0
             min-max time:  0.6 - 0.8 sec
    reading output
        read 157 hmm output lines with 376 sequences in 157 events  (0 failures)
         infra time: 0.1
      hmm step time: 1.0
    read 157 new subcluster annotations: added hashid 157   whole finished 0   subcl finished 68
    running 10 procs
                    calcd:         vtb   40        fwd    0
             min-max time:  0.3 - 0.4 sec
    reading output
        read 40 hmm output lines with 89 sequences in 40 events  (0 failures)
      hmm step time: 0.5
    read 40 new subcluster annotations: added hashid 40   whole finished 0   subcl finished 31
    running 10 procs
                    calcd:         vtb    4        fwd    0
             min-max time:  0.0 - 0.2 sec
    reading output
        read 4 hmm output lines with 9 sequences in 4 events  (0 failures)
      hmm step time: 0.2
    read 4 new subcluster annotations: added hashid 4   whole finished 0   subcl finished 4
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 51 queries with different true and inferred net shm indel lengths: 2941879260630713450-igh 4080921475674879727-igh 3332812478823208550-igh 4847540134030695462-igh 2266557530034175766-igh 7788445019675643258-igh 1346405104640335780-igh 2443114284239806005-igh 0015836289824885101-igh 0497142986593355855-igh 0849823490602332668-igh 1202949175819197746-igh 1612791893288905975-igh 1965327953427248067-igh 2140354615523209257-igh 2148751831878089429-igh 2260506213630771760-igh 2316884101960894369-igh 2387080066609923455-igh 2420921955538524671-igh 2435308346487042358-igh 2439049957655876274-igh 2877666911830896838-igh 3171790528442837239-igh 3280466687811356157-igh 3344153475914336323-igh 3388849225779556607-igh 3645864798637182476-igh 3767014294834279604-igh 3785190254138251079-igh 4440160995040218810-igh 4755071984689497058-igh 4975135389751441864-igh 5053390551094301741-igh 5235663855169387750-igh 5378888161691847675-igh 5479979364695988617-igh 5584256691029793091-igh 5986985051134645429-igh 6247378278939507338-igh 6700386955102474268-igh 7117584031579204251-igh 7452022174808169370-igh 7532600282966856898-igh 7649652184084697594-igh 7775775703694324620-igh 8034210568695520943-igh 8585266049145533130-igh 8659717766248920473-igh 8885014819426259245-igh 8979836157019047937-igh
(0.0 sec)
    subcluster annotation time 5.4
      total time: 34.3
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --plot-annotation-performance --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance/single-chain/plots/igk --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/test/simu/igk.yaml --outfname test/paired/new-results-slow/partition-new-simu/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 747 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 747 / 747 v annotations (0 failed) with 16 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 747 / 747 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 128 (0.171) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 25 queries with different true and inferred net shm indel lengths: 2298849017709047818-igk 6750634952083250793-igk 2140354615523209257-igk 0453527383582346698-igk 5102947983641542765-igk 5283461845556754502-igk 4574533765885627683-igk 3221527424755463888-igk 1210106711452753391-igk 1527921157505142410-igk 5651364399944836797-igk 8659717766248920473-igk 9150281456799978475-igk 6635582983730239307-igk 8337037179533229479-igk 6660828827565806213-igk 4811714831919858879-igk 8907264058145743749-igk 1328947066753118300-igk 4115430168387192626-igk 2659599773997899895-igk 5226258324289837295-igk 9107518269688451368-igk 1521946818831550493-igk 4982506404613807225-igk
(0.0 sec)
        water time: 0.9
hmm
caching all 747 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 747        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  0.7 - 0.8 sec
      hmm step time: 1.0
   collapsed 747 queries into 60 clusters with identical naive seqs (0.0 sec)
60 clusters with 10 procs
       setting naive hfrac bounds: 0.015 0.060
    running 10 procs
          read from cache:  naive-seqs 747   logprobs   0
                    calcd:         vtb  33        fwd   6
                   merged:       hfrac   1     lratio   0
             min-max time:  0.1 - 0.2 sec
         infra time: 0.2
      hmm step time: 0.5
59 clusters with 7 procs
       naive hfrac bounds: 0.015 0.060
    running 7 procs
          read from cache:  naive-seqs 789   logprobs   6
                    calcd:         vtb   7        fwd   6
                   merged:       hfrac   2     lratio   0
             min-max time:  0.0 - 0.1 sec
         infra time: 0.2
      hmm step time: 0.4
57 clusters with 5 procs
       naive hfrac bounds: 0.015 0.060
    running 5 procs
          read from cache:  naive-seqs 797   logprobs  12
                    calcd:         vtb   5        fwd   3
                   merged:       hfrac   0     lratio   0
             min-max time:  0.1 - 0.1 sec
         infra time: 0.1
      hmm step time: 0.3
57 clusters with 3 procs
       naive hfrac bounds: 0.015 0.060
    running 3 procs
          read from cache:  naive-seqs 804   logprobs  15
                    calcd:         vtb   4        fwd   1
                   merged:       hfrac   4     lratio   0
             min-max time:  0.1 - 0.1 sec
         infra time: 0.1
      hmm step time: 0.3
53 clusters with 2 procs
       naive hfrac bounds: 0.015 0.060
    running 2 procs
          read from cache:  naive-seqs 810   logprobs  16
                    calcd:         vtb   2        fwd   4
                   merged:       hfrac   2     lratio   0
             min-max time:  0.1 - 0.2 sec
         infra time: 0.1
      hmm step time: 0.4
51 clusters with 1 proc
       naive hfrac bounds: 0.015 0.060
    running 1 proc
          read from cache:  naive-seqs 813   logprobs  20
                    calcd:         vtb   3        fwd  50
                   merged:       hfrac   4     lratio   0
                     time:  0.9 sec
      hmm step time: 1.0
  [93mnote[0m not merging entire cpath history
      loop time: 2.9
getting annotations for final partition
  subcluster annotating 48 clusters: 
    running 10 procs
                    calcd:         vtb 270        fwd   0
             min-max time:  0.6 - 0.7 sec
    reading output
        read 270 hmm output lines with 747 sequences in 270 events  (0 failures)
         infra time: 0.8
      hmm step time: 1.5
    read 270 new subcluster annotations: added hashid 255   whole finished 15   subcl finished 0
    running 10 procs
                    calcd:         vtb   96        fwd    0
             min-max time:  0.3 - 0.4 sec
    reading output
        read 96 hmm output lines with 255 sequences in 96 events  (0 failures)
         infra time: 0.1
      hmm step time: 0.6
    read 96 new subcluster annotations: added hashid 96   whole finished 0   subcl finished 6
    running 10 procs
                    calcd:         vtb   36        fwd    0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 36 hmm output lines with 90 sequences in 36 events  (0 failures)
      hmm step time: 0.3
    read 36 new subcluster annotations: added hashid 36   whole finished 0   subcl finished 20
    running 10 procs
                    calcd:         vtb    8        fwd    0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 8 hmm output lines with 16 sequences in 8 events  (0 failures)
      hmm step time: 0.2
    read 8 new subcluster annotations: added hashid 8   whole finished 0   subcl finished 6
    running 10 procs
                    calcd:         vtb    1        fwd    0
             min-max time:  0.0 - 0.0 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 25 queries with different true and inferred net shm indel lengths: 1210106711452753391-igk 2140354615523209257-igk 6750634952083250793-igk 2298849017709047818-igk 4982506404613807225-igk 2659599773997899895-igk 0453527383582346698-igk 1527921157505142410-igk 4811714831919858879-igk 6635582983730239307-igk 4574533765885627683-igk 1328947066753118300-igk 1521946818831550493-igk 3221527424755463888-igk 4115430168387192626-igk 5102947983641542765-igk 5226258324289837295-igk 5283461845556754502-igk 5651364399944836797-igk 6660828827565806213-igk 8337037179533229479-igk 8659717766248920473-igk 8907264058145743749-igk 9107518269688451368-igk 9150281456799978475-igk
(0.0 sec)
    subcluster annotation time 3.6
      total time: 9.9
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --plot-annotation-performance --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance/single-chain/plots/igl --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/test/simu/igl.yaml --outfname test/paired/new-results-slow/partition-new-simu/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 426 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 426 / 426 v annotations (0 failed) with 10 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
      info for 426 / 426 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 87 (0.204) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 13 queries with different true and inferred net shm indel lengths: 8811699128935131392-igl 2243686301040758968-igl 5895050847834969305-igl 5183092064312725602-igl 2613843819161832654-igl 2885609380885640393-igl 7410197645865402313-igl 6475678262750260136-igl 7671550897726070243-igl 9184504695515260329-igl 1684827879342020250-igl 7698768102636357101-igl 8538818755890410112-igl
(0.0 sec)
        water time: 0.6
hmm
caching all 426 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 426        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  0.5 - 0.5 sec
      hmm step time: 0.7
    [93mwarning:[0m missing 2 queries from hmm cache file (using sw naive sequence instead): 9184504695515260329-igl 2885609380885640393-igl
   collapsed 426 queries into 34 clusters with identical naive seqs (0.0 sec)
34 clusters with 10 procs
       setting naive hfrac bounds: 0.015 0.062
    running 10 procs
          read from cache:  naive-seqs 424   logprobs   0
                    calcd:         vtb   7        fwd   0
                   merged:       hfrac   1     lratio   0
             min-max time:  0.0 - 0.1 sec
         infra time: 0.2
      hmm step time: 0.3
33 clusters with 7 procs
       naive hfrac bounds: 0.015 0.062
    running 7 procs
          read from cache:  naive-seqs 432   logprobs   0
                    calcd:         vtb  11        fwd   0
                   merged:       hfrac   3     lratio   0
             min-max time:  0.0 - 0.1 sec
         infra time: 0.1
      hmm step time: 0.3
30 clusters with 5 procs
       naive hfrac bounds: 0.015 0.062
    running 5 procs
          read from cache:  naive-seqs 450   logprobs   0
                    calcd:         vtb   4        fwd   3
                   merged:       hfrac   2     lratio   0
             min-max time:  0.0 - 0.1 sec
         infra time: 0.1
      hmm step time: 0.3
28 clusters with 3 procs
       naive hfrac bounds: 0.015 0.062
    running 3 procs
          read from cache:  naive-seqs 456   logprobs   3
                    calcd:         vtb   1        fwd   0
                   merged:       hfrac   1     lratio   0
             min-max time:  0.0 - 0.1 sec
         infra time: 0.1
      hmm step time: 0.2
27 clusters with 2 procs
       naive hfrac bounds: 0.015 0.062
    running 2 procs
          read from cache:  naive-seqs 457   logprobs   3
                    calcd:         vtb   6        fwd   0
                   merged:       hfrac   5     lratio   0
             min-max time:  0.1 - 0.1 sec
         infra time: 0.1
      hmm step time: 0.3
22 clusters with 1 proc
       naive hfrac bounds: 0.015 0.062
    running 1 proc
          read from cache:  naive-seqs 466   logprobs   3
                    calcd:         vtb   0        fwd  24
                   merged:       hfrac   3     lratio   0
                     time:  0.6 sec
      hmm step time: 0.7
  [93mnote[0m not merging entire cpath history
      loop time: 2.2
getting annotations for final partition
  subcluster annotating 19 clusters: 
    running 10 procs
                    calcd:         vtb 151        fwd   0
             min-max time:  0.4 - 0.4 sec
    reading output
        read 151 hmm output lines with 424 sequences in 149 events  (2 failures)
          [91mwarning[0m no valid paths: 9184504695515260329-igl 2885609380885640393-igl
         infra time: 0.4
      hmm step time: 0.9
    missing 2 annotations
      removing failed cluster for 2885609380885640393-igl:
      removing failed cluster for 9184504695515260329-igl:
    read 149 new subcluster annotations: added hashid 142   whole finished 7   subcl finished 0
    running 10 procs
                    calcd:         vtb  51        fwd   0
             min-max time:  0.2 - 0.2 sec
    reading output
        read 51 hmm output lines with 142 sequences in 51 events  (0 failures)
         infra time: 0.1
      hmm step time: 0.4
    read 51 new subcluster annotations: added hashid 51   whole finished 0   subcl finished 1
    running 10 procs
                    calcd:         vtb  19        fwd   0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 19 hmm output lines with 50 sequences in 19 events  (0 failures)
      hmm step time: 0.2
    read 19 new subcluster annotations: added hashid 19   whole finished 0   subcl finished 3
    running 10 procs
                    calcd:         vtb   7        fwd   0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 7 hmm output lines with 16 sequences in 7 events  (0 failures)
      hmm step time: 0.2
    read 7 new subcluster annotations: added hashid 7   whole finished 0   subcl finished 5
    running 10 procs
                    calcd:         vtb   1        fwd   0
             min-max time:  0.0 - 0.0 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 11 queries with different true and inferred net shm indel lengths: 7410197645865402313-igl 8811699128935131392-igl 7698768102636357101-igl 7671550897726070243-igl 2243686301040758968-igl 1684827879342020250-igl 2613843819161832654-igl 5183092064312725602-igl 5895050847834969305-igl 6475678262750260136-igl 8538818755890410112-igl
(0.0 sec)
    subcluster annotation time 2.4
      total time: 6.7
      removed 2 failed queries when reading partition: 9184504695515260329-igl 2885609380885640393-igl
   2/2344 missing uids when cleaning pair info
    truncating x bins 3 --> 12 and ybins 2 --> 12
    truncating x bins 4 --> 15 and ybins 4 --> 15
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
  intersection and complement both ok
   N clusters without bad/unpaired seqs:
        [94mh[0m  141 --> 178  [91m+37[0m
        [95mk[0m   48 --> 178  [91m+130[0m
    re-added unpaired seqs ([94mh[0m 2, [95mk[0m 0) to give total seqs in joint partitions: [94mh[0m 749  [95mk[0m 747
  [94mh[0m ccfs:     purity  completeness
      single   0.831  0.891
       joint   0.990  0.894
  [95mk[0m ccfs:     purity  completeness
      single   0.377  0.970
       joint   0.990  0.893
  merge time 0.1
  need to get annotations for 122/180 joint igh clusters
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igh.yaml --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 749 sequences from test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igh.yaml: paired-uids loci
  --input-partition-fname: read best partition with 749 sequences in 180 clusters from test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 749 / 749 v annotations (0 failed) with 23 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 749 / 749 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 250 (0.334) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for '9184504695515260329-igh': [[u'9184504695515260329-igl']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for '2885609380885640393-igh': [[u'2885609380885640393-igl']] --> [[]]
[93mwarning[0m replaced input metafo for 2 instances of keys paired-uids (see above, only printed the first 10)
        water time: 0.4
hmm
  subcluster annotating 180 clusters: 
    running 10 procs
                    calcd:         vtb 332        fwd   0
             min-max time:  0.9 - 1.1 sec
    reading output
        read 332 hmm output lines with 749 sequences in 332 events  (0 failures)
         infra time: 0.4
      hmm step time: 1.5
    read 332 new subcluster annotations: added hashid 230   whole finished 102   subcl finished 0
    running 10 procs
                    calcd:         vtb 102        fwd   0
             min-max time:  0.4 - 0.6 sec
    reading output
        read 102 hmm output lines with 230 sequences in 102 events  (0 failures)
         infra time: 0.1
      hmm step time: 0.8
    read 102 new subcluster annotations: added hashid 102   whole finished 0   subcl finished 58
    running 10 procs
                    calcd:         vtb   21        fwd    0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 21 hmm output lines with 44 sequences in 21 events  (0 failures)
      hmm step time: 0.3
    read 21 new subcluster annotations: added hashid 21   whole finished 0   subcl finished 19
    running 10 procs
                    calcd:         vtb    1        fwd    0
             min-max time:  0.0 - 0.2 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.2
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 3.1
      total time: 3.8
  need to get annotations for 164/178 joint igk clusters
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igk.yaml --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
  --input-metafnames: added meta info for 747 sequences from test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igk.yaml: paired-uids loci
  --input-partition-fname: read best partition with 747 sequences in 178 clusters from test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 747 / 747 v annotations (0 failed) with 16 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 747 / 747 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 128 (0.171) unproductive
        water time: 0.3
hmm
  [93mwarning[0m split apart 1 cluster that contained multiple cdr3 lengths (total clusters: 178 --> 179)
      cluster splits:   5 --> 4 1
  subcluster annotating 179 clusters: 
    running 10 procs
                    calcd:         vtb 331        fwd   0
             min-max time:  0.5 - 0.7 sec
    reading output
        read 331 hmm output lines with 747 sequences in 331 events  (0 failures)
         infra time: 0.8
      hmm step time: 1.6
    read 331 new subcluster annotations: added hashid 230   whole finished 101   subcl finished 0
    running 10 procs
                    calcd:         vtb 102        fwd   0
             min-max time:  0.2 - 0.4 sec
    reading output
        read 102 hmm output lines with 230 sequences in 102 events  (0 failures)
         infra time: 0.1
      hmm step time: 0.6
    read 102 new subcluster annotations: added hashid 102   whole finished 0   subcl finished 58
    running 10 procs
                    calcd:         vtb   21        fwd    0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 21 hmm output lines with 44 sequences in 21 events  (0 failures)
      hmm step time: 0.2
    read 21 new subcluster annotations: added hashid 21   whole finished 0   subcl finished 19
    running 10 procs
                    calcd:         vtb    1        fwd    0
             min-max time:  0.0 - 0.0 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 2.7
      total time: 3.3
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
  intersection and complement both ok
   N clusters without bad/unpaired seqs:
        [94mh[0m   83 --> 93   [91m+10[0m
        [92ml[0m   17 --> 93   [91m+76[0m
    re-added unpaired seqs ([94mh[0m 2, [92ml[0m 0) to give total seqs in joint partitions: [94mh[0m 426  [92ml[0m 424
  [94mh[0m ccfs:     purity  completeness
      single   0.831  0.891
       joint   0.995  0.837
  [92ml[0m ccfs:     purity  completeness
      single   0.294  0.976
       joint   0.994  0.837
  merge time 0.1
  need to get annotations for 62/93 joint igh clusters
[44mannotate[0m [94migh+igl[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igl/input-seqs-igh.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igh.yaml --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 426 sequences from test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igh.yaml: paired-uids loci
  --input-partition-fname: read best partition with 426 sequences in 93 clusters from test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 426 / 426 v annotations (0 failed) with 20 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 426 / 426 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 154 (0.362) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for '9184504695515260329-igh': [[u'9184504695515260329-igl']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for '2885609380885640393-igh': [[u'2885609380885640393-igl']] --> [[]]
[93mwarning[0m replaced input metafo for 2 instances of keys paired-uids (see above, only printed the first 10)
        water time: 0.2
hmm
  subcluster annotating 93 clusters: 
    running 10 procs
                    calcd:         vtb 184        fwd   0
             min-max time:  0.6 - 0.8 sec
    reading output
        read 184 hmm output lines with 426 sequences in 184 events  (0 failures)
         infra time: 0.2
      hmm step time: 1.1
    read 184 new subcluster annotations: added hashid 130   whole finished 54   subcl finished 0
    running 10 procs
                    calcd:         vtb  54        fwd   0
             min-max time:  0.3 - 0.4 sec
    reading output
        read 54 hmm output lines with 130 sequences in 54 events  (0 failures)
      hmm step time: 0.6
    read 54 new subcluster annotations: added hashid 54   whole finished 0   subcl finished 27
    running 10 procs
                    calcd:         vtb  13        fwd   0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 13 hmm output lines with 27 sequences in 13 events  (0 failures)
      hmm step time: 0.3
    read 13 new subcluster annotations: added hashid 13   whole finished 0   subcl finished 11
    running 10 procs
                    calcd:         vtb   1        fwd   0
             min-max time:  0.0 - 0.2 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.2
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 2.3
      total time: 2.8
  need to get annotations for 87/93 joint igl clusters
[44mannotate[0m [94migh+igl[0m:[94m igl[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igl/input-seqs-igl.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igl.yaml --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
  --input-metafnames: added meta info for 424 sequences from test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igl.yaml: paired-uids loci
  --input-partition-fname: read best partition with 424 sequences in 93 clusters from test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 424 / 424 v annotations (0 failed) with 10 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
      info for 424 / 424 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 85 (0.200) unproductive
        water time: 0.2
hmm
  [93mwarning[0m split apart 1 cluster that contained multiple cdr3 lengths (total clusters: 93 --> 94)
      cluster splits:   2 --> 1 1
  subcluster annotating 94 clusters: 
    running 10 procs
                    calcd:         vtb 185        fwd   0
             min-max time:  0.3 - 0.5 sec
    reading output
        read 185 hmm output lines with 424 sequences in 185 events  (0 failures)
         infra time: 0.4
      hmm step time: 0.9
    read 185 new subcluster annotations: added hashid 130   whole finished 55   subcl finished 0
    running 10 procs
                    calcd:         vtb  54        fwd   0
             min-max time:  0.1 - 0.3 sec
    reading output
        read 54 hmm output lines with 130 sequences in 54 events  (0 failures)
      hmm step time: 0.4
    read 54 new subcluster annotations: added hashid 54   whole finished 0   subcl finished 27
    running 10 procs
                    calcd:         vtb  13        fwd   0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 13 hmm output lines with 27 sequences in 13 events  (0 failures)
      hmm step time: 0.2
    read 13 new subcluster annotations: added hashid 13   whole finished 0   subcl finished 11
    running 10 procs
                    calcd:         vtb   1        fwd   0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 1.7
      total time: 2.1
[91mrun[0m cd test/paired/new-results-slow/partition-new-simu && ln -sf igh+igk/partition-igk.yaml partition-igk.yaml
[91mrun[0m cd test/paired/new-results-slow/partition-new-simu && ln -sf igh+igl/partition-igl.yaml partition-igl.yaml
   N clusters with all seqs:
        [94mh[0m  209 --> 273  [91m+64[0m
        [95mk[0m   48 --> 178  [91m+130[0m
        [92ml[0m   17 --> 93   [91m+76[0m
  added 0 (of 1173) ids from single partition that were missing from joint partition ()
    [94mh[0m single vs joint concat'd correct cluster fractions:
       clusters uids
         273    1173  joint
         209    1173  single
      purity:       953.1 / 1173 = 0.813
      completeness: 1165.8 / 1173 = 0.994
  added 0 (of 747) ids from single partition that were missing from joint partition ()
    [95mk[0m single vs joint concat'd correct cluster fractions:
       clusters uids
         178    747  joint
          48    747  single
      purity:       260.6 / 747 = 0.349
      completeness: 744.2 / 747 = 0.996
  added 0 (of 424) ids from single partition that were missing from joint partition ()
    [92ml[0m single vs joint concat'd correct cluster fractions:
       clusters uids
          93    424  joint
          17    424  single
      purity:       95.8 / 424 = 0.226
      completeness: 423.0 / 424 = 0.998
  [93mwarning[0m ignoring --plot-annotation-performance for paired clustering since it's going to be a bit fiddly to implement
      total time: 68.6
[92mseed-partition-new-simu[0m          /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results-slow/test/simu --parameter-dir test/paired/new-results-slow/test/parameters/simu --is-simu --seed-unique-id 2298849017709047818-igh:2298849017709047818-igk --seed-loci igh:igk --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/seed-partition-new-simu
   removing seqs very different from seed seq
                           wrong/no     removed      singly         kept   missing
           locus  before   pairing    cdr3  hfrac    added   after  frac   true ids
             [94mh[0m     1173      426       682    46        0      19   0.016    [91m1[0m
             [95mk[0m      747        0       682    46        0      19   0.025    [91m1[0m
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/single-chain/input-seqs-igh.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 19 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 19 / 19 v annotations (0 failed) with 1 v gene in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 19 / 19 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 2 (0.105) unproductive
        water time: 0.1
hmm
caching all 19 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 19        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.1 - 0.1 sec
      hmm step time: 0.2
   collapsed 19 queries into 1 cluster with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 1
1 clusters with 1 proc
       setting naive hfrac bounds: 0.015 0.064
    running 1 proc
          read from cache:  naive-seqs 19   logprobs  0
                    calcd:         vtb  0        fwd  1
                   merged:       hfrac  0     lratio  0
                     time:  0.1 sec
      hmm step time: 0.1
      loop time: 0.1
getting annotations for final partition
  subcluster annotating 1 cluster: 
    running 1 proc
                    calcd:         vtb  7        fwd  0
                     time:  0.1 sec
    reading output
        read 7 hmm output lines with 19 sequences in 7 events  (0 failures)
      hmm step time: 0.1
    read 7 new subcluster annotations: added hashid 7   whole finished 0   subcl finished 0
    running 1 proc
                    calcd:         vtb  3        fwd  0
                     time:  0.1 sec
    reading output
        read 3 hmm output lines with 7 sequences in 3 events  (0 failures)
      hmm step time: 0.1
    read 3 new subcluster annotations: added hashid 3   whole finished 0   subcl finished 0
    running 1 proc
                    calcd:         vtb  1        fwd  0
                     time:  0.1 sec
    reading output
        read 1 hmm output lines with 3 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.4
      total time: 0.9
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/single-chain/input-seqs-igk.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 19 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 19 / 19 v annotations (0 failed) with 1 v gene in 0.0 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 19 / 19 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 7 (0.368) unproductive
        water time: 0.1
hmm
caching all 19 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 19        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
   collapsed 19 queries into 1 cluster with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 1
1 clusters with 1 proc
       setting naive hfrac bounds: 0.015 0.060
    running 1 proc
          read from cache:  naive-seqs 19   logprobs  0
                    calcd:         vtb  0        fwd  1
                   merged:       hfrac  0     lratio  0
                     time:  0.1 sec
      hmm step time: 0.1
      loop time: 0.1
getting annotations for final partition
  subcluster annotating 1 cluster: 
    running 1 proc
                    calcd:         vtb  7        fwd  0
                     time:  0.1 sec
    reading output
        read 7 hmm output lines with 19 sequences in 7 events  (0 failures)
      hmm step time: 0.1
    read 7 new subcluster annotations: added hashid 7   whole finished 0   subcl finished 0
    running 1 proc
                    calcd:         vtb  3        fwd  0
                     time:  0.0 sec
    reading output
        read 3 hmm output lines with 7 sequences in 3 events  (0 failures)
      hmm step time: 0.1
    read 3 new subcluster annotations: added hashid 3   whole finished 0   subcl finished 0
    running 1 proc
                    calcd:         vtb  1        fwd  0
                     time:  0.1 sec
    reading output
        read 1 hmm output lines with 3 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.3
      total time: 0.7
[94migl[0m: input file missing, skipping partition (test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/single-chain/input-seqs-igl.fa)
    [93mwarning[0m zero length annotation list in check_concordance_of_cpath_and_annotations()
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
  intersection and complement both ok
   N clusters without bad/unpaired seqs:
        [94mh[0m    1 --> 1   
        [95mk[0m    1 --> 1   
    re-added unpaired seqs ([94mh[0m 0, [95mk[0m 0) to give total seqs in joint partitions: [94mh[0m 19  [95mk[0m 19
  [94mh[0m ccfs:     purity  completeness
      single   1.000  1.000
       joint   1.000  1.000
  [95mk[0m ccfs:     purity  completeness
      single   1.000  1.000
       joint   1.000  1.000
  merge time 0.0
     removed 0 unseeded clusters (of 1 total, leaving 1) from igh joint partition
  need to get annotations for 1/1 joint igh clusters
  seed cluster size in best joint partition: 19, excluding seed seq: 18
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id 2298849017709047818-igh:2298849017709047818-igk
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/igh+igk/meta-igh.yaml --input-partition-fname test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/igh+igk/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 19 sequences from test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/igh+igk/meta-igh.yaml: paired-uids loci
  --input-partition-fname: read best partition with 19 sequences in 1 clusters from test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 19 / 19 v annotations (0 failed) with 1 v gene in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 19 / 19 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 2 (0.105) unproductive
        water time: 0.1
hmm
  subcluster annotating 1 cluster: 
    running 10 procs
                    calcd:         vtb  7        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 7 hmm output lines with 19 sequences in 7 events  (0 failures)
      hmm step time: 0.2
    read 7 new subcluster annotations: added hashid 7   whole finished 0   subcl finished 0
    running 10 procs
                    calcd:         vtb  3        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 3 hmm output lines with 7 sequences in 3 events  (0 failures)
      hmm step time: 0.1
    read 3 new subcluster annotations: added hashid 3   whole finished 0   subcl finished 0
    running 10 procs
                    calcd:         vtb  1        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 1 hmm output lines with 3 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.4
      total time: 0.6
     removed 0 unseeded clusters (of 1 total, leaving 1) from igk joint partition
  need to get annotations for 1/1 joint igk clusters
  seed cluster size in best joint partition: 19, excluding seed seq: 18
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id 2298849017709047818-igh:2298849017709047818-igk
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/igh+igk/meta-igk.yaml --input-partition-fname test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/igh+igk/partition-igk-only-partition.yaml
  --input-metafnames: added meta info for 19 sequences from test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/igh+igk/meta-igk.yaml: paired-uids loci
  --input-partition-fname: read best partition with 19 sequences in 1 clusters from test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 19 / 19 v annotations (0 failed) with 1 v gene in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 19 / 19 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 7 (0.368) unproductive
        water time: 0.1
hmm
  subcluster annotating 1 cluster: 
    running 10 procs
                    calcd:         vtb  7        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 7 hmm output lines with 19 sequences in 7 events  (0 failures)
      hmm step time: 0.2
    read 7 new subcluster annotations: added hashid 7   whole finished 0   subcl finished 0
    running 10 procs
                    calcd:         vtb  3        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 3 hmm output lines with 7 sequences in 3 events  (0 failures)
      hmm step time: 0.1
    read 3 new subcluster annotations: added hashid 3   whole finished 0   subcl finished 0
    running 10 procs
                    calcd:         vtb  1        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 1 hmm output lines with 3 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.4
      total time: 0.5
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    no single chain output
[91mrun[0m cd test/paired/new-results-slow/seed-partition-new-simu/seeds/2298849017709047818-igh+2298849017709047818-igk && ln -sf igh+igk/partition-igk.yaml partition-igk.yaml
   N clusters with all seqs:
        [94mh[0m    1 --> 1   
        [95mk[0m    1 --> 1   
  added 0 (of 19) ids from single partition that were missing from joint partition ()
    [94mh[0m single vs joint concat'd correct cluster fractions:
       clusters uids
           1     19  joint
           1     19  single
      purity:       19.0 / 19 = 1.000
      completeness: 19.0 / 19 = 1.000
  added 0 (of 19) ids from single partition that were missing from joint partition ()
    [95mk[0m single vs joint concat'd correct cluster fractions:
       clusters uids
           1     19  joint
           1     19  single
      purity:       19.0 / 19 = 1.000
      completeness: 19.0 / 19 = 1.000
      total time: 5.2
[92mget-selection-metrics-new-simu[0m   /home/dralph/work/partis/bin/partis get-selection-metrics --dont-write-git-info --paired-loci --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/partition-new-simu --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    calculating selection metrics for 20 clusters with sizes: 36 19 19 17 15 15 15 14 13 13 12 12 12 12 11 11 11 10 10 10
      skipping 160 smaller than 10
    inf tree: calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 1 = 0.0025 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 63/67 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
    (AA inf tree, iclust 0): calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 1 = 0.0025 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 4): skipped 25/27 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 5): skipped 27/28 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 7): skipped 23/25 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 8): skipped 7/16 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 10): skipped 8/15 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 18): skipped 8/13 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 19): skipped 11/15 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      tree origins: 20 made from cpath
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh-selection-metrics.yaml
      total time: 2.0
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igk --dont-write-git-info --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    calculating selection metrics for 20 clusters with sizes: 36 19 19 17 15 15 15 14 13 13 12 12 12 12 11 11 11 10 10 10
      skipping 159 smaller than 10
    inf tree: calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 1 = 0.0025 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 2/37 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
    (AA inf tree, iclust 0): calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 1 = 0.0025 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 3/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 4): skipped 10/19 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 8): skipped 2/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 9): skipped 2/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 10): skipped 6/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 11): skipped 2/13 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 12): skipped 2/13 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 13): skipped 9/15 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 19): skipped 3/11 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      tree origins: 20 made from cpath
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk-selection-metrics.yaml
      total time: 1.3
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    calculating selection metrics for 12 clusters with sizes: 28 22 18 18 16 16 14 12 12 11 11 10
      skipping 81 smaller than 10
    inf tree: calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 1 = 0.0025 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 32/42 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
    (AA inf tree, iclust 0): calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 1 = 0.0025 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 34/37 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 27/31 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 3): skipped 33/34 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 4): skipped 27/29 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 7): skipped 19/21 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      tree origins: 12 made from cpath
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh-selection-metrics.yaml
      total time: 1.6
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igl --dont-write-git-info --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    calculating selection metrics for 12 clusters with sizes: 28 22 18 18 16 16 14 12 11 11 11 10
      skipping 82 smaller than 10
    inf tree: calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 1 = 0.0025 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 38/46 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
    (AA inf tree, iclust 0): calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 1 = 0.0025 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 3): skipped 8/21 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 4): skipped 18/23 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 6): skipped 19/23 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 7): skipped 13/18 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 8): skipped 19/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 11): skipped 14/16 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      tree origins: 12 made from cpath
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl-selection-metrics.yaml
      total time: 1.3
    [93mwarning[0m get_annotation_dict(): missing annotations for 1/178 clusters in best partition with size: 5 (present: 36, 19, 19, 17, 15, 15, 15, 14, 13, 13, 12, 12, 12, 12, 11, 11, 11, 10, 10, 10, 9, 9, 9, 9, 8, 8, 8, 8, 8, 7, 7, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
        2 extra annotations (i.e. they're for clusters not in best partition) with sizes: 4 1
          missing 'best' cluster with size 5 overlaps with the following (overlap/size): 4/4  1/1
          extra annotation with size 4 overlaps with the following best clusters (overlap/size): 4/5
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/5
    igh+igk: 158 unpaired light clusters after finding h/l cluster pairs
    igh+igk: skipped 160 annotations missing required keys: tree-info: 160
    [93mwarning[0m get_annotation_dict(): missing annotations for 1/93 clusters in best partition with size: 2 (present: 28, 22, 18, 18, 16, 16, 14, 12, 11, 11, 11, 10, 9, 9, 8, 8, 8, 7, 7, 7, 7, 6, 5, 5, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
        2 extra annotations (i.e. they're for clusters not in best partition) with sizes: 1 1
          missing 'best' cluster with size 2 overlaps with the following (overlap/size): 1/1  1/1
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/2
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/2
    igh+igl: 81 unpaired light clusters after finding h/l cluster pairs
    igh+igl: skipped 81 annotations missing required keys: tree-info: 81
            cons seq not observed
        less than 0.75 (6 / 36 = 0.17) of h seqs have indels, so not using input seqs for cons seq
        less than 0.75 (11 / 36 = 0.31) of l seqs have indels, so not using input seqs for cons seq
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 7741817985007670918-igh 7741817985007670918-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8597724437971814835-igh 8597724437971814835-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3594708663923654869-igh 3594708663923654869-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 5048445501780206723-igh 5048445501780206723-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2344959415281749079-igh 2344959415281749079-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3972366704274079153-igh 3972366704274079153-igk
        finished: 15 newly chosen >= 15
            cons seq not observed
        less than 0.75 (5 / 28 = 0.18) of h seqs have indels, so not using input seqs for cons seq
        less than 0.75 (4 / 28 = 0.14) of l seqs have indels, so not using input seqs for cons seq
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 6691410616987150173-igh 6691410616987150173-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 4914357432514125283-igh 4914357432514125283-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 1405942366706810610-igh 1405942366706810610-igl
        finished: 15 newly chosen >= 15
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 0123670178120927814-igh 0123670178120927814-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 9009734495541048899-igh 9009734495541048899-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 0484140507678022067-igh 0484140507678022067-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3238234703589546076-igh 3238234703589546076-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 9103527959323903099-igh 9103527959323903099-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 4027451380298081898-igh 4027451380298081898-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 7931537106327195402-igh 7931537106327195402-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8728341398695971580-igh 8728341398695971580-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 5799141418317739090-igh 5799141418317739090-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 6017246502209720874-igh 6017246502209720874-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2786152605958570014-igh 2786152605958570014-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8996898960484369613-igh 8996898960484369613-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2298849017709047818-igh 2298849017709047818-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 6750634952083250793-igh 6750634952083250793-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 4911521736103208905-igh 4911521736103208905-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 5421621548508046634-igh 5421621548508046634-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 6560328145774376449-igh 6560328145774376449-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8531901226956484723-igh 8531901226956484723-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8598933736264455031-igh 8598933736264455031-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 7801601861738282010-igh 7801601861738282010-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 4080921475674879727-igh 4080921475674879727-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 7239662920896486780-igh 7239662920896486780-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 4795604772285259700-igh 4795604772285259700-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 0927428396589815442-igh 0927428396589815442-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 4223407055982228774-igh 4223407055982228774-igl
        finished: 10 newly chosen >= 10
            cons seq not observed
        less than 0.75 (5 / 18 = 0.28) of h seqs have indels, so not using input seqs for cons seq
        less than 0.75 (1 / 18 = 0.06) of l seqs have indels, so not using input seqs for cons seq
        finished: 5 newly chosen >= 5
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 6250801030173136472-igh 6250801030173136472-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3071731489370113614-igh 3071731489370113614-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3990903488551020162-igh 3990903488551020162-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3017675112334523170-igh 3017675112334523170-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2945937784822102987-igh 2945937784822102987-igk
        finished: 5 newly chosen >= 5
            cons seq not observed
        less than 0.75 (2 / 16 = 0.12) of l seqs have indels, so not using input seqs for cons seq
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3777018811770350853-igh 3777018811770350853-igl
        finished: 5 newly chosen >= 5
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8411571097442290834-igh 8411571097442290834-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 5735706521960683698-igh 5735706521960683698-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3832770680068607362-igh 3832770680068607362-igl
        finished: 3 newly chosen >= 3
      total time: 8.5
