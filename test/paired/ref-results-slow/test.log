[92mcache-parameters-data[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --infname test/paired-data/all-seqs.fa --parameter-dir test/paired/new-results-slow/test/parameters/data --n-max-queries -1 --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[91mrun[0m /home/dralph/work/partis/bin/extract-pairing-info.py test/paired-data/all-seqs.fa /tmp/dralph/hmms/976280/meta.yaml
  extract_pairing_info(): read 100 sequences with 48 droplet ids
    droplet id separators (set automatically): _  indices: [0]
       e.g. uid 'AAACCTGAGAGACGAA-1_contig_2' --> droplet id 'AAACCTGAGAGACGAA-1' contig id '2'
    contigs per
      droplet     count   fraction
        1            2     0.042
        2           42     0.875
        3            2     0.042
        4            2     0.042
[91mrun[0m /home/dralph/work/partis/bin/split-loci.py test/paired-data/all-seqs.fa --outdir /tmp/dralph/hmms/976280 --input-metafname /tmp/dralph/hmms/976280/meta.yaml
  --input-metafnames: added meta info for 100 sequences from /tmp/dralph/hmms/976280/meta.yaml: paired-uids
    read pairing info for 100 seqs from input meta file
  running vsearch on 100 sequences:
    igh:   50 / 100 v annotations (50 failed) with 31 v genes in 0.1 sec
    igk:   39 / 100 v annotations (61 failed) with 20 v genes in 0.1 sec
    igl:   17 / 100 v annotations (83 failed) with 15 v genes in 0.1 sec
totals: igh 48 igk 37 igl 15
  removed 0 failed uids from paired_uids
            count  frac  paired with
       [94mh[0m      31   0.65   [95mk[0m
              11   0.23   [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [92ml[0m
               2   0.04   [94mh[0m [95mk[0m [95mk[0m
               1   0.02   [92ml[0m [92ml[0m
               1   0.02   [95mk[0m [92ml[0m
       [95mk[0m      31   0.84   [94mh[0m
               2   0.05   
               2   0.05   [94mh[0m [94mh[0m [95mk[0m
               1   0.03   [94mh[0m [92ml[0m
               1   0.03   [94mh[0m [94mh[0m [92ml[0m
       [92ml[0m      11   0.73   [94mh[0m
               2   0.13   [94mh[0m [92ml[0m
               1   0.07   [94mh[0m [95mk[0m
               1   0.07   [94mh[0m [94mh[0m [95mk[0m
writing to /tmp/dralph/hmms/976280/
  igh: 48 to 976280/igh.fa
  igk: 37 to 976280/igk.fa
  igl: 15 to 976280/igl.fa
writing to paired subdirs
    36/48 igh seqs pair with igk
      igh: 36 to igh+igk/igh.fa
      igk: 37 to igh+igk/igk.fa
    15/48 igh seqs pair with igl
      igh: 15 to igh+igl/igh.fa
      igl: 15 to igh+igl/igl.fa
[44mcache-parameters[0m [94migh[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --infname /tmp/dralph/hmms/976280/igh.fa --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results-slow/test/parameters/data/igh/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/976280/meta.yaml
  --input-metafnames: added meta info for 48 sequences from /tmp/dralph/hmms/976280/meta.yaml: paired-uids
caching parameters
  vsearch: 48 / 48 v annotations (0 failed) with 29 v genes in 0.1 sec
    keeping 23 / 220 v genes
smith-waterman  (new-allele fitting)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/data/igh/sw-cache.yaml
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 48 / 48 v annotations (0 failed) with 23 v genes in 0.1 sec
    running 10 procs for 48 seqs
      info for 48 / 48 = 1.000   (removed: 0 failed)
      kept 1 (0.021) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/data/igh/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/data/igh/sw (1.8 sec)
    water time: 2.1  (ig-sw 2.0  processing 0.2)
  writing hmms (0.3 sec)
hmm
    running 10 procs
                    calcd:         vtb 48        fwd  0
             min-max time:  0.2 - 0.4 sec
    reading output
        read 48 hmm output lines with 48 sequences in 48 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/data/igh/hmm (1.6 sec)
         infra time: 1.7
      hmm step time: 2.2
  writing hmms (0.2 sec)
      total time: 5.4
[44mcache-parameters[0m [94migk[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --infname /tmp/dralph/hmms/976280/igk.fa --parameter-dir test/paired/new-results-slow/test/parameters/data/igk --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results-slow/test/parameters/data/igk/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/976280/meta.yaml
  --input-metafnames: added meta info for 37 sequences from /tmp/dralph/hmms/976280/meta.yaml: paired-uids
caching parameters
  vsearch: 37 / 37 v annotations (0 failed) with 17 v genes in 0.1 sec
    keeping 16 / 58 v genes
smith-waterman  (new-allele fitting)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/data/igk/sw-cache.yaml
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 37 / 37 v annotations (0 failed) with 16 v genes in 0.1 sec
    running 10 procs for 37 seqs
      info for 37 / 37 = 1.000   (removed: 0 failed)
      kept 1 (0.027) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/data/igk/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/data/igk/sw (1.3 sec)
    water time: 1.5  (ig-sw 1.4  processing 0.1)
  writing hmms (0.1 sec)
hmm
    running 10 procs
                    calcd:         vtb 37        fwd  0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 37 hmm output lines with 37 sequences in 37 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/data/igk/hmm (1.1 sec)
         infra time: 1.2
      hmm step time: 1.4
  writing hmms (0.1 sec)
      total time: 3.7
[44mcache-parameters[0m [94migl[0m:
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --infname /tmp/dralph/hmms/976280/igl.fa --parameter-dir test/paired/new-results-slow/test/parameters/data/igl --random-seed 1 --n-procs 10 --sw-cachefname test/paired/new-results-slow/test/parameters/data/igl/sw-cache.yaml --input-metafnames /tmp/dralph/hmms/976280/meta.yaml
  --input-metafnames: added meta info for 15 sequences from /tmp/dralph/hmms/976280/meta.yaml: paired-uids
caching parameters
  vsearch: 15 / 15 v annotations (0 failed) with 13 v genes in 0.1 sec
    keeping 10 / 70 v genes
smith-waterman  (new-allele fitting)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.1 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/data/igl/sw-cache.yaml
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
    water time: 0.1  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 15 / 15 v annotations (0 failed) with 10 v genes in 0.0 sec
    running 10 procs for 15 seqs
      info for 15 / 15 = 1.000   (removed: 0 failed)
        writing sw results to test/paired/new-results-slow/test/parameters/data/igl/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/data/igl/sw (0.9 sec)
    water time: 1.0  (ig-sw 1.0  processing 0.1)
  writing hmms (0.1 sec)
hmm
    running 10 procs
                    calcd:         vtb 15        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 15 hmm output lines with 15 sequences in 15 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/data/igl/hmm (0.7 sec)
         infra time: 0.7
      hmm step time: 0.9
  writing hmms (0.1 sec)
      total time: 2.5
      [93mwarning[0m expected to remove 1/11 files+dirs that weren't in /tmp/dralph/hmms/976280/: failed.fa
      total time: 13.3
[92msimulate[0m                         /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --paired-loci --parameter-dir test/paired/new-results-slow/test/parameters/data --n-sim-events 200 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/test/simu --indel-frequency 0.2
    cleaning paired files in test/paired/new-results-slow/test/simu/
[94migh+igk[0m: simulating 134 events
[44mgenerate-trees[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-trees 134 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 177687104 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 134 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 134 trees:   depth 0.02835   leaves 5.57
    writing trees to test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
      total time: 1.6
[44msimulate[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-sim-events 134 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 177687104 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igk/igh.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
simulating
      --> proc 5
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/575995/trees-sub-5.nwk
    made 13 events with 47 seqs in 2.4s (2.1s of which was running bppseqgen)
      total time: 2.8

      --> proc 4
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/575995/trees-sub-4.nwk
    made 13 events with 59 seqs in 2.5s (2.2s of which was running bppseqgen)
      total time: 2.8

      --> proc 8
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/575995/trees-sub-8.nwk
    made 13 events with 57 seqs in 2.4s (2.1s of which was running bppseqgen)
      total time: 2.7

      --> proc 6
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/575995/trees-sub-6.nwk
    made 13 events with 55 seqs in 2.6s (2.3s of which was running bppseqgen)
      total time: 3.0

      --> proc 7
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/575995/trees-sub-7.nwk
    made 13 events with 65 seqs in 2.6s (2.4s of which was running bppseqgen)
      total time: 3.0

      --> proc 1
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/575995/trees-sub-1.nwk
    made 13 events with 71 seqs in 2.8s (2.4s of which was running bppseqgen)
      total time: 3.2

      --> proc 0
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/575995/trees-sub-0.nwk
    made 13 events with 94 seqs in 2.8s (2.5s of which was running bppseqgen)
      total time: 3.2

      --> proc 2
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/575995/trees-sub-2.nwk
    made 13 events with 104 seqs in 2.9s (2.6s of which was running bppseqgen)
      total time: 3.3

      --> proc 3
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/575995/trees-sub-3.nwk
    made 13 events with 84 seqs in 2.9s (2.5s of which was running bppseqgen)
      total time: 3.3

      --> proc 9
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 17 to match trees read from /tmp/dralph/hmms/575995/trees-sub-9.nwk
    made 17 events with 111 seqs in 3.5s (3.2s of which was running bppseqgen)
      total time: 3.9

   read 134 events with 747 seqs from 10 .yaml files
      total time: 4.7
[44msimulate[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igk --n-sim-events 134 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 298017927 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igk/igk.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igk/trees.nwk
simulating
      --> proc 6
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/499380/trees-sub-6.nwk
    made 13 events with 55 seqs in 1.9s (1.7s of which was running bppseqgen)
      total time: 2.2

      --> proc 5
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/499380/trees-sub-5.nwk
    made 13 events with 47 seqs in 2.0s (1.8s of which was running bppseqgen)
      total time: 2.3

      --> proc 4
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/499380/trees-sub-4.nwk
    made 13 events with 59 seqs in 2.1s (1.8s of which was running bppseqgen)
      total time: 2.4

      --> proc 3
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/499380/trees-sub-3.nwk
    made 13 events with 84 seqs in 2.1s (1.8s of which was running bppseqgen)
      total time: 2.3

      --> proc 1
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/499380/trees-sub-1.nwk
    made 13 events with 71 seqs in 2.2s (2.0s of which was running bppseqgen)
      total time: 2.6

      --> proc 8
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/499380/trees-sub-8.nwk
    made 13 events with 57 seqs in 2.1s (1.9s of which was running bppseqgen)
      total time: 2.5

      --> proc 7
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/499380/trees-sub-7.nwk
    made 13 events with 65 seqs in 2.2s (1.9s of which was running bppseqgen)
      total time: 2.6

      --> proc 0
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/499380/trees-sub-0.nwk
    made 13 events with 94 seqs in 2.5s (2.2s of which was running bppseqgen)
      total time: 2.9

      --> proc 2
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 13 to match trees read from /tmp/dralph/hmms/499380/trees-sub-2.nwk
    made 13 events with 104 seqs in 2.7s (2.5s of which was running bppseqgen)
      total time: 3.1

      --> proc 9
    reco params: test/paired/new-results-slow/test/parameters/data/igk/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igk/hmm
    resetting --n-trees from 200 to 17 to match trees read from /tmp/dralph/hmms/499380/trees-sub-9.nwk
    made 17 events with 111 seqs in 3.0s (2.8s of which was running bppseqgen)
      total time: 3.2

   read 134 events with 747 seqs from 10 .yaml files
      total time: 4.2
[94migh+igl[0m: simulating 66 events
[44mgenerate-trees[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-trees 66 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 172687121 --indel-frequency 0.2 --generate-trees --outfname test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
  note: reducing --n-procs to 1 (was 28) so it isn't bigger than --n-sim-events
  generating 66 trees, n-leaves from geometric distribution with parameter 5.0
    mean over 66 trees:   depth 0.02473   leaves 6.45
    writing trees to test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
      total time: 1.4
[44msimulate[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igh --n-sim-events 66 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 172687121 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igl/igh.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
simulating
      --> proc 0
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/666540/trees-sub-0.nwk
    made 6 events with 15 seqs in 1.2s (1.1s of which was running bppseqgen)
      total time: 1.6

      --> proc 4
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/666540/trees-sub-4.nwk
    made 6 events with 22 seqs in 1.2s (0.9s of which was running bppseqgen)
      total time: 1.5

      --> proc 3
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/666540/trees-sub-3.nwk
    made 6 events with 41 seqs in 1.2s (1.1s of which was running bppseqgen)
      total time: 1.6

      --> proc 5
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/666540/trees-sub-5.nwk
    made 6 events with 27 seqs in 1.3s (1.1s of which was running bppseqgen)
      total time: 1.6

      --> proc 6
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/666540/trees-sub-6.nwk
    made 6 events with 30 seqs in 1.2s (1.1s of which was running bppseqgen)
      total time: 1.6

      --> proc 1
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/666540/trees-sub-1.nwk
    made 6 events with 49 seqs in 1.3s (1.1s of which was running bppseqgen)
      total time: 1.6

      --> proc 7
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/666540/trees-sub-7.nwk
    made 6 events with 31 seqs in 1.2s (1.0s of which was running bppseqgen)
      total time: 1.5

      --> proc 2
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/666540/trees-sub-2.nwk
    made 6 events with 43 seqs in 1.5s (1.3s of which was running bppseqgen)
      total time: 1.8

      --> proc 8
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/666540/trees-sub-8.nwk
    made 6 events with 69 seqs in 1.6s (1.5s of which was running bppseqgen)
      total time: 1.9

      --> proc 9
    reco params: test/paired/new-results-slow/test/parameters/data/igh/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igh/hmm
    resetting --n-trees from 200 to 12 to match trees read from /tmp/dralph/hmms/666540/trees-sub-9.nwk
    made 12 events with 99 seqs in 2.5s (2.2s of which was running bppseqgen)
      total time: 2.8

   read 66 events with 426 seqs from 10 .yaml files
      total time: 3.7
[44msimulate[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis simulate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/data/igl --n-sim-events 66 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --min-observations-per-gene 5 --mean-cells-per-droplet 1.5 --constant-cells-per-droplet --fraction-of-reads-to-remove 0.15 --random-seed 1456246501 --n-procs 10 --indel-frequency 0.2 --choose-trees-in-order --outfname test/paired/new-results-slow/test/simu/igh+igl/igl.yaml --input-simulation-treefname test/paired/new-results-slow/test/simu/igh+igl/trees.nwk
simulating
      --> proc 0
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/740018/trees-sub-0.nwk
    made 6 events with 15 seqs in 0.9s (0.8s of which was running bppseqgen)
      total time: 1.3

      --> proc 7
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/740018/trees-sub-7.nwk
    made 6 events with 31 seqs in 1.0s (0.9s of which was running bppseqgen)
      total time: 1.4

      --> proc 3
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/740018/trees-sub-3.nwk
    made 6 events with 41 seqs in 1.1s (1.0s of which was running bppseqgen)
      total time: 1.4

      --> proc 5
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/740018/trees-sub-5.nwk
    made 6 events with 27 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.4

      --> proc 2
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/740018/trees-sub-2.nwk
    made 6 events with 43 seqs in 1.1s (1.0s of which was running bppseqgen)
      total time: 1.5

      --> proc 6
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/740018/trees-sub-6.nwk
    made 6 events with 30 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.3

      --> proc 4
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/740018/trees-sub-4.nwk
    made 6 events with 22 seqs in 1.1s (0.9s of which was running bppseqgen)
      total time: 1.4

      --> proc 8
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/740018/trees-sub-8.nwk
    made 6 events with 69 seqs in 1.2s (1.1s of which was running bppseqgen)
      total time: 1.5

      --> proc 1
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 6 to match trees read from /tmp/dralph/hmms/740018/trees-sub-1.nwk
    made 6 events with 49 seqs in 1.3s (1.2s of which was running bppseqgen)
      total time: 1.7

      --> proc 9
    reco params: test/paired/new-results-slow/test/parameters/data/igl/hmm     shm params: test/paired/new-results-slow/test/parameters/data/igl/hmm
    resetting --n-trees from 200 to 12 to match trees read from /tmp/dralph/hmms/740018/trees-sub-9.nwk
    made 12 events with 99 seqs in 2.2s (1.9s of which was running bppseqgen)
      total time: 2.4

   read 66 events with 426 seqs from 10 .yaml files
      total time: 3.4
[94migh+igk[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results-slow/test/simu/igh+igk/
[94migh+igl[0m: synchronizing heavy and light chain simulation trees and rewriting output files in test/paired/new-results-slow/test/simu/igh+igl/
  apportioned 2346 seqs among 782 droplets (mean/2 1.5): 2 4 2 4 4 2 4 4 2 4 2 4 4 4 4 2 4 4 4 4 2 4 2 4 2 4 4 4 2 2 2 2 4 4 2 2 4 4 2 4 4 2 4 2 2 2 4 4 4 4 2 4 4 4 2 2 4 4 4 4 2 2 4 4 2 4 2 4 4 4 4 2 4 4 2 4 4 4 4 4 4 4 2 2 4 4 2 2 2 2 4 4 2 2 4 2 2 2 4 2 4 4 4 4 2 4 4 2 2 4 2 2 2 2 4 4 4 2 2 4 2 4 2 4 2 4 2 4 4 4 4 4 4 4 2 2 2 2 2 2 2 4 2 2 4 2 4 2 4 4 4 4 4 4 2 2 2 4 2 4 4 2 2 4 4 4 4 4 4 4 2 4 4 2 4 4 2 2 2 4 2 4 2 2 2 2 4 4 4 2 2 2 4 2 4 2 2 2 2 4 2 4 4 2 2 4 4 2 4 2 2 2 2 4 2 2 2 4 4 2 2 2 2 2 2 2 2 4 4 4 4 2 2 2 2 4 2 4 4 4 2 4 4 4 4 2 4 4 4 4 4 2 4 2 4 2 2 2 4 4 2 2 4 4 2 2 2 2 4 4 2 4 4 4 4 2 4 4 2 2 2 2 2 2 4 4 2 2 4 2 4 4 4 4 4 4 4 2 2 4 2 2 4 4 4 4 4 4 4 2 2 2 2 4 4 4 4 2 2 2 2 2 4 2 2 4 2 2 2 2 2 2 4 2 4 2 4 4 2 2 4 2 4 2 4 2 2 4 2 2 2 4 2 2 2 4 2 2 4 4 4 4 4 4 2 2 4 2 4 2 4 4 2 4 4 4 2 4 2 4 4 2 2 4 4 2 2 4 4 2 4 2 2 2 2 2 4 4 4 4 4 4 4 4 4 2 4 4 4 2 2 4 4 2 4 2 2 2 4 4 2 2 4 4 2 2 2 2 2 2 2 4 2 2 2 4 2 2 2 2 2 4 2 4 4 4 4 4 2 2 2 2 2 2 4 2 2 4 2 2 4 4 2 4 2 4 4 4 2 4 4 2 4 4 4 4 2 2 4 4 2 4 4 2 4 2 4 2 2 2 2 2 2 4 4 4 4 2 4 2 4 2 2 4 4 4 4 4 2 4 2 2 4 4 4 4 2 2 4 4 2 4 2 2 2 4 4 2 2 2 2 2 4 4 4 2 4 2 2 4 2 2 4 4 2 2 2 4 2 4 2 4 4 2 4 2 2 2 4 4 4 2 4 4 4 4 4 4 2 2 2 2 4 4 2 4 2 2 2 4 4 2 2 4 2 2 4 4 4 4 2 4 2 4 2 2 4 2 2 2 2 4 4 4 4 4 2 2 4 4 4 4 2 2 2 4 4 2 2 4 2 2 2 2 4 2 4 2 4 2 4 2 4 2 2 4 4 2 4 4 2 2 2 2 4 2 4 4 2 4 4 4 2 4 2 2 2 2 2 4 4 4 4 4 4 2 4 4 2 2 2 4 4 4 4 4 2 2 2 2 4 2 2 2 4 2 4 2 2 2 4 4 4 4 2 2 4 2 2 2 2 2 4 2 2 4 4 2 4 2 2 4 4 4 4 4 2 4 4 2 4 4 2 2 4 4 2 2 2 4 2 2 2 2 2 2 2 2 2 4 2 4 2 2 2 2 4 4 2 4 2 2 4 2 4 2 2 4 2 2 4 2 4 2 4 2 4 4 2 2 2 4 4 2 2 2 4 2 4 2 4 4
  removed 351 / 2346 = 0.15 seqs from outfos (leaving 112 / 1995 unpaired)
[91mrun[0m cd test/paired/new-results-slow/test/simu && ln -sf igh+igk/igk.yaml igk.yaml
[91mrun[0m cd test/paired/new-results-slow/test/simu && ln -sf igh+igl/igl.yaml igl.yaml
      total time: 23.1
[92mcache-parameters-simu[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --paired-loci --paired-indir test/paired/new-results-slow/test/simu --parameter-dir test/paired/new-results-slow/test/parameters/simu --is-simu --random-seed 1 --n-procs 10
  note: --paired-outdir is not set, so there will be no persistent record of the results (except the parameter directory).
[44mcache-parameters[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results-slow/test/simu/igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 1000 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
caching parameters
  vsearch: 1000 / 1000 v annotations (0 failed) with 45 v genes in 0.1 sec
    keeping 23 / 220 v genes
smith-waterman  (new-allele fitting)
  vsearch: 1000 / 1000 v annotations (0 failed) with 23 v genes in 0.2 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
    running 10 procs for 1000 seqs
    running 11 procs for 52 seqs
      info for 1000 / 1000 = 1.000   (removed: 0 failed)
      kept 362 (0.362) unproductive
    water time: 1.4  (ig-sw 0.1  processing 0.2)
smith-waterman  (writing parameters)
  vsearch: 1000 / 1000 v annotations (0 failed) with 23 v genes in 0.3 sec
    running 10 procs for 1000 seqs
    running 11 procs for 52 seqs
      info for 1000 / 1000 = 1.000   (removed: 0 failed)
      kept 362 (0.362) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igh/sw (1.6 sec)
    water time: 3.7  (ig-sw 2.2  processing 0.3)
  writing hmms (0.3 sec)
hmm
    skipping matches from 3 genes without enough counts: [95mh[0m[91mj[0m[95m6[0m[93m04[0m [95mh[0m[91mj[0m[95m6[0m[93m03[0m [95mh[0m[91mj[0m[95m5[0m[93m01[0m
    running 10 procs
                    calcd:         vtb 1000        fwd    0
             min-max time:  1.5 - 1.7 sec
    reading output
        read 1000 hmm output lines with 1000 sequences in 1000 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igh/hmm (1.5 sec)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igh/true (1.5 sec)
         infra time: 4.4
      hmm step time: 6.3
  writing hmms (0.3 sec)
      total time: 14.1
[44mcache-parameters[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results-slow/test/simu/igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 640 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
caching parameters
  vsearch: 640 / 640 v annotations (0 failed) with 17 v genes in 0.1 sec
    keeping 16 / 58 v genes
smith-waterman  (new-allele fitting)
  vsearch: 640 / 640 v annotations (0 failed) with 16 v genes in 0.2 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
    running 10 procs for 640 seqs
    running 11 procs for 12 seqs
      info for 640 / 640 = 1.000   (removed: 0 failed)
      kept 104 (0.163) unproductive
    water time: 0.7  (ig-sw 0.1  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 640 / 640 v annotations (0 failed) with 16 v genes in 0.2 sec
    running 10 procs for 640 seqs
    running 11 procs for 12 seqs
      info for 640 / 640 = 1.000   (removed: 0 failed)
      kept 104 (0.163) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igk/sw (1.3 sec)
    water time: 2.4  (ig-sw 1.6  processing 0.2)
  writing hmms (0.1 sec)
hmm
    skipping matches from 2 genes without enough counts: [95mk[0m[91mj[0m[95m4[0m[93m02[0m [95mk[0m[91mj[0m[95m2[0m[93m02[0m
    running 10 procs
                    calcd:         vtb 640        fwd   0
             min-max time:  0.7 - 0.8 sec
    reading output
        read 640 hmm output lines with 640 sequences in 640 events  (0 failures)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igk/hmm (1.0 sec)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igk/true (1.1 sec)
         infra time: 3.3
      hmm step time: 4.2
  writing hmms (0.3 sec)
      total time: 8.8
[44mcache-parameters[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis cache-parameters --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --is-simu --random-seed 1 --n-procs 10 --infname test/paired/new-results-slow/test/simu/igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 355 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
caching parameters
  vsearch: 355 / 355 v annotations (0 failed) with 11 v genes in 0.1 sec
    keeping 10 / 70 v genes
smith-waterman  (new-allele fitting)
  vsearch: 355 / 355 v annotations (0 failed) with 10 v genes in 0.1 sec
  removing old sw cache test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
    running 10 procs for 355 seqs
    running 11 procs for 6 seqs
      info for 355 / 355 = 1.000   (removed: 0 failed)
      kept 72 (0.203) unproductive
    water time: 0.4  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 355 / 355 v annotations (0 failed) with 10 v genes in 0.1 sec
    running 10 procs for 355 seqs
    running 11 procs for 6 seqs
      info for 355 / 355 = 1.000   (removed: 0 failed)
      kept 72 (0.203) unproductive
        writing sw results to test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igl/sw (0.8 sec)
    water time: 1.4  (ig-sw 1.0  processing 0.1)
  writing hmms (0.2 sec)
hmm
    running 10 procs
                    calcd:         vtb 355        fwd   0
             min-max time:  0.4 - 0.5 sec
    reading output
        read 355 hmm output lines with 353 sequences in 353 events  (2 failures)
          [91mwarning[0m no valid paths: 5641474851525436229-igl 2198347140778209734-igl
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igl/hmm (0.6 sec)
    writing parameters to test/paired/new-results-slow/test/parameters/simu/igl/true (0.6 sec)
         infra time: 1.9
      hmm step time: 2.5
  writing hmms (0.1 sec)
      total time: 5.4
      total time: 29.3
[92mpartition-new-simu[0m               /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results-slow/test/simu --parameter-dir test/paired/new-results-slow/test/parameters/simu --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/partition-new-simu
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance/single-chain/plots/igh --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/test/simu/igh.yaml --outfname test/paired/new-results-slow/partition-new-simu/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 1000 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 1000 / 1000 v annotations (0 failed) with 23 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 1000 / 1000 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 362 (0.362) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 60 queries with different true and inferred net shm indel lengths: 4192068443523205981-igh 3344153475914336323-igh 1202949175819197746-igh 8034210568695520943-igh 5235663855169387750-igh 5615089169204214323-igh 9205266174301842569-igh 3050253348688105500-igh 8969176644417932865-igh 7682485172737982251-igh 0597718852660649256-igh 7629792630742498808-igh 2777174777771684527-igh 4608757704775049090-igh 0382698166016426951-igh 8534652470420476999-igh 1518467750867165802-igh 5188001054004936734-igh 6894481868764512496-igh 2724108028195531205-igh 5264619182804074939-igh 5962962771298656083-igh 0146805805939391560-igh 4773789714601703176-igh 6926934037249415110-igh 5535231431895011600-igh 3647098539805060335-igh 4548314598443047427-igh 0519450483773894785-igh 8826175195458224953-igh 1383512084509220405-igh 2693734392910219054-igh 8655698202831101057-igh 3734427732220219254-igh 7584179207649415216-igh 4847540134030695462-igh 3916124757125782793-igh 0161606783835244621-igh 3729233455894130421-igh 5547404517180313400-igh 2632568693062682293-igh 8491734797531648044-igh 1891024981741873852-igh 0642147441991752901-igh 0960715752824823700-igh 2011934737232710316-igh 8484652898258995600-igh 5735323184917054667-igh 4262800480392836293-igh 6471094595481694140-igh 8480892480895180921-igh 2476414678775607200-igh 5479979364695988617-igh 5112953187350510314-igh 0914756165645325536-igh 7275730084457077662-igh 2308552076047697183-igh 2387080066609923455-igh 1264885607107417547-igh 2216147249973404315-igh
(0.0 sec)
        water time: 1.0
hmm
caching all 1000 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 1000        fwd    0
                   merged:       hfrac    0     lratio    0
             min-max time:  1.5 - 1.7 sec
      hmm step time: 1.9
   collapsed 1000 queries into 454 clusters with identical naive seqs (0.0 sec)
454 clusters with 10 procs
       setting naive hfrac bounds: 0.015 0.064
    running 10 procs
          read from cache:  naive-seqs 1000   logprobs    0
                    calcd:         vtb  213        fwd  398
                   merged:       hfrac   42     lratio   51
             min-max time:  0.9 - 1.9 sec
         infra time: 0.3
      hmm step time: 2.2
361 clusters with 7 procs
       naive hfrac bounds: 0.015 0.064
    running 7 procs
          read from cache:  naive-seqs 1216   logprobs  398
                    calcd:         vtb   58        fwd  198
                   merged:       hfrac   25     lratio   28
             min-max time:  0.9 - 1.3 sec
         infra time: 0.3
      hmm step time: 1.7
308 clusters with 5 procs
       naive hfrac bounds: 0.015 0.064
    running 5 procs
          read from cache:  naive-seqs 1276   logprobs  596
                    calcd:         vtb   53        fwd  152
                   merged:       hfrac   26     lratio   25
             min-max time:  1.1 - 2.3 sec
         infra time: 0.2
      hmm step time: 2.5
257 clusters with 3 procs
       naive hfrac bounds: 0.015 0.064
    running 3 procs
          read from cache:  naive-seqs 1331   logprobs  748
                    calcd:         vtb   35        fwd  129
                   merged:       hfrac   27     lratio    9
             min-max time:  1.8 - 2.5 sec
         infra time: 0.2
      hmm step time: 2.8
221 clusters with 2 procs
       naive hfrac bounds: 0.015 0.064
    running 2 procs
          read from cache:  naive-seqs 1370   logprobs  877
                    calcd:         vtb   27        fwd  125
                   merged:       hfrac   17     lratio   11
             min-max time:  2.7 - 5.1 sec
         infra time: 0.2
      hmm step time: 5.3
193 clusters with 2 procs
       naive hfrac bounds: 0.015 0.064
    running 2 procs
          read from cache:  naive-seqs 1402   logprobs 1002
                    calcd:         vtb    6        fwd   58
                   merged:       hfrac    3     lratio    3
             min-max time:  0.7 - 3.1 sec
         infra time: 0.2
      hmm step time: 3.3
187 clusters with 2 procs
       naive hfrac bounds: 0.015 0.064
    running 2 procs
          read from cache:  naive-seqs 1409   logprobs 1060
                    calcd:         vtb    2        fwd   24
                   merged:       hfrac    1     lratio    1
             min-max time:  0.7 - 0.8 sec
         infra time: 0.1
      hmm step time: 0.9
185 clusters with 1 proc
       naive hfrac bounds: 0.015 0.064
    running 1 proc
          read from cache:  naive-seqs 1411   logprobs 1084
                    calcd:         vtb    2        fwd   83
                   merged:       hfrac    1     lratio    1
                     time:  2.9 sec
         infra time: 0.1
      hmm step time: 3.0
  [93mnote[0m not merging entire cpath history
      loop time: 21.7
getting annotations for final partition
  subcluster annotating 183 clusters: 
    running 10 procs
                    calcd:         vtb  411        fwd    0
             min-max time:  1.1 - 1.3 sec
    reading output
        read 411 hmm output lines with 1000 sequences in 411 events  (0 failures)
         infra time: 0.5
      hmm step time: 1.8
    read 411 new subcluster annotations: added hashid 314   whole finished 97   subcl finished 0
    running 10 procs
                    calcd:         vtb  128        fwd    0
             min-max time:  0.5 - 0.8 sec
    reading output
        read 128 hmm output lines with 314 sequences in 128 events  (0 failures)
         infra time: 0.2
      hmm step time: 1.0
    read 128 new subcluster annotations: added hashid 128   whole finished 0   subcl finished 56
    running 10 procs
                    calcd:         vtb   34        fwd    0
             min-max time:  0.2 - 0.4 sec
    reading output
        read 34 hmm output lines with 72 sequences in 34 events  (0 failures)
      hmm step time: 0.5
    read 34 new subcluster annotations: added hashid 34   whole finished 0   subcl finished 26
    running 4 procs
                    calcd:         vtb    4        fwd    0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 4 hmm output lines with 8 sequences in 4 events  (0 failures)
      hmm step time: 0.3
    read 4 new subcluster annotations: added hashid 4   whole finished 0   subcl finished 4
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 60 queries with different true and inferred net shm indel lengths: 8969176644417932865-igh 5962962771298656083-igh 2777174777771684527-igh 0146805805939391560-igh 0161606783835244621-igh 6471094595481694140-igh 2632568693062682293-igh 1891024981741873852-igh 2011934737232710316-igh 5735323184917054667-igh 8484652898258995600-igh 4262800480392836293-igh 8491734797531648044-igh 8480892480895180921-igh 0960715752824823700-igh 3916124757125782793-igh 0642147441991752901-igh 8655698202831101057-igh 5615089169204214323-igh 0519450483773894785-igh 4847540134030695462-igh 1383512084509220405-igh 1518467750867165802-igh 3729233455894130421-igh 0382698166016426951-igh 0597718852660649256-igh 0914756165645325536-igh 1202949175819197746-igh 1264885607107417547-igh 2216147249973404315-igh 2308552076047697183-igh 2387080066609923455-igh 2476414678775607200-igh 2693734392910219054-igh 2724108028195531205-igh 3050253348688105500-igh 3344153475914336323-igh 3647098539805060335-igh 3734427732220219254-igh 4192068443523205981-igh 4548314598443047427-igh 4608757704775049090-igh 4773789714601703176-igh 5112953187350510314-igh 5188001054004936734-igh 5235663855169387750-igh 5264619182804074939-igh 5479979364695988617-igh 5535231431895011600-igh 5547404517180313400-igh 6894481868764512496-igh 6926934037249415110-igh 7275730084457077662-igh 7584179207649415216-igh 7629792630742498808-igh 7682485172737982251-igh 8034210568695520943-igh 8534652470420476999-igh 8826175195458224953-igh 9205266174301842569-igh
(0.0 sec)
    subcluster annotation time 6.1
    correct cluster fractions:
       clusters uids
         193    1000  true
         193    1000  inferred
      purity:       814.1 / 1000 = 0.814
      completeness: 883.6 / 1000 = 0.884
    correct cluster fractions:
       clusters uids
         193    1000  true
         192    1000  inferred
      purity:       811.5 / 1000 = 0.812
      completeness: 885.2 / 1000 = 0.885
    correct cluster fractions:
       clusters uids
         193    1000  true
         191    1000  inferred
      purity:       811.5 / 1000 = 0.812
      completeness: 888.2 / 1000 = 0.888
    correct cluster fractions:
       clusters uids
         193    1000  true
         190    1000  inferred
      purity:       811.1 / 1000 = 0.811
      completeness: 890.6 / 1000 = 0.891
    correct cluster fractions:
       clusters uids
         193    1000  true
         189    1000  inferred
      purity:       811.0 / 1000 = 0.811
      completeness: 893.4 / 1000 = 0.893
    correct cluster fractions:
       clusters uids
         193    1000  true
         188    1000  inferred
      purity:       811.0 / 1000 = 0.811
      completeness: 895.0 / 1000 = 0.895
    correct cluster fractions:
       clusters uids
         193    1000  true
         187    1000  inferred
      purity:       809.3 / 1000 = 0.809
      completeness: 895.0 / 1000 = 0.895
    correct cluster fractions:
       clusters uids
         193    1000  true
         186    1000  inferred
      purity:       808.6 / 1000 = 0.809
      completeness: 896.4 / 1000 = 0.896
    correct cluster fractions:
       clusters uids
         193    1000  true
         185    1000  inferred
      purity:       808.6 / 1000 = 0.809
      completeness: 897.9 / 1000 = 0.898
    correct cluster fractions:
       clusters uids
         193    1000  true
         184    1000  inferred
      purity:       808.6 / 1000 = 0.809
      completeness: 899.4 / 1000 = 0.899
    correct cluster fractions:
       clusters uids
         193    1000  true
         183    1000  inferred
      purity:       807.3 / 1000 = 0.807
      completeness: 900.7 / 1000 = 0.901
      total time: 31.7
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance/single-chain/plots/igk --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/test/simu/igk.yaml --outfname test/paired/new-results-slow/partition-new-simu/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 640 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 640 / 640 v annotations (0 failed) with 16 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 640 / 640 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 104 (0.163) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 23 queries with different true and inferred net shm indel lengths: 0515260043455636484-igk 2975541313160084247-igk 7675054709541274093-igk 0531663798372164401-igk 8446875149878856061-igk 6851776658586386056-igk 7693481556048738438-igk 0214417136935543342-igk 4298416357202104977-igk 3350624392108677302-igk 8025203209748248734-igk 6653034035666474287-igk 5345683336122321701-igk 0078203303789609435-igk 1148690771713848094-igk 1259828056574908624-igk 3721784662459920788-igk 4581021426518923022-igk 2838638195647889098-igk 2659599773997899895-igk 4542591872697134459-igk 3772548365632771450-igk 8401124037514061184-igk
(0.0 sec)
        water time: 0.7
hmm
caching all 640 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 640        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  0.7 - 0.8 sec
      hmm step time: 1.0
   collapsed 640 queries into 56 clusters with identical naive seqs (0.0 sec)
56 clusters with 10 procs
       setting naive hfrac bounds: 0.015 0.060
    running 10 procs
          read from cache:  naive-seqs 640   logprobs   0
                    calcd:         vtb  31        fwd   0
                   merged:       hfrac   1     lratio   0
             min-max time:  0.1 - 0.2 sec
         infra time: 0.2
      hmm step time: 0.4
55 clusters with 7 procs
       naive hfrac bounds: 0.015 0.060
    running 7 procs
          read from cache:  naive-seqs 676   logprobs   0
                    calcd:         vtb  13        fwd   3
                   merged:       hfrac   3     lratio   0
             min-max time:  0.0 - 0.2 sec
         infra time: 0.1
      hmm step time: 0.4
52 clusters with 5 procs
       naive hfrac bounds: 0.015 0.060
    running 5 procs
          read from cache:  naive-seqs 691   logprobs   3
                    calcd:         vtb   2        fwd   5
                   merged:       hfrac   1     lratio   0
             min-max time:  0.0 - 0.1 sec
         infra time: 0.1
      hmm step time: 0.3
51 clusters with 3 procs
       naive hfrac bounds: 0.015 0.060
    running 3 procs
          read from cache:  naive-seqs 694   logprobs   8
                    calcd:         vtb   3        fwd   3
                   merged:       hfrac   2     lratio   0
             min-max time:  0.1 - 0.1 sec
         infra time: 0.1
      hmm step time: 0.2
49 clusters with 2 procs
       naive hfrac bounds: 0.015 0.060
    running 2 procs
          read from cache:  naive-seqs 697   logprobs  11
                    calcd:         vtb   1        fwd   4
                   merged:       hfrac   1     lratio   0
             min-max time:  0.0 - 0.2 sec
         infra time: 0.1
      hmm step time: 0.3
48 clusters with 1 proc
       naive hfrac bounds: 0.015 0.060
    running 1 proc
          read from cache:  naive-seqs 698   logprobs  15
                    calcd:         vtb   3        fwd  48
                   merged:       hfrac   3     lratio   0
                     time:  0.9 sec
      hmm step time: 1.0
      loop time: 2.7
getting annotations for final partition
  subcluster annotating 47 clusters: 
    running 10 procs
                    calcd:         vtb 231        fwd   0
             min-max time:  0.5 - 0.7 sec
    reading output
        read 231 hmm output lines with 640 sequences in 231 events  (0 failures)
         infra time: 0.6
      hmm step time: 1.3
    read 231 new subcluster annotations: added hashid 217   whole finished 14   subcl finished 0
    running 10 procs
                    calcd:         vtb  83        fwd   0
             min-max time:  0.3 - 0.4 sec
    reading output
        read 83 hmm output lines with 217 sequences in 83 events  (0 failures)
         infra time: 0.1
      hmm step time: 0.6
    read 83 new subcluster annotations: added hashid 83   whole finished 0   subcl finished 8
    running 10 procs
                    calcd:         vtb  31        fwd   0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 31 hmm output lines with 75 sequences in 31 events  (0 failures)
      hmm step time: 0.3
    read 31 new subcluster annotations: added hashid 31   whole finished 0   subcl finished 20
    running 5 procs
                    calcd:         vtb   5        fwd   0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 5 hmm output lines with 11 sequences in 5 events  (0 failures)
      hmm step time: 0.1
    read 5 new subcluster annotations: added hashid 5   whole finished 0   subcl finished 5
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 23 queries with different true and inferred net shm indel lengths: 0214417136935543342-igk 8401124037514061184-igk 2975541313160084247-igk 7675054709541274093-igk 0515260043455636484-igk 2659599773997899895-igk 0531663798372164401-igk 4298416357202104977-igk 5345683336122321701-igk 1259828056574908624-igk 6851776658586386056-igk 0078203303789609435-igk 1148690771713848094-igk 2838638195647889098-igk 3350624392108677302-igk 3721784662459920788-igk 3772548365632771450-igk 4542591872697134459-igk 4581021426518923022-igk 6653034035666474287-igk 7693481556048738438-igk 8025203209748248734-igk 8446875149878856061-igk
(0.0 sec)
    subcluster annotation time 3.0
    correct cluster fractions:
       clusters uids
         127    640  true
          56    640  inferred
      purity:       296.4 / 640 = 0.463
      completeness: 619.9 / 640 = 0.969
    correct cluster fractions:
       clusters uids
         127    640  true
          55    640  inferred
      purity:       292.0 / 640 = 0.456
      completeness: 619.9 / 640 = 0.969
    correct cluster fractions:
       clusters uids
         127    640  true
          54    640  inferred
      purity:       286.8 / 640 = 0.448
      completeness: 619.9 / 640 = 0.969
    correct cluster fractions:
       clusters uids
         127    640  true
          53    640  inferred
      purity:       276.3 / 640 = 0.432
      completeness: 619.9 / 640 = 0.969
    correct cluster fractions:
       clusters uids
         127    640  true
          52    640  inferred
      purity:       274.6 / 640 = 0.429
      completeness: 619.9 / 640 = 0.969
    correct cluster fractions:
       clusters uids
         127    640  true
          51    640  inferred
      purity:       271.4 / 640 = 0.424
      completeness: 619.9 / 640 = 0.969
    correct cluster fractions:
       clusters uids
         127    640  true
          50    640  inferred
      purity:       264.6 / 640 = 0.413
      completeness: 619.9 / 640 = 0.969
    correct cluster fractions:
       clusters uids
         127    640  true
          49    640  inferred
      purity:       260.2 / 640 = 0.407
      completeness: 619.9 / 640 = 0.969
    correct cluster fractions:
       clusters uids
         127    640  true
          48    640  inferred
      purity:       257.8 / 640 = 0.403
      completeness: 619.9 / 640 = 0.969
    correct cluster fractions:
       clusters uids
         127    640  true
          47    640  inferred
      purity:       256.0 / 640 = 0.400
      completeness: 619.9 / 640 = 0.969
    correct cluster fractions:
       clusters uids
         127    640  true
          46    640  inferred
      purity:       248.5 / 640 = 0.388
      completeness: 619.9 / 640 = 0.969
    correct cluster fractions:
       clusters uids
         127    640  true
          45    640  inferred
      purity:       241.1 / 640 = 0.377
      completeness: 619.9 / 640 = 0.969
      total time: 8.1
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --plot-annotation-performance --max-ccf-fail-frac 0.10 --is-simu --plotdir test/paired/new-results-slow/partition-new-simu-annotation-performance/single-chain/plots/igl --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/test/simu/igl.yaml --outfname test/paired/new-results-slow/partition-new-simu/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 355 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 355 / 355 v annotations (0 failed) with 10 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
      info for 355 / 355 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 72 (0.203) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 13 queries with different true and inferred net shm indel lengths: 6302753673530959145-igl 7274351964588328571-igl 6074591113755965332-igl 0748472840241894389-igl 3613294917954346973-igl 2198347140778209734-igl 7410197645865402313-igl 2910059741635412079-igl 8773180209828893303-igl 5641474851525436229-igl 4715405941622985518-igl 7698768102636357101-igl 2578535683205410191-igl
(0.0 sec)
        water time: 0.6
hmm
caching all 355 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 355        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  0.4 - 0.5 sec
      hmm step time: 0.6
    [93mwarning:[0m missing 2 queries from hmm cache file (using sw naive sequence instead): 5641474851525436229-igl 2198347140778209734-igl
   collapsed 355 queries into 31 clusters with identical naive seqs (0.0 sec)
31 clusters with 10 procs
       setting naive hfrac bounds: 0.015 0.062
    running 10 procs
          read from cache:  naive-seqs 353   logprobs   0
                    calcd:         vtb  10        fwd   0
                   merged:       hfrac   3     lratio   0
             min-max time:  0.0 - 0.1 sec
         infra time: 0.1
      hmm step time: 0.3
28 clusters with 7 procs
       naive hfrac bounds: 0.015 0.062
    running 7 procs
          read from cache:  naive-seqs 367   logprobs   0
                    calcd:         vtb   8        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.1 sec
         infra time: 0.1
      hmm step time: 0.3
28 clusters with 5 procs
       naive hfrac bounds: 0.015 0.062
    running 5 procs
          read from cache:  naive-seqs 376   logprobs   0
                    calcd:         vtb   5        fwd   0
                   merged:       hfrac   2     lratio   0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
26 clusters with 3 procs
       naive hfrac bounds: 0.015 0.062
    running 3 procs
          read from cache:  naive-seqs 383   logprobs   0
                    calcd:         vtb   3        fwd   0
                   merged:       hfrac   3     lratio   0
             min-max time:  0.0 - 0.2 sec
         infra time: 0.1
      hmm step time: 0.3
23 clusters with 2 procs
       naive hfrac bounds: 0.015 0.062
    running 2 procs
          read from cache:  naive-seqs 389   logprobs   0
                    calcd:         vtb   0        fwd   0
                   merged:       hfrac   1     lratio   0
             min-max time:  0.0 - 0.0 sec
      hmm step time: 0.1
22 clusters with 1 proc
       naive hfrac bounds: 0.015 0.062
    running 1 proc
          read from cache:  naive-seqs 390   logprobs   0
                    calcd:         vtb   2        fwd  27
                   merged:       hfrac   3     lratio   0
                     time:  0.7 sec
      hmm step time: 0.7
      loop time: 2.0
getting annotations for final partition
  subcluster annotating 19 clusters: 
    running 10 procs
                    calcd:         vtb 127        fwd   0
             min-max time:  0.4 - 0.4 sec
    reading output
        read 127 hmm output lines with 353 sequences in 125 events  (2 failures)
          [91mwarning[0m no valid paths: 5641474851525436229-igl 2198347140778209734-igl
         infra time: 0.3
      hmm step time: 0.8
    missing 2 annotations
      removing failed cluster for 2198347140778209734-igl:
      removing failed cluster for 5641474851525436229-igl:
    read 125 new subcluster annotations: added hashid 118   whole finished 7   subcl finished 0
    running 10 procs
                    calcd:         vtb  42        fwd   0
             min-max time:  0.2 - 0.2 sec
    reading output
        read 42 hmm output lines with 118 sequences in 42 events  (0 failures)
      hmm step time: 0.4
    read 42 new subcluster annotations: added hashid 42   whole finished 0   subcl finished 1
    running 10 procs
                    calcd:         vtb  16        fwd   0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 16 hmm output lines with 41 sequences in 16 events  (0 failures)
      hmm step time: 0.2
    read 16 new subcluster annotations: added hashid 16   whole finished 0   subcl finished 4
    running 6 procs
                    calcd:         vtb   6        fwd   0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 6 hmm output lines with 12 sequences in 6 events  (0 failures)
      hmm step time: 0.2
    read 6 new subcluster annotations: added hashid 6   whole finished 0   subcl finished 4
    running 1 proc
                    calcd:         vtb   1        fwd   0
                     time:  0.0 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 11 queries with different true and inferred net shm indel lengths: 7410197645865402313-igl 6302753673530959145-igl 7698768102636357101-igl 7274351964588328571-igl 8773180209828893303-igl 0748472840241894389-igl 2578535683205410191-igl 2910059741635412079-igl 3613294917954346973-igl 4715405941622985518-igl 6074591113755965332-igl
(0.0 sec)
    subcluster annotation time 2.0
    correct cluster fractions:
       clusters uids
          63    355  true
          31    355  inferred
      purity:       158.2 / 355 = 0.446
      completeness: 333.1 / 355 = 0.938
    correct cluster fractions:
       clusters uids
          63    355  true
          30    355  inferred
      purity:       156.8 / 355 = 0.442
      completeness: 333.1 / 355 = 0.938
    correct cluster fractions:
       clusters uids
          63    355  true
          29    355  inferred
      purity:       156.7 / 355 = 0.441
      completeness: 335.0 / 355 = 0.944
    correct cluster fractions:
       clusters uids
          63    355  true
          28    355  inferred
      purity:       154.9 / 355 = 0.436
      completeness: 335.0 / 355 = 0.944
    correct cluster fractions:
       clusters uids
          63    355  true
          27    355  inferred
      purity:       151.5 / 355 = 0.427
      completeness: 336.7 / 355 = 0.948
    correct cluster fractions:
       clusters uids
          63    355  true
          26    355  inferred
      purity:       145.5 / 355 = 0.410
      completeness: 336.7 / 355 = 0.948
    correct cluster fractions:
       clusters uids
          63    355  true
          25    355  inferred
      purity:       144.0 / 355 = 0.406
      completeness: 336.7 / 355 = 0.948
    correct cluster fractions:
       clusters uids
          63    355  true
          24    355  inferred
      purity:       136.3 / 355 = 0.384
      completeness: 336.7 / 355 = 0.948
    correct cluster fractions:
       clusters uids
          63    355  true
          23    355  inferred
      purity:       131.9 / 355 = 0.372
      completeness: 336.7 / 355 = 0.948
    correct cluster fractions:
       clusters uids
          63    355  true
          22    355  inferred
      purity:       129.9 / 355 = 0.366
      completeness: 339.7 / 355 = 0.957
    correct cluster fractions:
       clusters uids
          63    355  true
          21    355  inferred
      purity:       124.4 / 355 = 0.350
      completeness: 341.4 / 355 = 0.962
    correct cluster fractions:
       clusters uids
          63    355  true
          20    355  inferred
      purity:       122.2 / 355 = 0.344
      completeness: 341.4 / 355 = 0.962
    correct cluster fractions:
       clusters uids
          63    355  true
          19    355  inferred
      purity:       110.2 / 355 = 0.310
      completeness: 341.4 / 355 = 0.962
      total time: 5.6
[44mcombining[0m chains
      removed 2 failed queries when reading partition: 5641474851525436229-igl 2198347140778209734-igl
   cleaning pair info for 1993 seqs
   5/1993 (0.00) missing uids when cleaning pair info
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
    truncating x bins 3 --> 12 and ybins 5 --> 12
    truncating x bins 6 --> 15 and ybins 16 --> 15
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:  230 total unpaired,  [94mh[0m 144  [95mk[0m 86
    merging igh+igk partitions
   N clusters without bad/unpaired seqs:
        [94mh[0m  123 --> 174  [91m+51[0m
        [95mk[0m   43 --> 174  [91m+131[0m
    re-added unpaired seqs ([94mh[0m 144, [95mk[0m 86) to give total seqs in joint partitions: [94mh[0m 698  [95mk[0m 640
    [94mh[0m single correct cluster fractions:
       clusters uids
         193    1000  true
         183    1000  inferred
      purity:       807.3 / 1000 = 0.807
      completeness: 900.7 / 1000 = 0.901
    [93mwarning[0m removed 13/641 uids (leaving 628) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 50 / 698 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 20 / 698 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
    [94mh[0m joint correct cluster fractions:
       clusters uids
         197    698  true
         212    698  inferred
      purity:       646.4 / 698 = 0.926
      completeness: 605.9 / 698 = 0.868
  [94mh[0m ccfs:     purity  completeness
      single   0.807  0.901
       joint   0.926  0.868
    [95mk[0m single correct cluster fractions:
       clusters uids
         127    640  true
          47    640  inferred
      purity:       256.0 / 640 = 0.400
      completeness: 619.9 / 640 = 0.969
    [95mk[0m joint correct cluster fractions:
       clusters uids
         127    640  true
         178    640  inferred
      purity:       562.4 / 640 = 0.879
      completeness: 489.1 / 640 = 0.764
  [95mk[0m ccfs:     purity  completeness
      single   0.400  0.969
       joint   0.879  0.764
  merge time 0.0
  need to get annotations for 180/212 joint igh clusters
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igh.yaml --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 698 sequences from test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igh.yaml: paired-uids loci
  --input-partition-fname: read best partition with 698 sequences in 212 clusters from test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 698 / 698 v annotations (0 failed) with 23 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 698 / 698 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 255 (0.365) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3203122467716491719-igh': [[u'3203122467716491719-igk', u'1800142422104931270-igk', u'1800142422104931270-igh']] --> [[u'3203122467716491719-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3926493268827655903-igh': [[u'3926493268827655903-igk', u'0457245606032802788-igl', u'0457245606032802788-igh']] --> [[u'3926493268827655903-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5171128168862809856-igh': [[u'5171128168862809856-igk', u'4980246375282440960-igk']] --> [[u'5171128168862809856-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '6104752918040511656-igh': [[u'1767611730716028444-igl', u'1767611730716028444-igh', u'6104752918040511656-igk']] --> [[u'6104752918040511656-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '2600239806918866386-igh': [[u'2600239806918866386-igk', u'2790800398366108747-igl', u'2790800398366108747-igh']] --> [[u'2600239806918866386-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3590463765566689509-igh': [[u'2838638195647889098-igk', u'2838638195647889098-igh', u'3590463765566689509-igk']] --> [[u'3590463765566689509-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3810492694341242408-igh': [[u'3810492694341242408-igk', u'1850131945780139389-igk', u'1850131945780139389-igh']] --> [[u'3810492694341242408-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3689563389420056256-igh': [[u'3689563389420056256-igk', u'1682788086367546172-igh', u'1682788086367546172-igk']] --> [[u'3689563389420056256-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3320869507417607437-igh': [[u'0376400657424705652-igh']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '0039784956805267814-igh': [[u'7688800932718159958-igh', u'7688800932718159958-igk']] --> [[u'7688800932718159958-igk']]
[93mwarning[0m replaced input metafo for 1 total key in 448 seqs (448 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
                    loci        0      698        0      698        0        0
             paired-uids        0      698        0      250        0      448
        water time: 0.3
hmm
  subcluster annotating 212 clusters: 
    running 10 procs
                    calcd:         vtb 332        fwd   0
             min-max time:  0.9 - 1.2 sec
    reading output
        read 332 hmm output lines with 698 sequences in 332 events  (0 failures)
         infra time: 0.3
      hmm step time: 1.5
    read 332 new subcluster annotations: added hashid 185   whole finished 147   subcl finished 0
    running 10 procs
                    calcd:         vtb  81        fwd   0
             min-max time:  0.3 - 0.5 sec
    reading output
        read 81 hmm output lines with 185 sequences in 81 events  (0 failures)
      hmm step time: 0.6
    read 81 new subcluster annotations: added hashid 81   whole finished 0   subcl finished 51
    running 10 procs
                    calcd:         vtb  15        fwd   0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 15 hmm output lines with 30 sequences in 15 events  (0 failures)
      hmm step time: 0.3
    read 15 new subcluster annotations: added hashid 15   whole finished 0   subcl finished 13
    running 1 proc
                    calcd:         vtb   1        fwd   0
                     time:  0.2 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.2
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 2.8
      total time: 3.4
  need to get annotations for 170/178 joint igk clusters
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igk.yaml --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
  --input-metafnames: added meta info for 640 sequences from test/paired/new-results-slow/partition-new-simu/igh+igk/meta-igk.yaml: paired-uids loci
  --input-partition-fname: read best partition with 640 sequences in 178 clusters from test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 640 / 640 v annotations (0 failed) with 16 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 640 / 640 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 104 (0.163) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3203122467716491719-igk': [[u'3203122467716491719-igh', u'1800142422104931270-igk', u'1800142422104931270-igh']] --> [[u'3203122467716491719-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3926493268827655903-igk': [[u'3926493268827655903-igh', u'0457245606032802788-igl', u'0457245606032802788-igh']] --> [[u'3926493268827655903-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5171128168862809856-igk': [[u'5171128168862809856-igh', u'4980246375282440960-igk']] --> [[u'5171128168862809856-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '6104752918040511656-igk': [[u'1767611730716028444-igl', u'1767611730716028444-igh', u'6104752918040511656-igh']] --> [[u'6104752918040511656-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '2600239806918866386-igk': [[u'2600239806918866386-igh', u'2790800398366108747-igl', u'2790800398366108747-igh']] --> [[u'2600239806918866386-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3590463765566689509-igk': [[u'2838638195647889098-igk', u'2838638195647889098-igh', u'3590463765566689509-igh']] --> [[u'3590463765566689509-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3810492694341242408-igk': [[u'3810492694341242408-igh', u'1850131945780139389-igk', u'1850131945780139389-igh']] --> [[u'3810492694341242408-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3689563389420056256-igk': [[u'3689563389420056256-igh', u'1682788086367546172-igh', u'1682788086367546172-igk']] --> [[u'3689563389420056256-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '7688800932718159958-igk': [[u'0039784956805267814-igh', u'7688800932718159958-igh']] --> [[u'0039784956805267814-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '4770667836393603298-igk': [[u'4770667836393603298-igh', u'3842435962583128456-igk']] --> [[u'4770667836393603298-igh']]
[93mwarning[0m replaced input metafo for 1 total key in 410 seqs (410 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
                    loci        0      640        0      640        0        0
             paired-uids        0      640        0      230        0      410
        water time: 0.2
hmm
  [93mwarning[0m split apart 3 clusters that contained multiple cdr3 lengths (total clusters: 178 --> 183)
      cluster splits:   2 --> 1 1,   6 --> 1 1 4,   6 --> 1 3 2
  subcluster annotating 183 clusters: 
    running 10 procs
                    calcd:         vtb 301        fwd   0
             min-max time:  0.5 - 0.7 sec
    reading output
        read 301 hmm output lines with 640 sequences in 301 events  (0 failures)
         infra time: 0.6
      hmm step time: 1.3
    read 301 new subcluster annotations: added hashid 179   whole finished 122   subcl finished 0
    running 10 procs
                    calcd:         vtb  78        fwd   0
             min-max time:  0.2 - 0.3 sec
    reading output
        read 78 hmm output lines with 179 sequences in 78 events  (0 failures)
      hmm step time: 0.5
    read 78 new subcluster annotations: added hashid 78   whole finished 0   subcl finished 47
    running 10 procs
                    calcd:         vtb  15        fwd   0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 15 hmm output lines with 31 sequences in 15 events  (0 failures)
      hmm step time: 0.2
    read 15 new subcluster annotations: added hashid 15   whole finished 0   subcl finished 13
    running 1 proc
                    calcd:         vtb   1        fwd   0
                     time:  0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 2.2
      total time: 2.6
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:  195 total unpaired,  [94mh[0m 144  [92ml[0m 51
    merging igh+igl partitions
   N clusters without bad/unpaired seqs:
        [94mh[0m   73 --> 90   [91m+17[0m
        [92ml[0m   14 --> 90   [91m+76[0m
    re-added unpaired seqs ([94mh[0m 144, [92ml[0m 51) to give total seqs in joint partitions: [94mh[0m 446  [92ml[0m 353
    [94mh[0m single correct cluster fractions:
       clusters uids
         193    1000  true
         183    1000  inferred
      purity:       807.3 / 1000 = 0.807
      completeness: 900.7 / 1000 = 0.901
    [93mwarning[0m removed 20/359 uids (leaving 339) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 94 / 446 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 13 / 446 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
    [94mh[0m joint correct cluster fractions:
       clusters uids
         172    446  true
         151    446  inferred
      purity:       381.8 / 446 = 0.856
      completeness: 384.3 / 446 = 0.862
  [94mh[0m ccfs:     purity  completeness
      single   0.807  0.901
       joint   0.856  0.862
    [93mwarning[0m removed 2/355 uids (leaving 353) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [92ml[0m single correct cluster fractions:
       clusters uids
          63    353  true
          17    353  inferred
      purity:       108.2 / 353 = 0.306
      completeness: 342.9 / 353 = 0.971
    [93mwarning[0m removed 2/355 uids (leaving 353) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [92ml[0m joint correct cluster fractions:
       clusters uids
          63    353  true
          93    353  inferred
      purity:       307.1 / 353 = 0.870
      completeness: 255.1 / 353 = 0.723
  [92ml[0m ccfs:     purity  completeness
      single   0.306  0.971
       joint   0.870  0.723
  merge time 0.0
  need to get annotations for 125/151 joint igh clusters
[44mannotate[0m [94migh+igl[0m:[94m igh[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igl/input-seqs-igh.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igh.yaml --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 446 sequences from test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igh.yaml: paired-uids loci
  --input-partition-fname: read best partition with 446 sequences in 151 clusters from test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 446 / 446 v annotations (0 failed) with 22 v genes in 0.2 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 446 / 446 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 161 (0.361) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '4489787302060078124-igh': [[u'1127310571846829490-igh', u'1127310571846829490-igl', u'4489787302060078124-igl']] --> [[u'4489787302060078124-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '0526793195386432815-igh': [[u'0960715752824823700-igh', u'0526793195386432815-igl']] --> [[u'0526793195386432815-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '1016518942290416082-igh': [[u'4668341497387149342-igk', u'1016518942290416082-igl']] --> [[u'1016518942290416082-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '0078203303789609435-igh': [[u'1088749980415660516-igk', u'1088749980415660516-igh', u'0078203303789609435-igk']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '1210468314540944688-igh': [[u'9175183096912948842-igh']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '2911453726728538363-igh': [[u'0531663798372164401-igh', u'0531663798372164401-igk']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '1123081631537330843-igh': [[u'0605436960283742311-igh', u'0605436960283742311-igl', u'1123081631537330843-igl']] --> [[u'1123081631537330843-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '7317912441508657964-igh': [[u'7317912441508657964-igl', u'3106904650086857185-igh', u'3106904650086857185-igl']] --> [[u'7317912441508657964-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '6865046041316352084-igh': [[u'6865046041316352084-igk', u'7274351964588328571-igh', u'7274351964588328571-igl']] --> [[u'7274351964588328571-igl']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5215778925768629320-igh': [[u'4712143646854863322-igk', u'4712143646854863322-igh', u'5215778925768629320-igl']] --> [[u'5215778925768629320-igl']]
[93mwarning[0m replaced input metafo for 1 total key in 282 seqs (282 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
                    loci        0      446        0      446        0        0
             paired-uids        0      446        0      164        0      282
        water time: 0.2
hmm
  subcluster annotating 151 clusters: 
    running 10 procs
                    calcd:         vtb 219        fwd   0
             min-max time:  0.6 - 0.8 sec
    reading output
        read 219 hmm output lines with 446 sequences in 219 events  (0 failures)
         infra time: 0.2
      hmm step time: 1.1
    read 219 new subcluster annotations: added hashid 100   whole finished 119   subcl finished 0
    running 10 procs
                    calcd:         vtb  44        fwd   0
             min-max time:  0.3 - 0.4 sec
    reading output
        read 44 hmm output lines with 100 sequences in 44 events  (0 failures)
      hmm step time: 0.5
    read 44 new subcluster annotations: added hashid 44   whole finished 0   subcl finished 22
    running 10 procs
                    calcd:         vtb  10        fwd   0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 10 hmm output lines with 22 sequences in 10 events  (0 failures)
      hmm step time: 0.3
    read 10 new subcluster annotations: added hashid 10   whole finished 0   subcl finished 10
    subcluster annotation time 2.0
      total time: 2.4
  need to get annotations for 90/93 joint igl clusters
[44mannotate[0m [94migh+igl[0m:[94m igl[0m
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/partition-new-simu/igh+igl/input-seqs-igl.fa --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igl.yaml --input-partition-fname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
  --input-metafnames: added meta info for 353 sequences from test/paired/new-results-slow/partition-new-simu/igh+igl/meta-igl.yaml: paired-uids loci
  --input-partition-fname: read best partition with 353 sequences in 93 clusters from test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 353 / 353 v annotations (0 failed) with 10 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
      info for 353 / 353 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 70 (0.198) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '4489787302060078124-igl': [[u'1127310571846829490-igh', u'1127310571846829490-igl', u'4489787302060078124-igh']] --> [[u'4489787302060078124-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '0526793195386432815-igl': [[u'0526793195386432815-igh', u'0960715752824823700-igh']] --> [[u'0526793195386432815-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '1016518942290416082-igl': [[u'4668341497387149342-igk', u'1016518942290416082-igh']] --> [[u'1016518942290416082-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '1123081631537330843-igl': [[u'0605436960283742311-igh', u'0605436960283742311-igl', u'1123081631537330843-igh']] --> [[u'1123081631537330843-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '7317912441508657964-igl': [[u'7317912441508657964-igh', u'3106904650086857185-igh', u'3106904650086857185-igl']] --> [[u'7317912441508657964-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '0840800137072506659-igl': [[u'2609589689827582429-igh', u'2609589689827582429-igk']] --> [[]]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '7274351964588328571-igl': [[u'6865046041316352084-igk', u'6865046041316352084-igh', u'7274351964588328571-igh']] --> [[u'6865046041316352084-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5215778925768629320-igl': [[u'4712143646854863322-igk', u'4712143646854863322-igh', u'5215778925768629320-igh']] --> [[u'5215778925768629320-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5971731437698957774-igl': [[u'5971731437698957774-igh', u'0676866336679508987-igh', u'0676866336679508987-igk']] --> [[u'5971731437698957774-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3412037317265416968-igl': [[u'3412037317265416968-igh', u'3772548365632771450-igh', u'3772548365632771450-igk']] --> [[u'3772548365632771450-igh']]
[93mwarning[0m replaced input metafo for 1 total key in 225 seqs (225 clusters): paired-uids (see above, only printed the first 10 clusters)
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
                    loci        0      353        0      353        0        0
             paired-uids        0      353        0      128        0      225
        water time: 0.1
hmm
  [93mwarning[0m split apart 2 clusters that contained multiple cdr3 lengths (total clusters: 93 --> 95)
      cluster splits:   9 --> 8 1,   2 --> 1 1
  subcluster annotating 95 clusters: 
    running 10 procs
                    calcd:         vtb 162        fwd   0
             min-max time:  0.3 - 0.4 sec
    reading output
        read 162 hmm output lines with 353 sequences in 162 events  (0 failures)
         infra time: 0.3
      hmm step time: 0.8
    read 162 new subcluster annotations: added hashid 99   whole finished 63   subcl finished 0
    running 10 procs
                    calcd:         vtb  42        fwd   0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 42 hmm output lines with 99 sequences in 42 events  (0 failures)
      hmm step time: 0.3
    read 42 new subcluster annotations: added hashid 42   whole finished 0   subcl finished 25
    running 7 procs
                    calcd:         vtb   7        fwd   0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 7 hmm output lines with 17 sequences in 7 events  (0 failures)
      hmm step time: 0.1
    read 7 new subcluster annotations: added hashid 7   whole finished 0   subcl finished 7
    subcluster annotation time 1.3
      total time: 1.6
    correct cluster fractions:
       clusters uids
         193    1000  true
         302    1000  inferred
      purity:       951.3 / 1000 = 0.951
      completeness: 754.8 / 1000 = 0.755
[91mrun[0m cd test/paired/new-results-slow/partition-new-simu && ln -sf igh+igk/partition-igk.yaml partition-igk.yaml
[91mrun[0m cd test/paired/new-results-slow/partition-new-simu && ln -sf igh+igl/partition-igl.yaml partition-igl.yaml
   N clusters with all seqs:
        [94mh[0m  183 --> 302  [91m+119[0m
        [95mk[0m   47 --> 178  [91m+131[0m
        [92ml[0m   17 --> 93   [91m+76[0m
  [93mwarning[0m ignoring --plot-annotation-performance for paired clustering since it's going to be a bit fiddly to implement
      total time: 61.0
[92mseed-partition-new-simu[0m          /home/dralph/work/partis/bin/partis partition --dont-write-git-info --paired-loci --paired-indir test/paired/new-results-slow/test/simu --parameter-dir test/paired/new-results-slow/test/parameters/simu --max-ccf-fail-frac 0.10 --is-simu --seed-unique-id 0515260043455636484-igh:0515260043455636484-igk --seed-loci igh:igk --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/seed-partition-new-simu
   removing seqs very different from seed seq
                           wrong/no     removed      singly         kept   missing
           locus  before   pairing    cdr3  hfrac    added   after  frac   true ids
             [94mh[0m     1000      806       171    16       10      17   0.017    [91m1[0m
             [95mk[0m      640      446       171    16       29      36   0.056    [91m1[0m
     adding seqs paired with uids we kept
           locus  before  added  after  kept frac
             [94mh[0m      17      41     58    0.058
             [95mk[0m      36      16     52    0.081
             [92ml[0m       0      10     10    0.028
      taken 53, paired with taken 67 (total 120)
[44mpartition[0m [94migh[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/single-chain/input-seqs-igh.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/single-chain/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 58 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 58 / 58 v annotations (0 failed) with 12 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 58 / 58 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 17 (0.293) unproductive
        water time: 0.1
hmm
caching all 58 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 58        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.2 - 0.4 sec
      hmm step time: 0.4
   collapsed 58 queries into 36 clusters with identical naive seqs (0.0 sec)
36 clusters with 10 procs
       setting naive hfrac bounds: 0.015 0.064
    running 10 procs
          read from cache:  naive-seqs 58   logprobs  0
                    calcd:         vtb  1        fwd  3
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
36 clusters with 7 procs
       naive hfrac bounds: 0.015 0.064
    running 7 procs
          read from cache:  naive-seqs 59   logprobs  3
                    calcd:         vtb  2        fwd  0
                   merged:       hfrac  1     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
35 clusters with 5 procs
       naive hfrac bounds: 0.015 0.064
    running 5 procs
          read from cache:  naive-seqs 61   logprobs  3
                    calcd:         vtb  2        fwd  9
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.2 sec
      hmm step time: 0.2
35 clusters with 3 procs
       naive hfrac bounds: 0.015 0.064
    running 3 procs
          read from cache:  naive-seqs 63   logprobs 12
                    calcd:         vtb  2        fwd 13
                   merged:       hfrac  1     lratio  0
             min-max time:  0.1 - 0.3 sec
      hmm step time: 0.4
34 clusters with 2 procs
       naive hfrac bounds: 0.015 0.064
    running 2 procs
          read from cache:  naive-seqs 65   logprobs 25
                    calcd:         vtb  1        fwd  0
                   merged:       hfrac  1     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
33 clusters with 1 proc
       naive hfrac bounds: 0.015 0.064
    running 1 proc
          read from cache:  naive-seqs 66   logprobs 25
                    calcd:         vtb  1        fwd 21
                   merged:       hfrac  1     lratio  0
                     time:  0.7 sec
      hmm step time: 0.7
      loop time: 1.9
getting annotations for final partition
  subcluster annotating 32 clusters: 
    running 10 procs
                    calcd:         vtb 38        fwd  0
             min-max time:  0.2 - 0.3 sec
    reading output
        read 38 hmm output lines with 58 sequences in 38 events  (0 failures)
      hmm step time: 0.4
    read 38 new subcluster annotations: added hashid 8   whole finished 30   subcl finished 0
    running 3 procs
                    calcd:         vtb  3        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 3 hmm output lines with 8 sequences in 3 events  (0 failures)
      hmm step time: 0.1
    read 3 new subcluster annotations: added hashid 3   whole finished 0   subcl finished 1
    running 1 proc
                    calcd:         vtb  1        fwd  0
                     time:  0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.7
      total time: 3.2
[44mpartition[0m [94migk[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/single-chain/input-seqs-igk.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/single-chain/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 52 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 52 / 52 v annotations (0 failed) with 11 v genes in 0.1 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 52 / 52 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 11 (0.212) unproductive
        water time: 0.1
hmm
caching all 52 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 52        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.1 - 0.2 sec
      hmm step time: 0.2
   collapsed 52 queries into 15 clusters with identical naive seqs (0.0 sec)
15 clusters with 10 procs
       setting naive hfrac bounds: 0.015 0.060
    running 10 procs
          read from cache:  naive-seqs 52   logprobs  0
                    calcd:         vtb  2        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
15 clusters with 7 procs
       naive hfrac bounds: 0.015 0.060
    running 7 procs
          read from cache:  naive-seqs 55   logprobs  0
                    calcd:         vtb  1        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
15 clusters with 5 procs
       naive hfrac bounds: 0.015 0.060
    running 5 procs
          read from cache:  naive-seqs 56   logprobs  0
                    calcd:         vtb  0        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/78972/hmm_cached_info.csv
      hmm step time: 0.1
15 clusters with 3 procs
       naive hfrac bounds: 0.015 0.060
    running 3 procs
          read from cache:  naive-seqs 56   logprobs  0
                    calcd:         vtb  0        fwd  3
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
15 clusters with 2 procs
       naive hfrac bounds: 0.015 0.060
    running 2 procs
          read from cache:  naive-seqs 56   logprobs  3
                    calcd:         vtb  1        fwd  3
                   merged:       hfrac  1     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
14 clusters with 1 proc
       naive hfrac bounds: 0.015 0.060
    running 1 proc
          read from cache:  naive-seqs 57   logprobs  6
                    calcd:         vtb  0        fwd 10
                   merged:       hfrac  0     lratio  0
                     time:  0.4 sec
      hmm step time: 0.4
      loop time: 1.3
getting annotations for final partition
  subcluster annotating 14 clusters: 
    running 10 procs
                    calcd:         vtb 25        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 25 hmm output lines with 52 sequences in 25 events  (0 failures)
         infra time: 0.1
      hmm step time: 0.3
    read 25 new subcluster annotations: added hashid 12   whole finished 13   subcl finished 0
    running 4 procs
                    calcd:         vtb  4        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 4 hmm output lines with 12 sequences in 4 events  (0 failures)
      hmm step time: 0.1
    read 4 new subcluster annotations: added hashid 4   whole finished 0   subcl finished 0
    running 2 procs
                    calcd:         vtb  2        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 2 hmm output lines with 4 sequences in 2 events  (0 failures)
      hmm step time: 0.1
    read 2 new subcluster annotations: added hashid 2   whole finished 0   subcl finished 0
    running 1 proc
                    calcd:         vtb  1        fwd  0
                     time:  0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.7
      total time: 2.3
[44mpartition[0m [94migl[0m:
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis partition --locus igl --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igl --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/single-chain/input-seqs-igl.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/single-chain/partition-igl.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml --input-metafnames test/paired/new-results-slow/test/simu/meta.yaml
  --input-metafnames: added meta info for 10 sequences from test/paired/new-results-slow/test/simu/meta.yaml: paired-uids loci
partitioning     (with test/paired/new-results-slow/test/parameters/simu/igl/hmm)
smith-waterman
  vsearch: 10 / 10 v annotations (0 failed) with 5 v genes in 0.0 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igl/sw-cache.yaml
      info for 10 / 10 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 2 (0.200) unproductive
        water time: 0.0
hmm
caching all 10 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 10        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.1 - 0.1 sec
      hmm step time: 0.2
   collapsed 10 queries into 6 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 6
6 clusters with 6 procs
       setting naive hfrac bounds: 0.015 0.062
    running 6 procs
          read from cache:  naive-seqs 10   logprobs  0
                    calcd:         vtb  0        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/509944/hmm_cached_info.csv
      hmm step time: 0.1
6 clusters with 4 procs
       naive hfrac bounds: 0.015 0.062
    running 4 procs
          read from cache:  naive-seqs 10   logprobs  0
                    calcd:         vtb  0        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/509944/hmm_cached_info.csv
      hmm step time: 0.1
6 clusters with 3 procs
       naive hfrac bounds: 0.015 0.062
    running 3 procs
          read from cache:  naive-seqs 10   logprobs  0
                    calcd:         vtb  1        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.1
6 clusters with 2 procs
       naive hfrac bounds: 0.015 0.062
    running 2 procs
          read from cache:  naive-seqs 11   logprobs  0
                    calcd:         vtb  2        fwd  0
                   merged:       hfrac  1     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.1
5 clusters with 1 proc
       naive hfrac bounds: 0.015 0.062
    running 1 proc
          read from cache:  naive-seqs 13   logprobs  0
                    calcd:         vtb  0        fwd  5
                   merged:       hfrac  0     lratio  0
                     time:  0.2 sec
      hmm step time: 0.2
      loop time: 0.7
getting annotations for final partition
  subcluster annotating 5 clusters: 
    running 6 procs
                    calcd:         vtb  6        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 6 hmm output lines with 10 sequences in 6 events  (0 failures)
      hmm step time: 0.2
    read 6 new subcluster annotations: added hashid 2   whole finished 4   subcl finished 0
    running 1 proc
                    calcd:         vtb  1        fwd  0
                     time:  0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.3
      total time: 1.2
[44mcombining[0m chains
   cleaning pair info for 120 seqs
     synchronized/fixed 0 pairs where one had no pair info after cleaning: [94mh[0m 0  [95mk[0m 0  [92ml[0m 0
[94migh+igk[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:  21 total unpaired,  [94mh[0m 11  [95mk[0m 10
    merging igh+igk partitions
   N clusters without bad/unpaired seqs:
        [94mh[0m   18 --> 20   [91m+2[0m
        [95mk[0m    8 --> 20   [91m+12[0m
    re-added unpaired seqs ([94mh[0m 11, [95mk[0m 10) to give total seqs in joint partitions: [94mh[0m 53  [95mk[0m 52
    [93mwarning[0m removed 942/1000 uids (leaving 58) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [94mh[0m single correct cluster fractions:
       clusters uids
          34     58  true
          32     58  inferred
      purity:       1.0 / 1 = 1.000
      completeness: 1.0 / 1 = 1.000
    [93mwarning[0m removed 594/641 uids (leaving 47) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [93mwarning[0m added 4 / 53 missing ids as singletons to true partition, to match ids in inferred partition (restricting to unpaired_uids, i.e. probably these were unpaired seqs that were re-added to the inferred partition, but in the true partition were paired with the other chain)
    [93mwarning[0m added 2 / 53 missing ids as singletons to true partition, to match ids in inferred partition (giving up and adding whatever is needed, which is sometimes/maybe just from mispaired seqs)
    [94mh[0m joint correct cluster fractions:
       clusters uids
          31     53  true
          31     53  inferred
      purity:       1.0 / 1 = 1.000
      completeness: 1.0 / 1 = 1.000
  [94mh[0m ccfs:     purity  completeness
      single   1.000  1.000
       joint   1.000  1.000
    [93mwarning[0m removed 588/640 uids (leaving 52) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [95mk[0m single correct cluster fractions:
       clusters uids
          22     52  true
          14     52  inferred
      purity:       0.5 / 1 = 0.500
      completeness: 1.0 / 1 = 1.000
    [93mwarning[0m removed 588/640 uids (leaving 52) from true partition that were not in inferred partition (probably either seqs that failed inference [if light chain] or mispaired seqs [if heavy chain])
    [95mk[0m joint correct cluster fractions:
       clusters uids
          22     52  true
          26     52  inferred
      purity:       1.0 / 1 = 1.000
      completeness: 0.8 / 1 = 0.778
  [95mk[0m ccfs:     purity  completeness
      single   0.500  1.000
       joint   1.000  0.778
  merge time 0.0
     removed 30 unseeded clusters (of 31 total, leaving 1) from igh joint partition
  need to get annotations for 1/1 joint igh clusters
  seed cluster size in best joint partition: 14, excluding seed seq: 13
[44mannotate[0m [94migh+igk[0m:[94m igh[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id 0515260043455636484-igh:0515260043455636484-igk
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igh --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igh --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/igh+igk/input-seqs-igh.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/igh+igk/partition-igh.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml --input-metafnames test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/igh+igk/meta-igh.yaml --input-partition-fname test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/igh+igk/partition-igh-only-partition.yaml
  --input-metafnames: added meta info for 14 sequences from test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/igh+igk/meta-igh.yaml: paired-uids loci
  --input-partition-fname: read best partition with 14 sequences in 1 clusters from test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/igh+igk/partition-igh-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igh/hmm)
smith-waterman
  vsearch: 14 / 14 v annotations (0 failed) with 1 v gene in 0.0 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igh/sw-cache.yaml
      info for 14 / 14 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 3 (0.214) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '9220592361438166583-igh': [[u'6967432317848122439-igk', u'9220592361438166583-igk']] --> [[u'9220592361438166583-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5985384172875489319-igh': [[u'5985384172875489319-igk', u'5658992323217208152-igh', u'5658992323217208152-igk']] --> [[u'5985384172875489319-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3800059541212012373-igh': [[u'5735323184917054667-igl', u'5735323184917054667-igh', u'3800059541212012373-igk']] --> [[u'3800059541212012373-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '2975541313160084247-igh': [[u'2975541313160084247-igk', u'9205266174301842569-igh', u'9205266174301842569-igk']] --> [[u'2975541313160084247-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '8776025731513881660-igh': [[u'0211874598203745598-igh', u'8776025731513881660-igk']] --> [[u'8776025731513881660-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3410818562608101963-igh': [[u'7189484199558430500-igh', u'3410818562608101963-igk']] --> [[u'3410818562608101963-igk']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '4961183970982078756-igh': [[u'6728873402175495209-igh', u'6728873402175495209-igk', u'4961183970982078756-igk']] --> [[u'4961183970982078756-igk']]
[93mwarning[0m replaced input metafo for 1 total key in 7 seqs (7 clusters): paired-uids
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
                    loci        0       14        0       14        0        0
             paired-uids        0       14        0        7        0        7
        water time: 0.1
hmm
  subcluster annotating 1 cluster: 
    running 5 procs
                    calcd:         vtb  5        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 5 hmm output lines with 14 sequences in 5 events  (0 failures)
      hmm step time: 0.2
    read 5 new subcluster annotations: added hashid 5   whole finished 0   subcl finished 0
    running 2 procs
                    calcd:         vtb  2        fwd  0
             min-max time:  0.1 - 0.1 sec
    reading output
        read 2 hmm output lines with 5 sequences in 2 events  (0 failures)
      hmm step time: 0.1
    read 2 new subcluster annotations: added hashid 2   whole finished 0   subcl finished 0
    running 1 proc
                    calcd:         vtb  1        fwd  0
                     time:  0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.4
      total time: 0.6
     removed 25 unseeded clusters (of 26 total, leaving 1) from igk joint partition
  need to get annotations for 1/1 joint igk clusters
  seed cluster size in best joint partition: 14, excluding seed seq: 13
[44mannotate[0m [94migh+igk[0m:[94m igk[0m
    removed 2 arg strs that were specific to action 'partition': --seed-unique-id 0515260043455636484-igh:0515260043455636484-igk
  note: adding input metafname from default location (test/paired/new-results-slow/test/simu/meta.yaml)
[91mrun[0m /home/dralph/work/partis/bin/partis annotate --locus igk --dont-write-git-info --parameter-dir test/paired/new-results-slow/test/parameters/simu/igk --max-ccf-fail-frac 0.10 --random-seed 1 --n-procs 10 --refuse-to-cache-parameters --infname test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/igh+igk/input-seqs-igk.fa --outfname test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/igh+igk/partition-igk.yaml --sw-cachefname test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml --input-metafnames test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/igh+igk/meta-igk.yaml --input-partition-fname test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/igh+igk/partition-igk-only-partition.yaml
  --input-metafnames: added meta info for 14 sequences from test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/igh+igk/meta-igk.yaml: paired-uids loci
  --input-partition-fname: read best partition with 14 sequences in 1 clusters from test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk/igh+igk/partition-igk-only-partition.yaml
annotating    (with test/paired/new-results-slow/test/parameters/simu/igk/hmm)
smith-waterman
  vsearch: 14 / 14 v annotations (0 failed) with 1 v gene in 0.0 sec
        reading sw results from test/paired/new-results-slow/test/parameters/simu/igk/sw-cache.yaml
      info for 14 / 14 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 6 (0.429) unproductive
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '9220592361438166583-igk': [[u'6967432317848122439-igk', u'9220592361438166583-igh']] --> [[u'9220592361438166583-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '5985384172875489319-igk': [[u'5985384172875489319-igh', u'5658992323217208152-igh', u'5658992323217208152-igk']] --> [[u'5985384172875489319-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3800059541212012373-igk': [[u'5735323184917054667-igl', u'5735323184917054667-igh', u'3800059541212012373-igh']] --> [[u'3800059541212012373-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '2975541313160084247-igk': [[u'2975541313160084247-igh', u'9205266174301842569-igh', u'9205266174301842569-igk']] --> [[u'2975541313160084247-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '8776025731513881660-igk': [[u'8776025731513881660-igh', u'0211874598203745598-igh']] --> [[u'8776025731513881660-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '3410818562608101963-igk': [[u'3410818562608101963-igh', u'7189484199558430500-igh']] --> [[u'3410818562608101963-igh']]
  [93mwarning[0m replacing input metafo 'paired-uids' value for 1 seq cluster '4961183970982078756-igk': [[u'6728873402175495209-igh', u'6728873402175495209-igk', u'4961183970982078756-igh']] --> [[u'4961183970982078756-igh']]
[93mwarning[0m replaced input metafo for 1 total key in 7 seqs (7 clusters): paired-uids
  add_input_metafo(): transferring input metafo from <input_info> to <line> (counts in table are uids, not lines)
                            no-info  with-info  one-src ident. not-overwr. replaced
                    loci        0       14        0       14        0        0
             paired-uids        0       14        0        7        0        7
        water time: 0.1
hmm
  subcluster annotating 1 cluster: 
    running 5 procs
                    calcd:         vtb  5        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 5 hmm output lines with 14 sequences in 5 events  (0 failures)
      hmm step time: 0.2
    read 5 new subcluster annotations: added hashid 5   whole finished 0   subcl finished 0
    running 2 procs
                    calcd:         vtb  2        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 2 hmm output lines with 5 sequences in 2 events  (0 failures)
      hmm step time: 0.1
    read 2 new subcluster annotations: added hashid 2   whole finished 0   subcl finished 0
    running 1 proc
                    calcd:         vtb  1        fwd  0
                     time:  0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.4
      total time: 0.5
[94migh+igl[0m: synchronizing heavy and light chain cluster paths
    removing badly paired seqs:  16 total unpaired,  [94mh[0m 11  [92ml[0m 5
    merging igh+igl partitions
   N clusters without bad/unpaired seqs:
        [94mh[0m    4 --> 4   
        [92ml[0m    2 --> 4    [91m+2[0m
    re-added unpaired seqs ([94mh[0m 11, [92ml[0m 5) to give total seqs in joint partitions: [94mh[0m 16  [92ml[0m 10
  merge time 0.0
     removed 15 unseeded clusters (of 15 total, leaving 0) from igh joint partition
     removed 7 unseeded clusters (of 7 total, leaving 0) from igl joint partition
    correct cluster fractions:
       clusters uids
           1     15  true
           2     15  inferred
      purity:       1.0 / 1 = 1.000
      completeness: 0.9 / 1 = 0.933
[91mrun[0m cd test/paired/new-results-slow/seed-partition-new-simu/seeds/0515260043455636484-igh+0515260043455636484-igk && ln -sf igh+igk/partition-igk.yaml partition-igk.yaml
   N clusters with all seqs:
        [94mh[0m   32 --> 1    [91m-31[0m
        [95mk[0m   14 --> 1    [91m-13[0m
      total time: 10.4
[92mget-selection-metrics-new-simu[0m   /home/dralph/work/partis/bin/partis get-selection-metrics --dont-write-git-info --paired-loci --run-single-chain-selection-metrics --random-seed 1 --n-procs 10 --paired-outdir test/paired/new-results-slow/partition-new-simu --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --run-single-chain-selection-metrics --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
  getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    getting trees for 14 clusters with sizes: 29 17 15 14 14 13 12 11 11 11 11 10 10 10
      tree origins: 14 made from cpath
    calculating selection metrics for 14 clusters with sizes: 29 17 15 14 14 13 12 11 11 11 11 10 10 10
      skipping 198 smaller than 10
  setting default tau to 1 / 370 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0027
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 51/54 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: uvz brz emr opx ntw bkt jrs ipu fsv ruw coq dhn cor kpu lqu ewy lou bex dmu env act efg fju dou
  setting default tau to 1 / 370 = 0.0027
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0027
        [94miclust 2: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 15/15 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0014    0.0053     0.2653     2.7693     2868596996019457532-igh
      0.0014    0.0026     0.5306     0.8847     4279508703292024136-igh
      0.0014    0.0026     0.5306     0.8847     7483514864049595058-igh
      0.0014    0.0026     0.5306     0.8847     5475872492901095179-igh
      0.0014    0.0026     0.5306     0.8847     2908045579636704039-igh
      0.0014    0.0026     0.5306     0.8847     2861224295950874384-igh
      0.0014    0.0026     0.5306     0.8847     3566930738356076969-igh
      0.0014    0.0026     0.5306     0.8847     6320612576182702400-igh
      0.0014    0.0026     0.5306     0.8847     0676866336679508987-igh
      0.0014    0.0026     0.5306     0.8847     4089003412167002582-igh
      0.0014    0.0026     0.5306     0.8847     7483096052293790089-igh
      0.0014    0.0026     0.5306     0.8847     3178069011225053373-igh
      0.0014    0.0026     0.5306     0.8847     5670806787647768906-igh
      0.0014    0.0026     0.5306     0.8847     7378736105100548506-igh
      0.0014    0.0026     0.5306     0.8847     5366871687973810495-igh
          [93mwarning[0m nuc branch length 0.0014 and hamming frac 0.0053 very different (ratio 0.27) for branch between 2868596996019457532-igh --> bdn
        [94miclust 3: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 14/14 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0043    0.0000     0.0000     1.0000     7383705954469113726-igh
      0.0043    0.0000     0.0000     1.0000     0046508056751538056-igh
      0.0043    0.0000     0.0000     1.0000     6455464477884261232-igh
      0.0043    0.0000     0.0000     1.0000     4735233947962000801-igh
      0.0043    0.0000     0.0000     1.0000     2078928172070378712-igh
      0.0043    0.0000     0.0000     1.0000     1224628081579189913-igh
      0.0043    0.0000     0.0000     1.0000     7150021699949862798-igh
      0.0043    0.0000     0.0000     1.0000     0927679879655955990-igh
      0.0043    0.0000     0.0000     1.0000     3697080126396538824-igh
      0.0043    0.0000     0.0000     1.0000     7440294976579542548-igh
      0.0043    0.0000     0.0000     1.0000     3667290263212830436-igh
      0.0043    0.0000     0.0000     1.0000     6548026042362111346-igh
      0.0043    0.0000     0.0000     1.0000     6685260786122506221-igh
      0.0043    0.0085     0.5124     0.9517     2777174777771684527-igh
        [94miclust 5: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 2/13 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0034    0.0056     0.6053     0.6521     8943033131066205088-igh
      0.0040    0.0056     0.7011     0.4263     4919509603437603345-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 5): skipped 16/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bhz mqt dft grs qxy ptz fhr
        [94miclust 6: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 12/12 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0186    0.0000     0.0000     1.0000     5496536009155046507-igh
      0.0186    0.0000     0.0000     1.0000     1893116652837481957-igh
      0.0186    0.0000     0.0000     1.0000     3625522470403622025-igh
      0.0186    0.0000     0.0000     1.0000     7582323615753885231-igh
      0.0186    0.0000     0.0000     1.0000     2680593241437643993-igh
      0.0186    0.0000     0.0000     1.0000     4519001941391497694-igh
      0.0186    0.0000     0.0000     1.0000     5855506076462789199-igh
      0.0186    0.0000     0.0000     1.0000     0499085360564944271-igh
      0.0186    0.0000     0.0000     1.0000     8566563847862862218-igh
      0.0186    0.0000     0.0000     1.0000     7743999198813031723-igh
      0.0186    0.0000     0.0000     1.0000     6615281208292965127-igh
      0.0186    0.0351     0.5280     0.8941     5370429582871640253-igh
        [94miclust 7: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 4/11 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0189    0.0319     0.5906     0.6931     3852409383280143543-igh
      0.0344    0.0505     0.6814     0.4677     1592008271957897252-igh
      0.0331    0.0486     0.6814     0.4675     0146805805939391560-igh
      0.0432    0.0559     0.7742     0.2917     6118691810749010508-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 7): skipped 19/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: fov hnu agz dpq enw ack mnr suy
        [94miclust 8: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 3/11 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0306    0.0531     0.5756     0.7372     0388990409943102934-igh
      0.0375    0.0503     0.7462     0.3401     1876517560481998431-igh
      0.0524    0.0391     1.3399     0.2537     1291133210292313717-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 8): skipped 18/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: dry fky apw bgy ghn ckn cej kmx
        [94miclust 9: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 7/11 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0033    0.0054     0.6129     0.6316     5626091709256135931-igh
      0.0034    0.0054     0.6147     0.6267     7553821683098089847-igh
      0.0034    0.0054     0.6147     0.6267     9136955230745474374-igh
      0.0039    0.0054     0.7138     0.4009     7184221053550888065-igh
      0.0061    0.0082     0.7487     0.3357     0701230472194819646-igh
      0.0061    0.0082     0.7487     0.3357     6375584036862828991-igh
      0.0061    0.0082     0.7499     0.3335     4894631286229088947-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 9): skipped 8/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bju dqw flt
        [94miclust 10: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 11/11 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0152    0.0388     0.3919     1.5514     3051833841577160547-igh
      0.0227    0.0471     0.4827     1.0718     0431318797064336221-igh
      0.0323    0.0526     0.6128     0.6320     3646110703047479225-igh
      0.0379    0.0554     0.6845     0.4610     7881809833455499116-igh
      0.0577    0.0388     1.4878     0.3279     6285195969558878839-igh
      0.0638    0.0443     1.4393     0.3052     7177206618256337666-igh
      0.0705    0.0499     1.4145     0.2930     4209299242023479797-igh
      0.0744    0.0526     1.4134     0.2925     4328695469749780623-igh
      0.0619    0.0443     1.3955     0.2834     9112405197775088017-igh
      0.0607    0.0443     1.3686     0.2693     1457692544706454108-igh
      0.0602    0.0443     1.3585     0.2639     6455856102980629913-igh
          [93mwarning[0m nuc branch length 0.0227 and hamming frac 0.0471 very different (ratio 0.48) for branch between 0431318797064336221-igh --> dwy
          [93mwarning[0m nuc branch length 0.0152 and hamming frac 0.0388 very different (ratio 0.39) for branch between 3051833841577160547-igh --> dwy
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 10): skipped 17/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: ant cor ghs fgu dqx dkz lyz lmw
        [94miclust 13: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 8/10 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0033    0.0000     0.0000     1.0000     3755312316607753487-igh
      0.0033    0.0000     0.0000     1.0000     1850131945780139389-igh
      0.0033    0.0054     0.6162     0.6228     0829285180460795785-igh
      0.0033    0.0054     0.6162     0.6228     9052903217981687825-igh
      0.0033    0.0054     0.6162     0.6228     2224875976231395583-igh
      0.0033    0.0054     0.6162     0.6228     0453457579057127074-igh
      0.0033    0.0054     0.6162     0.6228     7320872803659817756-igh
      0.0034    0.0054     0.6181     0.6179     0089283297210633200-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 13): skipped 9/13 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: nsy gmy auz
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igh-selection-metrics.yaml
      total time: 1.5
[44mget-selection-metrics[0m [94migh+igk[0m:[94m igk[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igk --dont-write-git-info --run-single-chain-selection-metrics --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
  getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    getting trees for 14 clusters with sizes: 31 20 16 14 13 12 12 12 11 11 11 10 10 10
      tree origins: 14 made from cpath
    calculating selection metrics for 14 clusters with sizes: 31 20 16 14 13 12 12 12 11 11 11 10 10 10
      skipping 169 smaller than 10
  setting default tau to 1 / 340 = 0.0029
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0029
        [94miclust 0: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 31/31 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0112    0.0000     0.0000     1.0000     8249779072425430592-igk
      0.0112    0.0000     0.0000     1.0000     6015961728527266617-igk
      0.0112    0.0000     0.0000     1.0000     7287561184950536307-igk
      0.0112    0.0000     0.0000     1.0000     0393969878982599829-igk
      0.0112    0.0000     0.0000     1.0000     8020095998955343950-igk
      0.0112    0.0000     0.0000     1.0000     6131914649560135013-igk
      0.0112    0.0000     0.0000     1.0000     9083670469105414532-igk
      0.0112    0.0000     0.0000     1.0000     8843405553661357216-igk
      0.0112    0.0000     0.0000     1.0000     6695763620155680960-igk
      0.0112    0.0000     0.0000     1.0000     1110906604662458640-igk
      0.0112    0.0000     0.0000     1.0000     4997395349497519148-igk
      0.0112    0.0000     0.0000     1.0000     1935238608924807489-igk
      0.0112    0.0000     0.0000     1.0000     7761182685645240355-igk
      0.0112    0.0000     0.0000     1.0000     0483998891175204459-igk
      0.0112    0.0000     0.0000     1.0000     6928029730554114850-igk
      0.0112    0.0000     0.0000     1.0000     0352991810400659196-igk
      0.0112    0.0000     0.0000     1.0000     7380980274069482316-igk
      0.0112    0.0000     0.0000     1.0000     8926817131772393236-igk
      0.0112    0.0000     0.0000     1.0000     2449081293795609249-igk
      0.0112    0.0000     0.0000     1.0000     3874233171891145881-igk
      0.0112    0.0000     0.0000     1.0000     6601027300376638786-igk
      0.0112    0.0000     0.0000     1.0000     1831452496496166968-igk
      0.0112    0.0000     0.0000     1.0000     0321505090910595987-igk
      0.0112    0.0000     0.0000     1.0000     5339603941548150916-igk
      0.0112    0.0000     0.0000     1.0000     0132526799443345491-igk
      0.0112    0.0000     0.0000     1.0000     2931796058173897070-igk
      0.0112    0.0000     0.0000     1.0000     0357336109842760089-igk
      0.0112    0.0000     0.0000     1.0000     3016795547846380638-igk
      0.0112    0.0000     0.0000     1.0000     8491307914594882867-igk
      0.0112    0.0000     0.0000     1.0000     2233446940528539583-igk
      0.0112    0.0217     0.5157     0.9393     4583344754314604239-igk
  setting default tau to 1 / 340 = 0.0029
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0029
        [94miclust 1: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 20/20 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0048    0.0249     0.1930     4.1813     7675054709541274093-igk
      0.0051    0.0156     0.3300     2.0304     0515260043455636484-igk
      0.0222    0.0000     0.0000     1.0000     8783159409729959662-igk
      0.0222    0.0000     0.0000     1.0000     6923639371550243098-igk
      0.0222    0.0000     0.0000     1.0000     9220592361438166583-igk
      0.0222    0.0000     0.0000     1.0000     0281360386959837356-igk
      0.0222    0.0000     0.0000     1.0000     5985384172875489319-igk
      0.0222    0.0000     0.0000     1.0000     0097328865434933074-igk
      0.0222    0.0000     0.0000     1.0000     6283294071599125022-igk
      0.0222    0.0000     0.0000     1.0000     6449533098281318509-igk
      0.0222    0.0000     0.0000     1.0000     3989533364654679111-igk
      0.0222    0.0000     0.0000     1.0000     1018631008044770831-igk
      0.0222    0.0000     0.0000     1.0000     7033516929760652747-igk
      0.0222    0.0000     0.0000     1.0000     3800059541212012373-igk
      0.0222    0.0000     0.0000     1.0000     8776025731513881660-igk
      0.0222    0.0000     0.0000     1.0000     4961183970982078756-igk
      0.0222    0.0000     0.0000     1.0000     3410818562608101963-igk
      0.0222    0.0000     0.0000     1.0000     2192138396425496786-igk
      0.0253    0.0031     8.1498     0.8773     3842435962583128456-igk
      0.0171    0.0248     0.6895     0.4504     2975541313160084247-igk
          [93mwarning[0m nuc branch length 0.0048 and hamming frac 0.0249 very different (ratio 0.19) for branch between 7675054709541274093-igk --> cgr
          [93mwarning[0m nuc branch length 0.0051 and hamming frac 0.0156 very different (ratio 0.33) for branch between 0515260043455636484-igk --> cgr
        [94miclust 2: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 16/16 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0015    0.0000     0.0000     1.0000     2908045579636704039-igk
      0.0015    0.0000     0.0000     1.0000     5475872492901095179-igk
      0.0015    0.0000     0.0000     1.0000     4279508703292024136-igk
      0.0015    0.0000     0.0000     1.0000     3566930738356076969-igk
      0.0015    0.0000     0.0000     1.0000     2861224295950874384-igk
      0.0015    0.0000     0.0000     1.0000     6320612576182702400-igk
      0.0015    0.0000     0.0000     1.0000     7483096052293790089-igk
      0.0015    0.0000     0.0000     1.0000     0676866336679508987-igk
      0.0015    0.0000     0.0000     1.0000     5670806787647768906-igk
      0.0015    0.0000     0.0000     1.0000     3178069011225053373-igk
      0.0015    0.0000     0.0000     1.0000     2868596996019457532-igk
      0.0015    0.0000     0.0000     1.0000     7378736105100548506-igk
      0.0015    0.0000     0.0000     1.0000     8894872729840751971-igk
      0.0015    0.0000     0.0000     1.0000     5366871687973810495-igk
      0.0015    0.0030     0.5018     0.9927     7483514864049595058-igk
      0.0015    0.0030     0.5018     0.9927     4089003412167002582-igk
        [94miclust 5: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 12/12 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0032    0.0000     0.0000     1.0000     6618615821993229662-igk
      0.0032    0.0000     0.0000     1.0000     7038156401312331386-igk
      0.0032    0.0000     0.0000     1.0000     1664130530552462086-igk
      0.0032    0.0000     0.0000     1.0000     2587553159386519200-igk
      0.0032    0.0000     0.0000     1.0000     4886756152588433518-igk
      0.0032    0.0000     0.0000     1.0000     8320177084203519502-igk
      0.0032    0.0000     0.0000     1.0000     2285743516603811610-igk
      0.0032    0.0000     0.0000     1.0000     7954595008721796136-igk
      0.0032    0.0000     0.0000     1.0000     6728873402175495209-igk
      0.0032    0.0000     0.0000     1.0000     2215700113730503056-igk
      0.0032    0.0000     0.0000     1.0000     4234048076598810639-igk
      0.0032    0.0062     0.5088     0.9656     7783791139860461521-igk
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igk/partition-igk-selection-metrics.yaml
      total time: 0.8
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igh[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igh --dont-write-git-info --run-single-chain-selection-metrics --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
  getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    getting trees for 10 clusters with sizes: 24 20 18 15 14 13 12 10 10 10
      tree origins: 10 made from cpath
    calculating selection metrics for 10 clusters with sizes: 24 20 18 15 14 13 12 10 10 10
      skipping 141 smaller than 10
  setting default tau to 1 / 382 = 0.0026
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0026
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 31/36 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: coq uvz cor kpu lqu ipu jrs dmu env emr fju efg
  setting default tau to 1 / 382 = 0.0026
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0026
        [94miclust 1: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 14/20 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0469    0.1065     0.4408     1.2687     3460024430053266460-igh
      0.0480    0.1065     0.4506     1.2191     7153740201231206318-igh
      0.0482    0.1065     0.4524     1.2103     3916193579031653942-igh
      0.0523    0.1143     0.4577     1.1848     3435987981856781021-igh
      0.0506    0.1091     0.4637     1.1564     7011876773655926503-igh
      0.0530    0.1091     0.4857     1.0591     0605436960283742311-igh
      0.0569    0.1169     0.4866     1.0553     4030504834394011079-igh
      0.0517    0.1039     0.4972     1.0112     1767611730716028444-igh
      0.0594    0.1117     0.5318     0.8803     2244714085091278571-igh
      0.0758    0.1169     0.6483     0.5424     8055466163282342115-igh
      0.0739    0.1013     0.7291     0.3715     8648797381082175059-igh
      0.1362    0.0909     1.4984     0.3326     2308742347537032314-igh
      0.1424    0.1039     1.3708     0.2705     7239387716811157961-igh
      0.1759    0.1299     1.3544     0.2617     0842496127807567633-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 37/38 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: pqz jou ahn gsx gjt kqx jkp bnv dgq bjs ejy mwy glr ijo anw bwz cjp
        [94miclust 2: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 1/18 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0038    0.0027     1.3983     0.2848     3810013956605564244-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 23/28 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: nvw cjk agm aeu fty ltz cdj bdq dmu cfs
        [94miclust 3: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 2/15 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0343    0.0237     1.4457     0.3083     7380617868211703649-igh
      0.0125    0.0158     0.7915     0.2635     9201666969585767925-igh
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 3): skipped 22/26 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: hvx anu vyz dlr nwx dpz jrv hlm ipq fps
        [94miclust 4: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 12/14 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0026    0.0385     0.0676     13.7929     3195493872667711145-igh
      0.0032    0.0359     0.0878     10.3960     3145739496960809933-igh
      0.0052    0.0410     0.1272     6.8593     3572585081032468871-igh
      0.0052    0.0410     0.1272     6.8593     1511705061987813904-igh
      0.0244    0.0385     0.6344     0.5763     7427392473165940548-igh
      0.0643    0.0308     2.0891     0.5213     5676382734591770627-igh
      0.0698    0.0359     1.9433     0.4854     7553285195620669147-igh
      0.0689    0.0359     1.9185     0.4788     8819953233536010839-igh
      0.0689    0.0359     1.9185     0.4788     2285376519152879741-igh
      0.0749    0.0410     1.8254     0.4522     7732040268686554775-igh
      0.0734    0.0436     1.6830     0.4058     4355827031344083099-igh
      0.0893    0.0538     1.6579     0.3968     2129087849071259863-igh
          [93mwarning[0m nuc branch length 0.0052 and hamming frac 0.0410 very different (ratio 0.13) for branch between 1511705061987813904-igh --> cty
          [93mwarning[0m nuc branch length 0.0026 and hamming frac 0.0385 very different (ratio 0.07) for branch between 3195493872667711145-igh --> cty
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 4): skipped 19/24 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bpq esu dfn bho cqr bct cdh goq dgo
        [94miclust 5: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 13/13 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0030    0.0000     0.0000     1.0000     8491734797531648044-igh
      0.0030    0.0000     0.0000     1.0000     6471094595481694140-igh
      0.0030    0.0000     0.0000     1.0000     5735323184917054667-igh
      0.0030    0.0000     0.0000     1.0000     3916124757125782793-igh
      0.0030    0.0000     0.0000     1.0000     0161606783835244621-igh
      0.0030    0.0000     0.0000     1.0000     1891024981741873852-igh
      0.0030    0.0000     0.0000     1.0000     8480892480895180921-igh
      0.0030    0.0000     0.0000     1.0000     4262800480392836293-igh
      0.0030    0.0000     0.0000     1.0000     0642147441991752901-igh
      0.0030    0.0000     0.0000     1.0000     2011934737232710316-igh
      0.0030    0.0000     0.0000     1.0000     8484652898258995600-igh
      0.0030    0.0000     0.0000     1.0000     2632568693062682293-igh
      0.0030    0.0055     0.5442     0.8376     0960715752824823700-igh
        [94miclust 6: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 12/12 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0014    0.0000     0.0000     1.0000     2162139549315838559-igh
      0.0014    0.0000     0.0000     1.0000     5548931120679776363-igh
      0.0014    0.0000     0.0000     1.0000     7484979497876499408-igh
      0.0014    0.0000     0.0000     1.0000     3659021409157093499-igh
      0.0014    0.0000     0.0000     1.0000     4908889416209039550-igh
      0.0014    0.0000     0.0000     1.0000     1127310571846829490-igh
      0.0014    0.0000     0.0000     1.0000     1417518428005771666-igh
      0.0014    0.0000     0.0000     1.0000     4467949456624593698-igh
      0.0014    0.0000     0.0000     1.0000     2659818379622197785-igh
      0.0014    0.0000     0.0000     1.0000     3884281834147726606-igh
      0.0014    0.0000     0.0000     1.0000     8495918319421414217-igh
      0.0014    0.0026     0.5299     0.8871     0942490132950063617-igh
        [94miclust 9: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 3/10 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0026    0.0078     0.3354     1.9819     9143278206265865162-igh
      0.0079    0.0000     0.0000     1.0000     7520177754485781781-igh
      0.0053    0.0026     2.0198     0.5049     6784227940805863459-igh
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igh-selection-metrics.yaml
      total time: 1.4
[44mget-selection-metrics[0m [94migh+igl[0m:[94m igl[0m
[91mrun[0m /home/dralph/work/partis/bin/partis get-selection-metrics --locus igl --dont-write-git-info --run-single-chain-selection-metrics --random-seed 1 --n-procs 10 --chosen-ab-fname test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml --refuse-to-cache-parameters --outfname test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
  getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    getting trees for 7 clusters with sizes: 25 23 21 15 15 12 12
      tree origins: 7 made from cpath
    calculating selection metrics for 7 clusters with sizes: 25 23 21 15 15 12 12
      skipping 88 smaller than 10
  setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0030
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 32/39 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: coq kpu lqu ipu opx bkt loq jrs dmu env act elp fju efg
  setting default tau to 1 / 337 = 0.0030
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0030
        [94miclust 2: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 7/21 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0032    0.0062     0.5168     0.9352     8648797381082175059-igl
      0.0037    0.0062     0.5996     0.6677     4030504834394011079-igl
      0.0037    0.0062     0.6013     0.6632     0605436960283742311-igl
      0.0037    0.0062     0.6013     0.6632     8055466163282342115-igl
      0.0063    0.0092     0.6857     0.4583     1767611730716028444-igl
      0.0069    0.0092     0.7432     0.3456     0842496127807567633-igl
      0.0069    0.0092     0.7442     0.3436     2659906818498555425-igl
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 26/32 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: agm dyz aiz ltz cdj gjn bdq dmu rvy cjv cfs
        [94miclust 4: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 1/15 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0043    0.0031     1.3717     0.2710     7427392473165940548-igl
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 4): skipped 11/19 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bpq dny cdh dgo
        [94miclust 5: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 12/12 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0048    0.0000     0.0000     1.0000     5735323184917054667-igl
      0.0048    0.0000     0.0000     1.0000     1891024981741873852-igl
      0.0048    0.0000     0.0000     1.0000     8491734797531648044-igl
      0.0048    0.0000     0.0000     1.0000     6471094595481694140-igl
      0.0048    0.0000     0.0000     1.0000     0161606783835244621-igl
      0.0048    0.0000     0.0000     1.0000     6407527164629906835-igl
      0.0048    0.0000     0.0000     1.0000     8480892480895180921-igl
      0.0048    0.0000     0.0000     1.0000     4262800480392836293-igl
      0.0048    0.0000     0.0000     1.0000     8484652898258995600-igl
      0.0048    0.0000     0.0000     1.0000     2632568693062682293-igl
      0.0048    0.0000     0.0000     1.0000     2011934737232710316-igl
      0.0048    0.0094     0.5072     0.9716     3145739496960809933-igl
        [94miclust 6: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 8/12 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0093    0.0151     0.6183     0.6173     6331337912179304021-igl
      0.0124    0.0181     0.6868     0.4560     3884281834147726606-igl
      0.0161    0.0091     1.7764     0.4371     7058303599015699814-igl
      0.0161    0.0091     1.7764     0.4371     4467949456624593698-igl
      0.0130    0.0181     0.7161     0.3965     4908889416209039550-igl
      0.0130    0.0181     0.7172     0.3944     5548931120679776363-igl
      0.0225    0.0151     1.4869     0.3274     2659818379622197785-igl
      0.0189    0.0242     0.7803     0.2815     2162139549315838559-igl
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 6): skipped 13/19 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: kst bfg hiu cky fju elu
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/igh+igl/partition-igl-selection-metrics.yaml
      total time: 0.9
  getting combined h/l selection metrics
    [93mwarning[0m check_concordance_of_cpath_and_annotations(): missing annotations for 3/178 clusters in best partition with sizes: 6, 6, 2
        8 extra annotations (i.e. they're for clusters not in best partition) with sizes: 1 1 1 1 4 1 3 2
          missing 'best' cluster with size 2 overlaps with the following (overlap/size): 1/1  1/1
          missing 'best' cluster with size 6 overlaps with the following (overlap/size): 1/1  1/1  4/4
          missing 'best' cluster with size 6 overlaps with the following (overlap/size): 1/1  3/3  2/2
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/2
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/2
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/6
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/6
          extra annotation with size 4 overlaps with the following best clusters (overlap/size): 4/6
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/6
          extra annotation with size 3 overlaps with the following best clusters (overlap/size): 3/6
          extra annotation with size 2 overlaps with the following best clusters (overlap/size): 2/6
      [93mwarning[0m missing annotation for light chain (size 6, paired with size 7) when finding cluster pairs 0032039233068408084-igk:2659599773997899895-igk:3605721225081273096-igk:4111296117471388057-igk:3659577077549528214-igk:7417323718281539010-igk 0032039233068408084-igh:2659599773997899895-igh:3605721225081273096-igh:4111296117471388057-igh:3659577077549528214-igh:0779828650680679142-igh:7101254269481970028-igh
      [93mwarning[0m missing annotation for light chain (size 6, paired with size 4) when finding cluster pairs 3334215334336355782-igk:6112829882377320741-igk:3320016206356902060-igk:2781969132218865969-igk:7375477325398118147-igk:0510121118584624799-igk 3334215334336355782-igh:6112829882377320741-igh:3320016206356902060-igh:2781969132218865969-igh
      [93mwarning[0m missing annotation for light chain (size 2, paired with size 3) when finding cluster pairs 0701230472194819646-igk:6612041037964933176-igk 6546563291448723158-igh:3123573618536320250-igh:7484979497876499408-igh
    igh+igk: 164 unpaired light clusters after finding h/l cluster pairs
    igh+igk: skipped 38 annotations with zero length paired uids
    igh+igk: skipped 160 annotations with N h or l ids < 10
    [93mwarning[0m check_concordance_of_cpath_and_annotations(): missing annotations for 2/93 clusters in best partition with sizes: 9, 2
        4 extra annotations (i.e. they're for clusters not in best partition) with sizes: 8 1 1 1
          missing 'best' cluster with size 9 overlaps with the following (overlap/size): 8/8  1/1
          missing 'best' cluster with size 2 overlaps with the following (overlap/size): 1/1  1/1
          extra annotation with size 8 overlaps with the following best clusters (overlap/size): 8/9
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/9
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/2
          extra annotation with size 1 overlaps with the following best clusters (overlap/size): 1/2
      [93mwarning[0m missing annotation for light chain (size 9, paired with size 10) when finding cluster pairs 6784227940805863459-igl:5443311291335560888-igl:0115912531564413663-igl:2535087772943783307-igl:3729233455894130421-igl:5529307609141477269-igl:8185255255178347655-igl:3673734846298556156-igl:4446140756998708037-igl 6784227940805863459-igh:7520177754485781781-igh:0115912531564413663-igh:2535087772943783307-igh:9143278206265865162-igh:5529307609141477269-igh:8185255255178347655-igh:3673734846298556156-igh:4446140756998708037-igh:4161803344135685880-igh
      [93mwarning[0m missing annotation for light chain (size 2, paired with size 4) when finding cluster pairs 0971821634516435139-igl:3643224299532561054-igl 0971821634516435139-igh:6655660609989769906-igh:2834565878938946058-igh:1313070068675819441-igh
    igh+igl: 84 unpaired light clusters after finding h/l cluster pairs
    igh+igl: skipped 61 annotations with zero length paired uids
    igh+igl: skipped 81 annotations with N h or l ids < 10
            cons seq not observed
        less than 0.75 (4 / 29 = 0.14) of h seqs have indels, so not using input seqs for cons seq
        less than 0.75 (8 / 31 = 0.26) of l seqs have indels, so not using input seqs for cons seq
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 6928029730554114850-igh 6928029730554114850-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 9083670469105414532-igh 9083670469105414532-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2931796058173897070-igh 2931796058173897070-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 5339603941548150916-igh 5339603941548150916-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2449081293795609249-igh 2449081293795609249-igk
            cons seq not observed
        less than 0.75 (5 / 24 = 0.21) of h seqs have indels, so not using input seqs for cons seq
        less than 0.75 (5 / 25 = 0.20) of l seqs have indels, so not using input seqs for cons seq
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2837610149726138004-igh 2837610149726138004-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 5086672391185581025-igh 5086672391185581025-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2282592859345613663-igh 2282592859345613663-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8106283947587798521-igh 8106283947587798521-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 6268512401205569735-igh 6268512401205569735-igl
            cons seq not observed
        less than 0.75 (2 / 20 = 0.10) of h seqs have indels, so not using input seqs for cons seq
        less than 0.75 (3 / 21 = 0.14) of l seqs have indels, so not using input seqs for cons seq
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8055466163282342115-igh 8055466163282342115-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2308742347537032314-igh 2308742347537032314-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 7829880163834004541-igh 7829880163834004541-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 1162854746377830354-igh 1162854746377830354-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 7622081286960976867-igh 7622081286960976867-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3507228390317876631-igh 3507228390317876631-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 4850952847165763581-igh 4850952847165763581-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 1207467187000553831-igh 1207467187000553831-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8776025731513881660-igh 8776025731513881660-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3800059541212012373-igh 3800059541212012373-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8783159409729959662-igh 8783159409729959662-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 1018631008044770831-igh 1018631008044770831-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2192138396425496786-igh 2192138396425496786-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 6449533098281318509-igh 6449533098281318509-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 0515260043455636484-igh 0515260043455636484-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 7675054709541274093-igh 7675054709541274093-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2975541313160084247-igh 2975541313160084247-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8533573562613483939-igh 8533573562613483939-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3116411769246414576-igh 3116411769246414576-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 2861450587812512992-igh 2861450587812512992-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 8809988767957253313-igh 8337279198295839151-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 4279508703292024136-igh 4279508703292024136-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3566930738356076969-igh 3566930738356076969-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 6320612576182702400-igh 5366871687973810495-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 7483514864049595058-igh 7483514864049595058-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 4089003412167002582-igh 4089003412167002582-igk
            cons seq not observed
        less than 0.75 (3 / 15 = 0.20) of h seqs have indels, so not using input seqs for cons seq
        less than 0.75 (4 / 15 = 0.27) of l seqs have indels, so not using input seqs for cons seq
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 9201666969585767925-igh 9201666969585767925-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 5472033004376707064-igh 5472033004376707064-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 3316045886334424798-igh 3316045886334424798-igl
            cons seq not observed
        less than 0.75 (5 / 14 = 0.36) of h seqs have indels, so not using input seqs for cons seq
        less than 0.75 (1 / 15 = 0.07) of l seqs have indels, so not using input seqs for cons seq
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 1511705061987813904-igh 1511705061987813904-igl
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 0046508056751538056-igh 0046508056751538056-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 6685260786122506221-igh 6685260786122506221-igk
          [93mwarning[0m choosing ab with shm indel: the consensus sequence may or may not reflect the indels (see above). uids: 1224628081579189913-igh 1224628081579189913-igk
  getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    getting trees for 17 clusters with sizes: 28 22 18 17 15 14 14 13 12 12 12 11 11 10 10 10 10
      tree origins: 17 ran fasttree
    calculating selection metrics for 17 clusters with sizes: 28 22 18 17 15 14 14 13 12 12 12 11 11 10 10 10 10
      skipping 1 smaller than 10
  setting default tau to 1 / 710 = 0.0014
    calculating normalized lb index and lb ratio and lb fraction with tau 0.0014
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 51/54 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: emw nqt mxy cem cin lsw nry amz lmo cgp alt lwz bly dik jxy egr iqw irs muy cpz glz gqx bgz dfw dot
  setting default tau to 1 / 710 = 0.0014
    calculating normalized lb index and lb ratio and lb fraction on aa tree with tau 0.0014
        [94miclust 1: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 1/22 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0044    0.0028     1.5782     0.3664     2464920397588156761_contig_igh+igl
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 38/41 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: coq efg lqu emr bex kpu bkt ewy loq jrs dmu env ipu elp cix ruw fju dou
        [94miclust 2: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 3/18 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0922    0.0563     1.6369     0.3891     8648797381082175059_contig_igh+igl
      0.0822    0.0591     1.3923     0.2818     1767611730716028444_contig_igh+igl
      0.0812    0.0604     1.3442     0.2560     0605436960283742311_contig_igh+igl
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 35/36 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: kpr ahi fhi bns bgk hqu noy jks htu csy bip cit cmu mot cgs suy ajm
        [94miclust 3: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 10/17 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0006    0.0014     0.3889     1.5717     3810013956605564244_contig_igh+igl
      0.0051    0.0028     1.7852     0.4398     9204389322873860625_contig_igh+igl
      0.0047    0.0028     1.6544     0.3955     6723344859727410771_contig_igh+igl
      0.0047    0.0028     1.6544     0.3955     9219594453118285895_contig_igh+igl
      0.0047    0.0028     1.6544     0.3955     3507228390317876631_contig_igh+igl
      0.0062    0.0042     1.4611     0.3156     1806230368692033891_contig_igh+igl
      0.0041    0.0028     1.4600     0.3150     4850952847165763581_contig_igh+igl
      0.0062    0.0042     1.4588     0.3145     7768673123773159888-igh+2898058159068739252-igl
      0.0077    0.0057     1.3592     0.2643     2570466947252138349_contig_igh+igl
      0.0113    0.0085     1.3339     0.2503     9100239866588205890_contig_igh+igl
          [93mwarning[0m nuc branch length 0.0006 and hamming frac 0.0015 very different (ratio 0.38) for branch between 3810013956605564244_contig_igh+igl --> 1162854746377830354_contig_igh+igl
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 3): skipped 19/26 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: dgq bjs jou jkp glr anw bnv ejy
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 4): skipped 3/17 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: mqz
        [94miclust 5: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 1/14 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0201    0.0127     1.5758     0.3654     2975541313160084247_contig_igh+igk
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 5): skipped 3/16 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bdn
        [94miclust 6: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 1/14 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0020    0.0014     1.4606     0.3154     8533573562613483939_contig_igh+igk
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 6): skipped 3/16 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: adg
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 7): skipped 21/24 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: anu jrv vyz ijy dpz dlr hlm ipq fps fjr
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 8): skipped 19/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: amu loq txz dqs lrx lnq hjx nvy nsu
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 9): skipped 2/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: cty
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 10): skipped 2/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: hou
        [94miclust 11: [0m[93mwarning [0mtree depth and mfreq differ by more than 25% for 1/11 nodes (note that this is expected if these are single chain sequences being compared to a paired h+l tree)
    tree depth   mfreq      ratio    frac diff
      0.0006    0.0014     0.3839     1.6048     0277109334102727989_contig_igh+igk
          [93mwarning[0m nuc branch length 0.0006 and hamming frac 0.0015 very different (ratio 0.37) for branch between 0277109334102727989_contig_igh+igk --> XnaiveX
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 11): skipped 13/17 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: dsv bhz lnz iqu qxy
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 12): skipped 21/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: gkx cor fkm dqu hiz ajw nrz rwx dht dst
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 13): skipped 17/19 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: bmy hiu hpu cky afg aco fju elu
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 16): skipped 19/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified). Missing nodes: buz jvz dmr dtx agx dgy ctx dgi dhp
  writing selection metrics to test/paired/new-results-slow/partition-new-simu/selection-metrics.yaml
      writing 94 chosen abs to test/paired/new-results-slow/get-selection-metrics-new-simu-chosen-abs.csv
      total time: 9.2
