[92mcache-parameters-data[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --infname test/mishmash.fa --parameter-dir test/new-results/test/parameters/data --sw-cachefname test/new-results/test/parameters/data/sw-cache.yaml --n-max-queries 50 --seed 1 --n-procs 10
  --n-max-queries: stopped after reading 50 queries from input file
caching parameters
  vsearch: 44 / 50 v annotations (6 failed) with 53 v genes in 0.1 sec
    keeping 24 / 220 v genes
smith-waterman  (new-allele fitting)
  vsearch: 45 / 50 v annotations (5 failed) with 22 v genes in 0.0 sec
  removing old sw cache test/new-results/test/parameters/data/sw-cache.yaml
    running 10 procs for 50 seqs
    running 11 procs for 5 seqs
      info for 46 / 50 = 0.920   (removed: 4 failed)
      kept 16 (0.320) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 45 / 50 v annotations (5 failed) with 22 v genes in 0.1 sec
    running 10 procs for 46 seqs
    running 11 procs for 1 seq
      info for 46 / 50 = 0.920   (removed: 4 failed)
      kept 16 (0.320) unproductive
        writing sw results to test/new-results/test/parameters/data/sw-cache.yaml
    writing parameters to test/new-results/test/parameters/data/sw (0.9 sec)
    water time: 1.2  (ig-sw 1.0  processing 0.1)
  writing hmms (0.2 sec)
hmm
    running 10 procs
                    calcd:         vtb 46        fwd  0
             min-max time:  0.2 - 0.4 sec
    reading output
        read 46 hmm output lines with 46 sequences in 46 events  (0 failures)
    writing parameters to test/new-results/test/parameters/data/hmm (0.7 sec)
         infra time: 0.7
      hmm step time: 1.2
  writing hmms (0.2 sec)
      total time: 3.1
[92msimulate[0m                         /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/new-results/test/parameters/data --n-sim-events 10 --n-trees 10 --n-leaf-distribution geometric --n-leaves 5 --seed 1 --n-procs 10 --outfname test/new-results/test/simu.yaml --indel-frequency 0.2
simulating
      --> proc 9
    reco params: test/new-results/test/parameters/data/hmm     shm params: test/new-results/test/parameters/data/hmm
    made 1 event with 1 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 1.4

      --> proc 1
    reco params: test/new-results/test/parameters/data/hmm     shm params: test/new-results/test/parameters/data/hmm
    made 1 event with 1 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 1.4

      --> proc 4
    reco params: test/new-results/test/parameters/data/hmm     shm params: test/new-results/test/parameters/data/hmm
    made 1 event with 2 seqs in 0.1s (0.1s of which was running bppseqgen)
      total time: 1.4

      --> proc 2
    reco params: test/new-results/test/parameters/data/hmm     shm params: test/new-results/test/parameters/data/hmm
    made 1 event with 1 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 1.5

      --> proc 7
    reco params: test/new-results/test/parameters/data/hmm     shm params: test/new-results/test/parameters/data/hmm
    made 1 event with 10 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 1.5

      --> proc 0
    reco params: test/new-results/test/parameters/data/hmm     shm params: test/new-results/test/parameters/data/hmm
    made 1 event with 3 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 1.5

      --> proc 3
    reco params: test/new-results/test/parameters/data/hmm     shm params: test/new-results/test/parameters/data/hmm
    made 1 event with 6 seqs in 0.3s (0.2s of which was running bppseqgen)
      total time: 1.5

      --> proc 8
    reco params: test/new-results/test/parameters/data/hmm     shm params: test/new-results/test/parameters/data/hmm
    made 1 event with 4 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 1.5

      --> proc 6
    reco params: test/new-results/test/parameters/data/hmm     shm params: test/new-results/test/parameters/data/hmm
    made 1 event with 2 seqs in 0.2s (0.2s of which was running bppseqgen)
      total time: 1.5

      --> proc 5
    reco params: test/new-results/test/parameters/data/hmm     shm params: test/new-results/test/parameters/data/hmm
    made 1 event with 10 seqs in 0.3s (0.3s of which was running bppseqgen)
      total time: 1.6

   read 10 events with 40 seqs from 10 .yaml files
      total time: 2.0
[92mcache-parameters-simu[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --infname test/new-results/test/simu.yaml --parameter-dir test/new-results/test/parameters/simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.yaml --is-simu --seed 1 --n-procs 10
caching parameters
  vsearch: 40 / 40 v annotations (0 failed) with 15 v genes in 0.1 sec
    keeping 7 / 220 v genes
    [91mmissing[0m 10 simulation genes (counts): [95mh[0m[91mv[0m[95m1[0m[95m-18[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-70[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-23[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-7[0m[93mi01[0m 1  [95mh[0m[91mv[0m[95m3[0m[95m-9[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-34[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-39[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-4[0m[93m08[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-61[0m[93m08[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 40 / 40 v annotations (0 failed) with 7 v genes in 0.1 sec
  removing old sw cache test/new-results/test/parameters/simu/sw-cache.yaml
    running 10 procs for 40 seqs
    running 11 procs for 1 seq
      info for 40 / 40 = 1.000   (removed: 0 failed)
      kept 25 (0.625) unproductive
    water time: 0.2  (ig-sw 0.0  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 40 / 40 v annotations (0 failed) with 7 v genes in 0.1 sec
    running 10 procs for 40 seqs
    running 11 procs for 1 seq
      info for 40 / 40 = 1.000   (removed: 0 failed)
      kept 25 (0.625) unproductive
        writing sw results to test/new-results/test/parameters/simu/sw-cache.yaml
    writing parameters to test/new-results/test/parameters/simu/sw (0.7 sec)
    water time: 1.0  (ig-sw 0.8  processing 0.1)
  writing hmms (0.1 sec)
hmm
    running 10 procs
                    calcd:         vtb 40        fwd  0
             min-max time:  0.2 - 0.2 sec
    reading output
        read 40 hmm output lines with 40 sequences in 40 events  (0 failures)
    writing parameters to test/new-results/test/parameters/simu/hmm (0.5 sec)
    writing parameters to test/new-results/test/parameters/simu/true (0.5 sec)
         infra time: 1.1
      hmm step time: 1.3
  writing hmms (0.1 sec)
      total time: 3.1
[92mannotate-new-simu[0m                /home/dralph/work/partis/bin/partis annotate --dont-write-git-info --infname test/new-results/test/simu.yaml --parameter-dir test/new-results/test/parameters/simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.yaml --plot-annotation-performance --is-simu --plotdir test/new-results/annotate-new-simu-annotation-performance --only-csv-plots --seed 1 --n-procs 10 --outfname test/new-results/annotate-new-simu.yaml
annotating    (with test/new-results/test/parameters/simu/hmm)
smith-waterman
  vsearch: 40 / 40 v annotations (0 failed) with 7 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache.yaml
      info for 40 / 40 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 25 (0.625) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 2 queries with different true and inferred net shm indel lengths: 0107873025293891316 0747420743984138266
(0.0 sec)
        water time: 0.4
hmm
    running 10 procs
                    calcd:         vtb 40        fwd  0
             min-max time:  0.2 - 0.2 sec
    reading output
        read 40 hmm output lines with 40 sequences in 40 events  (0 failures)
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 2 queries with different true and inferred net shm indel lengths: 0107873025293891316 0747420743984138266
(0.0 sec)
      hmm step time: 0.3
      total time: 0.8
[92mmulti-annotate-new-simu[0m          /home/dralph/work/partis/bin/partis annotate --dont-write-git-info --infname test/new-results/test/simu.yaml --parameter-dir test/new-results/test/parameters/simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.yaml --plot-annotation-performance --simultaneous-true-clonal-seqs --is-simu --plotdir test/new-results/multi-annotate-new-simu-annotation-performance --only-csv-plots --seed 1 --n-procs 10 --outfname test/new-results/multi-annotate-new-simu.yaml
annotating    (with test/new-results/test/parameters/simu/hmm)
smith-waterman
  vsearch: 40 / 40 v annotations (0 failed) with 7 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache.yaml
      info for 40 / 40 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 25 (0.625) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 2 queries with different true and inferred net shm indel lengths: 0107873025293891316 0747420743984138266
(0.0 sec)
        water time: 0.4
hmm
  --simultaneous-true-clonal-seqs: grouping seqs according to true partition
  [93mwarning[0m split apart 1 cluster that contained multiple cdr3 lengths (total clusters: 10 --> 11)
      cluster splits:  10 --> 9 1
  subcluster annotating 11 clusters: 
    running 10 procs
                    calcd:         vtb 18        fwd  0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 18 hmm output lines with 40 sequences in 18 events  (0 failures)
      hmm step time: 0.3
    read 18 new subcluster annotations: added hashid 11   whole finished 7   subcl finished 0
    running 10 procs
                    calcd:         vtb  5        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 5 hmm output lines with 11 sequences in 5 events  (0 failures)
      hmm step time: 0.2
    read 5 new subcluster annotations: added hashid 5   whole finished 0   subcl finished 3
    running 10 procs
                    calcd:         vtb  1        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 2 queries with different true and inferred net shm indel lengths: 0747420743984138266 0107873025293891316
(0.0 sec)
    subcluster annotation time 0.6
      total time: 1.1
[92mpartition-new-simu[0m               /home/dralph/work/partis/bin/partis partition --dont-write-git-info --infname test/new-results/test/simu.yaml --parameter-dir test/new-results/test/parameters/simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.yaml --n-precache-procs 10 --plot-annotation-performance --is-simu --persistent-cachefname test/new-results/cache-new-partition.csv --no-partition-plots --plotdir test/new-results/partition-new-simu-annotation-performance --only-csv-plots --seed 1 --n-procs 10 --outfname test/new-results/partition-new-simu.yaml
partitioning     (with test/new-results/test/parameters/simu/hmm)
smith-waterman
  vsearch: 40 / 40 v annotations (0 failed) with 7 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache.yaml
      info for 40 / 40 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 25 (0.625) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 2 queries with different true and inferred net shm indel lengths: 0107873025293891316 0747420743984138266
(0.0 sec)
        water time: 0.4
hmm
caching all 40 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 40        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.2 - 0.2 sec
      hmm step time: 0.3
   collapsed 40 queries into 30 clusters with identical naive seqs (0.0 sec)
30 clusters with 10 procs
       naive hfrac bounds: 0.015 0.090
    running 10 procs
          read from cache:  naive-seqs 40   logprobs  0
                    calcd:         vtb  5        fwd  9
                   merged:       hfrac  1     lratio  1
             min-max time:  0.0 - 0.1 sec
         infra time: 0.1
      hmm step time: 0.3
28 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 45   logprobs  9
                    calcd:         vtb  8        fwd  8
                   merged:       hfrac  6     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.3
22 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 53   logprobs 17
                    calcd:         vtb  4        fwd  4
                   merged:       hfrac  3     lratio  1
             min-max time:  0.0 - 0.2 sec
      hmm step time: 0.3
18 clusters with 3 procs
    running 3 procs
          read from cache:  naive-seqs 57   logprobs 21
                    calcd:         vtb  3        fwd  7
                   merged:       hfrac  2     lratio  1
             min-max time:  0.1 - 0.1 sec
      hmm step time: 0.2
15 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 60   logprobs 28
                    calcd:         vtb  2        fwd  4
                   merged:       hfrac  2     lratio  0
             min-max time:  0.1 - 0.2 sec
      hmm step time: 0.3
13 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 62   logprobs 32
                    calcd:         vtb  2        fwd 11
                   merged:       hfrac  2     lratio  0
                     time:  0.5 sec
      hmm step time: 0.5
  [93mnote[0m not merging entire cpath history
      loop time: 1.9
getting annotations for final partition
  subcluster annotating 11 clusters: 
    running 10 procs
                    calcd:         vtb 18        fwd  0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 18 hmm output lines with 40 sequences in 18 events  (0 failures)
      hmm step time: 0.2
    read 18 new subcluster annotations: added hashid 11   whole finished 7   subcl finished 0
    running 10 procs
                    calcd:         vtb  5        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 5 hmm output lines with 11 sequences in 5 events  (0 failures)
      hmm step time: 0.2
    read 5 new subcluster annotations: added hashid 5   whole finished 0   subcl finished 3
    running 10 procs
                    calcd:         vtb  1        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 2 queries with different true and inferred net shm indel lengths: 0107873025293891316 0747420743984138266
(0.0 sec)
    subcluster annotation time 0.6
      total time: 3.3
[92mseed-partition-new-simu[0m          /home/dralph/work/partis/bin/partis partition --dont-write-git-info --infname test/new-results/test/simu.yaml --parameter-dir test/new-results/test/parameters/simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.yaml --is-simu --persistent-cachefname test/new-results/cache-new-partition.csv --no-partition-plots --seed-unique-id 3360438051638168762 --seed 1 --n-procs 10 --outfname test/new-results/seed-partition-new-simu.yaml
partitioning     (with test/new-results/test/parameters/simu/hmm)
smith-waterman
  vsearch: 40 / 40 v annotations (0 failed) with 7 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache.yaml
      info for 40 / 40 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 25 (0.625) unproductive
      removed 24 / 40 = 0.60 sequences with cdr3 length different from seed sequence (leaving 16)
        water time: 0.0
hmm
   collapsed 16 queries into 9 clusters with identical naive seqs (0.0 sec)
9 clusters with 10 procs
       naive hfrac bounds: 0.015 0.090
    running 10 procs
          read from cache:  naive-seqs 64   logprobs 43
                    calcd:         vtb  1        fwd 10
                   merged:       hfrac  1     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
17 clusters with 7 procs
  [93mwarning[0m cluster occurs 9 times in the <nsets> we're sending to bcrham: 2564804985573928891:3360438051638168766:3360438051638168762:3360438051638168761
    running 7 procs
          read from cache:  naive-seqs 65   logprobs 53
                    calcd:         vtb  0        fwd  1
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
14 clusters with 5 procs
  [93mwarning[0m cluster occurs 6 times in the <nsets> we're sending to bcrham: 2564804985573928891:3360438051638168766:3360438051638168762:3360438051638168761
    running 5 procs
          read from cache:  naive-seqs 65   logprobs 54
                    calcd:         vtb  0        fwd  2
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.1 sec
      hmm step time: 0.2
      removed 10 sequences in unseeded clusters, split 5 seeded clusters into 6 singletons, and merged these into 2 clusters with identical naive seqs
        new n_procs 2 (initial seqs/proc: 1.60   new seqs/proc: 1.00
2 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 65   logprobs 56
                    calcd:         vtb  0        fwd  0
                   merged:       hfrac  0     lratio  0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/965528/hmm_cached_info.csv
      hmm step time: 0.1
2 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 65   logprobs 56
                    calcd:         vtb  0        fwd  0
                   merged:       hfrac  1     lratio  0
                     time:  0.0 sec
      hmm step time: 0.0
      loop time: 0.7
getting annotations for final partition
  subcluster annotating 1 cluster: 
    running 1 proc
                    calcd:         vtb  2        fwd  0
                     time:  0.1 sec
    reading output
        read 2 hmm output lines with 6 sequences in 2 events  (0 failures)
      hmm step time: 0.1
    read 2 new subcluster annotations: added hashid 2   whole finished 0   subcl finished 0
    running 1 proc
                    calcd:         vtb  1        fwd  0
                     time:  0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.2
  seed cluster size in best partition: 6,  excluding --queries-to-include: 5
      total time: 1.1
[92mvsearch-partition-new-simu[0m       /home/dralph/work/partis/bin/partis partition --dont-write-git-info --infname test/new-results/test/simu.yaml --parameter-dir test/new-results/test/parameters/simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.yaml --naive-vsearch --is-simu --persistent-cachefname test/new-results/cache-new-partition.csv --no-partition-plots --seed 1 --n-procs 10 --outfname test/new-results/vsearch-partition-new-simu.yaml
partitioning     (with test/new-results/test/parameters/simu/hmm)
smith-waterman
  vsearch: 40 / 40 v annotations (0 failed) with 7 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache.yaml
      info for 40 / 40 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 25 (0.625) unproductive
        water time: 0.0
hmm
       naive hfrac bounds: 0.024 0.024
        collapsed 40 sequences into 30 unique naive sequences
    using hfrac bound for vsearch 0.024
    running vsearch 7 times (once for each cdr3 length class): . . . . . . . 
      vsearch time: 0.4
getting annotations for final partition
  subcluster annotating 12 clusters: 
    running 10 procs
                    calcd:         vtb 19        fwd  0
             min-max time:  0.1 - 0.2 sec
    reading output
        read 19 hmm output lines with 40 sequences in 19 events  (0 failures)
      hmm step time: 0.3
    read 19 new subcluster annotations: added hashid 11   whole finished 8   subcl finished 0
    running 10 procs
                    calcd:         vtb  5        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 5 hmm output lines with 11 sequences in 5 events  (0 failures)
      hmm step time: 0.1
    read 5 new subcluster annotations: added hashid 5   whole finished 0   subcl finished 3
    running 10 procs
                    calcd:         vtb  1        fwd  0
             min-max time:  0.0 - 0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.5
      total time: 1.1
[92mget-selection-metrics-new-simu[0m   /home/dralph/work/partis/bin/partis get-selection-metrics --dont-write-git-info --seed 1 --n-procs 10 --outfname test/new-results/partition-new-simu.yaml --selection-metric-fname test/new-results/get-selection-metrics-new-simu.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
getting selection metrics
    calculating selection metrics for 1 cluster with size: 10
      skipping 10 smaller than 10
    inf tree: calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 20 = 0.0500 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 10/13 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
    (AA inf tree, iclust 0): calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 20 = 0.0500 (lbr)
      tree origins: 1 made from cpath
  writing selection metrics to test/new-results/get-selection-metrics-new-simu.yaml
      total time: 0.2
