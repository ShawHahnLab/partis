[92mcache-parameters-data[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --infname test/mishmash.fa --parameter-dir test/new-results-slow/test/parameters/data --sw-cachefname test/new-results-slow/test/parameters/data/sw-cache.yaml --n-max-queries -1 --input-metafnames test/input-meta.yaml --random-seed 1 --n-procs 10
  --input-metafnames: added meta info for 4 sequences from test/input-meta.yaml: multiplicities
  note: running on a lot of sequences (1412) without setting --outfname. Which is ok, but there will be no persistent record of the results (except the parameter directory).
caching parameters
  vsearch: 1268 / 1412 v annotations (144 failed) with 191 v genes in 0.2 sec
    keeping 61 / 220 v genes
smith-waterman  (new-allele fitting)
  vsearch: 1264 / 1412 v annotations (148 failed) with 61 v genes in 0.2 sec
  removing old sw cache test/new-results-slow/test/parameters/data/sw-cache.yaml
    running 10 procs for 1412 seqs
    running 13 procs for 71 seqs
      info for 1370 / 1412 = 0.970   (removed: 42 failed)
      kept 437 (0.309) unproductive
    water time: 2.0  (ig-sw 0.1  processing 0.2)
  no queries for allele finding
smith-waterman  (writing parameters)
  vsearch: 1264 / 1412 v annotations (148 failed) with 61 v genes in 0.2 sec
    running 10 procs for 1370 seqs
    running 13 procs for 29 seqs
      info for 1370 / 1412 = 0.970   (removed: 42 failed)
      kept 437 (0.309) unproductive
        writing sw results to test/new-results-slow/test/parameters/data/sw-cache.yaml
    writing parameters to test/new-results-slow/test/parameters/data/sw (2.0 sec)
    water time: 4.7  (ig-sw 2.9  processing 0.2)
  writing hmms (0.4 sec)
hmm
    skipping matches from 4 genes without enough counts: [95mh[0m[91mj[0m[95m4[0m[93m01[0m [95mh[0m[91mj[0m[95m6[0m[93m04[0m [95mh[0m[91mj[0m[95m4[0m[93m03[0m [95mh[0m[91mj[0m[95m6[0m[93m01[0m
    running 10 procs
                    calcd:         vtb 1370        fwd    0
             min-max time:  4.1 - 5.1 sec
    reading output
        read 1370 hmm output lines with 1365 sequences in 1365 events  (5 failures)
          [91mwarning[0m no valid paths: -5294497590599348090 -1651760806376077044 -3094020580816257316 6182728664197942741 6880877555932742798
    writing parameters to test/new-results-slow/test/parameters/data/hmm (1.7 sec)
         infra time: 2.8
      hmm step time: 7.9
  writing hmms (0.7 sec)
      total time: 16.4
[92msimulate[0m                         /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/new-results-slow/test/parameters/data --n-sim-events 200 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --random-seed 1 --n-procs 10 --outfname test/new-results-slow/test/simu.yaml --indel-frequency 0.2
simulating
      --> proc 2
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 93 seqs in 3.6s (3.2s of which was running bppseqgen)
      total time: 5.6

      --> proc 4
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 85 seqs in 3.6s (3.2s of which was running bppseqgen)
      total time: 5.5

      --> proc 0
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 68 seqs in 3.8s (3.5s of which was running bppseqgen)
      total time: 5.8

      --> proc 1
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 107 seqs in 3.8s (3.4s of which was running bppseqgen)
      total time: 5.8

      --> proc 8
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 100 seqs in 3.9s (3.6s of which was running bppseqgen)
      total time: 5.8

      --> proc 3
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 120 seqs in 3.9s (3.6s of which was running bppseqgen)
      total time: 5.9

      --> proc 7
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 92 seqs in 3.9s (3.5s of which was running bppseqgen)
      total time: 5.9

      --> proc 5
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 116 seqs in 4.0s (3.6s of which was running bppseqgen)
      total time: 5.9

      --> proc 9
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 119 seqs in 4.2s (3.7s of which was running bppseqgen)
      total time: 6.1

      --> proc 6
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 126 seqs in 4.5s (4.0s of which was running bppseqgen)
      total time: 6.5

   read 200 events with 1026 seqs from 10 .yaml files
      total time: 7.2
[92mcache-parameters-simu[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --infname test/new-results-slow/test/simu.yaml --parameter-dir test/new-results-slow/test/parameters/simu --sw-cachefname test/new-results-slow/test/parameters/simu/sw-cache.yaml --is-simu --random-seed 1 --n-procs 10
  note: running on a lot of sequences (1026) without setting --outfname. Which is ok, but there will be no persistent record of the results (except the parameter directory).
caching parameters
  vsearch: 1024 / 1026 v annotations (2 failed) with 65 v genes in 0.2 sec
    keeping 42 / 220 v genes
    [91mmissing[0m 12 simulation genes (counts): [95mh[0m[91mv[0m[95m1[0m[95m-3[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69-2[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-70[0m[93m13[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-11[0m[93m06[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-13[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-13[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-20[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-43[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-2[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-4[0m[93m07[0m 0  [95mh[0m[91mv[0m[95m5[0m[95m-10-1[0m[93m04[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 1024 / 1026 v annotations (2 failed) with 41 v genes in 0.3 sec
  removing old sw cache test/new-results-slow/test/parameters/simu/sw-cache.yaml
    running 10 procs for 1026 seqs
    running 13 procs for 35 seqs
      info for 1026 / 1026 = 1.000   (removed: 0 failed)
      kept 573 (0.558) unproductive
    water time: 1.9  (ig-sw 0.1  processing 0.2)
smith-waterman  (writing parameters)
  vsearch: 1024 / 1026 v annotations (2 failed) with 41 v genes in 0.3 sec
    running 10 procs for 1026 seqs
    running 13 procs for 35 seqs
      info for 1026 / 1026 = 1.000   (removed: 0 failed)
      kept 573 (0.558) unproductive
        writing sw results to test/new-results-slow/test/parameters/simu/sw-cache.yaml
    writing parameters to test/new-results-slow/test/parameters/simu/sw (2.5 sec)
    water time: 5.3  (ig-sw 3.2  processing 0.4)
  writing hmms (0.6 sec)
hmm
    skipping matches from 3 genes without enough counts: [95mh[0m[91mj[0m[95m4[0m[93m01[0m [95mh[0m[91mj[0m[95m4[0m[93m03[0m [95mh[0m[91mj[0m[95m6[0m[93m01[0m
    running 10 procs
                    calcd:         vtb 1026        fwd    0
             min-max time:  2.1 - 2.4 sec
    reading output
        read 1026 hmm output lines with 1026 sequences in 1026 events  (0 failures)
    writing parameters to test/new-results-slow/test/parameters/simu/hmm (2.1 sec)
    writing parameters to test/new-results-slow/test/parameters/simu/true (2.2 sec)
         infra time: 5.9
      hmm step time: 8.4
  writing hmms (0.6 sec)
      total time: 18.8
[92mannotate-new-simu[0m                /home/dralph/work/partis/bin/partis annotate --dont-write-git-info --infname test/new-results-slow/test/simu.yaml --parameter-dir test/new-results-slow/test/parameters/simu --sw-cachefname test/new-results-slow/test/parameters/simu/sw-cache.yaml --plot-annotation-performance --is-simu --plotdir test/new-results-slow/annotate-new-simu-annotation-performance --only-csv-plots --random-seed 1 --n-procs 10 --outfname test/new-results-slow/annotate-new-simu.yaml
annotating    (with test/new-results-slow/test/parameters/simu/hmm)
smith-waterman
  vsearch: 1024 / 1026 v annotations (2 failed) with 41 v genes in 0.2 sec
        reading sw results from test/new-results-slow/test/parameters/simu/sw-cache.yaml
      info for 1026 / 1026 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 573 (0.558) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 56 queries with different true and inferred net shm indel lengths: 8932316810628072095 0659584548811842774 1907413591497171450 1313564414865612573 7313925889346239196 0731658054797337526 0124127571189216992 4803935184235625109 4521387082179107516 6163371271352906028 2661524629317398068 7211472592842049700 5275225551574138175 8792949787747371478 2627284416925591803 0660737201396484844 7138232978272678395 5665531665867722227 3311493878297580215 4561551773723828878 3473813732256909791 0642622376706135670 0680384605400469109 0128308740891463606 6885160241280380759 2379900308879493011 4203140549730213445 0610389871223680133 7812413597430296784 8952594565831428575 0231581636037125695 8168336592863033265 2541026677860427438 7299329197133768495 4494002205663150372 9054612736811798592 3738835417246464256 6124119715168335250 0413726684559657262 4851212237565334880 3141560521471729618 8312549673993043302 6751426816223705656 8889264258610928046 6973473457971048097 6858753879686814663 7518191438018133173 6863407436027101055 2021955038604056806 1825030195571712911 0593301923278609658 7026675222450334149 5593910730480616589 5090362829367467144 1231965758157493401 0782010048372308923
(0.0 sec)
        water time: 1.1
hmm
    running 10 procs
                    calcd:         vtb 1026        fwd    0
             min-max time:  2.1 - 2.3 sec
    reading output
        read 1026 hmm output lines with 1026 sequences in 1026 events  (0 failures)
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 56 queries with different true and inferred net shm indel lengths: 5665531665867722227 7026675222450334149 0659584548811842774 5275225551574138175 0660737201396484844 0610389871223680133 3141560521471729618 0593301923278609658 5090362829367467144 2661524629317398068 0128308740891463606 7812413597430296784 4494002205663150372 3738835417246464256 6973473457971048097 1907413591497171450 8952594565831428575 6751426816223705656 7518191438018133173 5593910730480616589 8932316810628072095 0731658054797337526 0231581636037125695 1313564414865612573 0642622376706135670 0680384605400469109 8168336592863033265 2541026677860427438 0413726684559657262 1825030195571712911 0782010048372308923 4803935184235625109 7211472592842049700 3311493878297580215 3473813732256909791 4851212237565334880 8312549673993043302 8889264258610928046 1231965758157493401 0124127571189216992 4521387082179107516 8792949787747371478 4561551773723828878 6885160241280380759 2379900308879493011 7299329197133768495 6863407436027101055 4203140549730213445 9054612736811798592 6124119715168335250 7313925889346239196 6163371271352906028 2627284416925591803 7138232978272678395 6858753879686814663 2021955038604056806
(0.0 sec)
         infra time: 1.1
      hmm step time: 3.5
      total time: 5.5
[92mmulti-annotate-new-simu[0m          /home/dralph/work/partis/bin/partis annotate --dont-write-git-info --infname test/new-results-slow/test/simu.yaml --parameter-dir test/new-results-slow/test/parameters/simu --sw-cachefname test/new-results-slow/test/parameters/simu/sw-cache.yaml --plot-annotation-performance --simultaneous-true-clonal-seqs --is-simu --plotdir test/new-results-slow/multi-annotate-new-simu-annotation-performance --only-csv-plots --random-seed 1 --n-procs 10 --outfname test/new-results-slow/multi-annotate-new-simu.yaml
annotating    (with test/new-results-slow/test/parameters/simu/hmm)
smith-waterman
  vsearch: 1024 / 1026 v annotations (2 failed) with 41 v genes in 0.3 sec
        reading sw results from test/new-results-slow/test/parameters/simu/sw-cache.yaml
      info for 1026 / 1026 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 573 (0.558) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 56 queries with different true and inferred net shm indel lengths: 8932316810628072095 0659584548811842774 1907413591497171450 1313564414865612573 7313925889346239196 0731658054797337526 0124127571189216992 4803935184235625109 4521387082179107516 6163371271352906028 2661524629317398068 7211472592842049700 5275225551574138175 8792949787747371478 2627284416925591803 0660737201396484844 7138232978272678395 5665531665867722227 3311493878297580215 4561551773723828878 3473813732256909791 0642622376706135670 0680384605400469109 0128308740891463606 6885160241280380759 2379900308879493011 4203140549730213445 0610389871223680133 7812413597430296784 8952594565831428575 0231581636037125695 8168336592863033265 2541026677860427438 7299329197133768495 4494002205663150372 9054612736811798592 3738835417246464256 6124119715168335250 0413726684559657262 4851212237565334880 3141560521471729618 8312549673993043302 6751426816223705656 8889264258610928046 6973473457971048097 6858753879686814663 7518191438018133173 6863407436027101055 2021955038604056806 1825030195571712911 0593301923278609658 7026675222450334149 5593910730480616589 5090362829367467144 1231965758157493401 0782010048372308923
(0.0 sec)
        water time: 1.1
hmm
  --simultaneous-true-clonal-seqs: grouping seqs according to true partition
  [93mwarning[0m split apart 38 clusters that contained multiple cdr3 lengths (total clusters: 200 --> 245)
      cluster splits:   6 --> 1 5,  12 --> 1 11,  10 --> 1 9,  15 --> 1 14,   7 --> 1 5 1,   7 --> 1 6,  12 --> 11 1,   4 --> 1 3,   4 --> 3 1,   7 --> 6 1,   5 --> 4 1,   9 --> 8 1,   4 --> 3 1,   6 --> 1 5,   5 --> 1 4,   3 --> 1 2,   6 --> 5 1,   7 --> 6 1,   3 --> 1 2,  12 --> 1 11,  17 --> 1 14 1 1,  19 --> 18 1,   4 --> 1 2 1,   3 --> 1 2,   2 --> 1 1,   2 --> 1 1,  12 --> 1 11,   6 --> 5 1,  12 --> 1 1 9 1,   2 --> 1 1,   4 --> 3 1,   3 --> 2 1,  16 --> 15 1,   8 --> 7 1,   2 --> 1 1,  12 --> 1 11,  14 --> 1 1 12,   4 --> 3 1
  subcluster annotating 245 clusters: 
    running 10 procs
                    calcd:         vtb  448        fwd    0
             min-max time:  1.3 - 1.8 sec
    reading output
        read 448 hmm output lines with 1026 sequences in 448 events  (0 failures)
         infra time: 0.5
      hmm step time: 2.3
    read 448 new subcluster annotations: added hashid 308   whole finished 140   subcl finished 0
    running 10 procs
                    calcd:         vtb  132        fwd    0
             min-max time:  0.6 - 1.0 sec
    reading output
        read 132 hmm output lines with 308 sequences in 132 events  (0 failures)
         infra time: 0.1
      hmm step time: 1.2
    read 132 new subcluster annotations: added hashid 132   whole finished 0   subcl finished 79
    running 10 procs
                    calcd:         vtb   26        fwd    0
             min-max time:  0.1 - 0.5 sec
    reading output
        read 26 hmm output lines with 53 sequences in 26 events  (0 failures)
      hmm step time: 0.6
    read 26 new subcluster annotations: added hashid 26   whole finished 0   subcl finished 26
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 56 queries with different true and inferred net shm indel lengths: 6751426816223705656 3473813732256909791 8792949787747371478 2661524629317398068 1907413591497171450 7812413597430296784 0231581636037125695 5275225551574138175 5593910730480616589 7026675222450334149 0128308740891463606 1231965758157493401 0680384605400469109 0593301923278609658 6163371271352906028 0731658054797337526 8952594565831428575 4561551773723828878 4494002205663150372 8932316810628072095 7518191438018133173 5090362829367467144 7313925889346239196 6124119715168335250 3311493878297580215 1825030195571712911 1313564414865612573 8889264258610928046 2627284416925591803 3141560521471729618 4851212237565334880 0413726684559657262 7299329197133768495 4521387082179107516 4803935184235625109 0642622376706135670 0660737201396484844 0659584548811842774 6885160241280380759 0782010048372308923 6973473457971048097 8168336592863033265 0610389871223680133 2379900308879493011 4203140549730213445 9054612736811798592 0124127571189216992 8312549673993043302 7211472592842049700 3738835417246464256 6863407436027101055 2541026677860427438 6858753879686814663 5665531665867722227 7138232978272678395 2021955038604056806
(0.0 sec)
    subcluster annotation time 5.2
      total time: 7.2
[92mpartition-new-simu[0m               /home/dralph/work/partis/bin/partis partition --dont-write-git-info --infname test/new-results-slow/test/simu.yaml --parameter-dir test/new-results-slow/test/parameters/simu --sw-cachefname test/new-results-slow/test/parameters/simu/sw-cache.yaml --plot-annotation-performance --is-simu --persistent-cachefname test/new-results-slow/cache-new-partition.csv --plotdir test/new-results-slow/partition-new-simu-annotation-performance --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --outfname test/new-results-slow/partition-new-simu.yaml
partitioning     (with test/new-results-slow/test/parameters/simu/hmm)
smith-waterman
  vsearch: 1024 / 1026 v annotations (2 failed) with 41 v genes in 0.3 sec
        reading sw results from test/new-results-slow/test/parameters/simu/sw-cache.yaml
      info for 1026 / 1026 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 573 (0.558) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 56 queries with different true and inferred net shm indel lengths: 8932316810628072095 0659584548811842774 1907413591497171450 1313564414865612573 7313925889346239196 0731658054797337526 0124127571189216992 4803935184235625109 4521387082179107516 6163371271352906028 2661524629317398068 7211472592842049700 5275225551574138175 8792949787747371478 2627284416925591803 0660737201396484844 7138232978272678395 5665531665867722227 3311493878297580215 4561551773723828878 3473813732256909791 0642622376706135670 0680384605400469109 0128308740891463606 6885160241280380759 2379900308879493011 4203140549730213445 0610389871223680133 7812413597430296784 8952594565831428575 0231581636037125695 8168336592863033265 2541026677860427438 7299329197133768495 4494002205663150372 9054612736811798592 3738835417246464256 6124119715168335250 0413726684559657262 4851212237565334880 3141560521471729618 8312549673993043302 6751426816223705656 8889264258610928046 6973473457971048097 6858753879686814663 7518191438018133173 6863407436027101055 2021955038604056806 1825030195571712911 0593301923278609658 7026675222450334149 5593910730480616589 5090362829367467144 1231965758157493401 0782010048372308923
(0.0 sec)
        water time: 1.1
hmm
caching all 1026 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 1026        fwd    0
                   merged:       hfrac    0     lratio    0
             min-max time:  2.1 - 2.3 sec
         infra time: 0.1
      hmm step time: 2.5
   collapsed 1026 queries into 485 clusters with identical naive seqs (0.0 sec)
485 clusters with 10 procs
       setting naive hfrac bounds: 0.015 0.087
    running 10 procs
          read from cache:  naive-seqs 1026   logprobs    0
                    calcd:         vtb  223        fwd  298
                   merged:       hfrac   45     lratio   30
             min-max time:  1.2 - 2.9 sec
         infra time: 0.2
      hmm step time: 3.2
410 clusters with 7 procs
       naive hfrac bounds: 0.015 0.087
    running 7 procs
          read from cache:  naive-seqs 1249   logprobs  298
                    calcd:         vtb   70        fwd  146
                   merged:       hfrac   44     lratio   18
             min-max time:  1.1 - 2.3 sec
         infra time: 0.2
      hmm step time: 2.6
348 clusters with 5 procs
       naive hfrac bounds: 0.015 0.087
    running 5 procs
          read from cache:  naive-seqs 1322   logprobs  444
                    calcd:         vtb   35        fwd  101
                   merged:       hfrac   26     lratio    8
             min-max time:  1.2 - 3.4 sec
         infra time: 0.3
      hmm step time: 3.7
314 clusters with 3 procs
       naive hfrac bounds: 0.015 0.087
    running 3 procs
          read from cache:  naive-seqs 1359   logprobs  545
                    calcd:         vtb   40        fwd   99
                   merged:       hfrac   33     lratio    9
             min-max time:  3.2 - 3.8 sec
         infra time: 0.2
      hmm step time: 4.0
272 clusters with 2 procs
       naive hfrac bounds: 0.015 0.087
    running 2 procs
          read from cache:  naive-seqs 1402   logprobs  644
                    calcd:         vtb   31        fwd  104
                   merged:       hfrac   21     lratio   10
             min-max time:  3.1 - 5.7 sec
         infra time: 0.2
      hmm step time: 5.9
241 clusters with 2 procs
       naive hfrac bounds: 0.015 0.087
    running 2 procs
          read from cache:  naive-seqs 1434   logprobs  748
                    calcd:         vtb   13        fwd   43
                   merged:       hfrac   10     lratio    3
             min-max time:  1.7 - 2.9 sec
         infra time: 0.2
      hmm step time: 3.1
228 clusters with 2 procs
       naive hfrac bounds: 0.015 0.087
    running 2 procs
          read from cache:  naive-seqs 1449   logprobs  791
                    calcd:         vtb    7        fwd   49
                   merged:       hfrac    6     lratio    2
             min-max time:  1.2 - 4.4 sec
         infra time: 0.2
      hmm step time: 4.6
220 clusters with 2 procs
       naive hfrac bounds: 0.015 0.087
    running 2 procs
          read from cache:  naive-seqs 1457   logprobs  840
                    calcd:         vtb    1        fwd    3
                   merged:       hfrac    1     lratio    0
             min-max time:  0.4 - 0.8 sec
         infra time: 0.2
      hmm step time: 1.0
219 clusters with 1 proc
       naive hfrac bounds: 0.015 0.087
    running 1 proc
          read from cache:  naive-seqs 1458   logprobs  843
                    calcd:         vtb    1        fwd  136
                   merged:       hfrac    2     lratio    0
                     time:  5.1 sec
      hmm step time: 5.2
  [93mnote[0m not merging entire cpath history
      loop time: 33.4
getting annotations for final partition
  subcluster annotating 218 clusters: 
    running 10 procs
                    calcd:         vtb  435        fwd    0
             min-max time:  1.4 - 1.7 sec
    reading output
        read 435 hmm output lines with 1026 sequences in 435 events  (0 failures)
         infra time: 0.5
      hmm step time: 2.2
    read 435 new subcluster annotations: added hashid 309   whole finished 126   subcl finished 0
    running 10 procs
                    calcd:         vtb  128        fwd    0
             min-max time:  0.7 - 1.1 sec
    reading output
        read 128 hmm output lines with 309 sequences in 128 events  (0 failures)
         infra time: 0.1
      hmm step time: 1.3
    read 128 new subcluster annotations: added hashid 128   whole finished 0   subcl finished 64
    running 10 procs
                    calcd:         vtb   31        fwd    0
             min-max time:  0.3 - 0.4 sec
    reading output
        read 31 hmm output lines with 64 sequences in 31 events  (0 failures)
      hmm step time: 0.5
    read 31 new subcluster annotations: added hashid 31   whole finished 0   subcl finished 26
    running 2 procs
                    calcd:         vtb    2        fwd    0
             min-max time:  0.2 - 0.2 sec
    reading output
        read 2 hmm output lines with 5 sequences in 2 events  (0 failures)
      hmm step time: 0.3
    read 2 new subcluster annotations: added hashid 2   whole finished 0   subcl finished 2
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 56 queries with different true and inferred net shm indel lengths: 1825030195571712911 0124127571189216992 0680384605400469109 5090362829367467144 8792949787747371478 0642622376706135670 6751426816223705656 6124119715168335250 0128308740891463606 0231581636037125695 0413726684559657262 0593301923278609658 0610389871223680133 0659584548811842774 0660737201396484844 0731658054797337526 0782010048372308923 1231965758157493401 1313564414865612573 1907413591497171450 2021955038604056806 2379900308879493011 2541026677860427438 2627284416925591803 2661524629317398068 3141560521471729618 3311493878297580215 3473813732256909791 3738835417246464256 4203140549730213445 4494002205663150372 4521387082179107516 4561551773723828878 4803935184235625109 4851212237565334880 5275225551574138175 5593910730480616589 5665531665867722227 6163371271352906028 6858753879686814663 6863407436027101055 6885160241280380759 6973473457971048097 7026675222450334149 7138232978272678395 7211472592842049700 7299329197133768495 7313925889346239196 7518191438018133173 7812413597430296784 8168336592863033265 8312549673993043302 8889264258610928046 8932316810628072095 8952594565831428575 9054612736811798592
(0.0 sec)
    subcluster annotation time 5.5
      total time: 44.2
[92mseed-partition-new-simu[0m          /home/dralph/work/partis/bin/partis partition --dont-write-git-info --infname test/new-results-slow/test/simu.yaml --parameter-dir test/new-results-slow/test/parameters/simu --sw-cachefname test/new-results-slow/test/parameters/simu/sw-cache.yaml --is-simu --persistent-cachefname test/new-results-slow/cache-new-partition.csv --seed-unique-id 7812413597430296784 --random-seed 1 --n-procs 10 --outfname test/new-results-slow/seed-partition-new-simu.yaml
partitioning     (with test/new-results-slow/test/parameters/simu/hmm)
smith-waterman
  vsearch: 1024 / 1026 v annotations (2 failed) with 41 v genes in 0.3 sec
        reading sw results from test/new-results-slow/test/parameters/simu/sw-cache.yaml
      info for 1026 / 1026 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 573 (0.558) unproductive
      removed 1024 / 1026 = 1.00 sequences with cdr3 length different from seed sequence (leaving 2)
        water time: 0.4
hmm
   collapsed 2 queries into 2 clusters with identical naive seqs (0.0 sec)
  reducing n procs to number of clusters: 10 --> 2
2 clusters with 2 procs
       setting naive hfrac bounds: 0.015 0.087
    running 2 procs
          read from cache:  naive-seqs 1460   logprobs  979
                    calcd:         vtb    0        fwd    0
                   merged:       hfrac    0     lratio    0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/594930/hmm_cached_info.csv
      hmm step time: 0.1
      removed 1 sequences in unseeded clusters, split 2 seeded clusters into 1 singletons, and merged these into 1 clusters with identical naive seqs (0.0 sec)
        new n_procs 1 (initial seqs/proc: 1.00   new seqs/proc: 1.00
1 clusters with 1 proc
       naive hfrac bounds: 0.015 0.087
    running 1 proc
          read from cache:  naive-seqs 1460   logprobs  979
                    calcd:         vtb    0        fwd    0
                   merged:       hfrac    0     lratio    0
                     time:  0.0 sec
      hmm step time: 0.1
      loop time: 0.2
getting annotations for final partition
    running 1 proc
                    calcd:         vtb    1        fwd    0
                     time:  0.1 sec
    reading output
        read 1 hmm output lines with 1 sequences in 1 events  (0 failures)
      hmm step time: 0.1
  seed cluster size in best partition: 1, excluding seed seq: 0
      total time: 1.6
[92mvsearch-partition-new-simu[0m       /home/dralph/work/partis/bin/partis partition --dont-write-git-info --infname test/new-results-slow/test/simu.yaml --parameter-dir test/new-results-slow/test/parameters/simu --sw-cachefname test/new-results-slow/test/parameters/simu/sw-cache.yaml --naive-vsearch --is-simu --persistent-cachefname test/new-results-slow/cache-new-partition.csv --random-seed 1 --n-procs 10 --outfname test/new-results-slow/vsearch-partition-new-simu.yaml
partitioning     (with test/new-results-slow/test/parameters/simu/hmm)
smith-waterman
  vsearch: 1024 / 1026 v annotations (2 failed) with 41 v genes in 0.3 sec
        reading sw results from test/new-results-slow/test/parameters/simu/sw-cache.yaml
      info for 1026 / 1026 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 573 (0.558) unproductive
        water time: 0.5
hmm
      [44m--naive-vsearch[0m setting naive hfrac bounds: 0.023 0.023
        collapsed 1026 sequences into 47 unique naive sequences (0.0 sec)
    using hfrac bound for vsearch 0.023
    running vsearch 47 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 3.1
getting annotations for final partition
  subcluster annotating 239 clusters: 
    running 10 procs
                    calcd:         vtb  450        fwd    0
             min-max time:  1.4 - 1.8 sec
    reading output
        read 450 hmm output lines with 1026 sequences in 450 events  (0 failures)
         infra time: 0.5
      hmm step time: 2.3
    read 450 new subcluster annotations: added hashid 300   whole finished 150   subcl finished 0
    running 10 procs
                    calcd:         vtb  123        fwd    0
             min-max time:  0.6 - 1.0 sec
    reading output
        read 123 hmm output lines with 300 sequences in 123 events  (0 failures)
      hmm step time: 1.1
    read 123 new subcluster annotations: added hashid 123   whole finished 0   subcl finished 65
    running 10 procs
                    calcd:         vtb   27        fwd    0
             min-max time:  0.1 - 0.4 sec
    reading output
        read 27 hmm output lines with 58 sequences in 27 events  (0 failures)
      hmm step time: 0.5
    read 27 new subcluster annotations: added hashid 27   whole finished 0   subcl finished 22
    running 2 procs
                    calcd:         vtb    2        fwd    0
             min-max time:  0.2 - 0.3 sec
    reading output
        read 2 hmm output lines with 5 sequences in 2 events  (0 failures)
      hmm step time: 0.3
    read 2 new subcluster annotations: added hashid 2   whole finished 0   subcl finished 2
    subcluster annotation time 4.8
      total time: 9.3
[92mget-selection-metrics-new-simu[0m   /home/dralph/work/partis/bin/partis get-selection-metrics --dont-write-git-info --random-seed 1 --n-procs 10 --outfname test/new-results-slow/partition-new-simu.yaml --selection-metric-fname test/new-results-slow/get-selection-metrics-new-simu.yaml --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
getting selection metrics: lbi lbr aa-lbi aa-lbr cons-dist-aa
    calculating selection metrics for 28 clusters with sizes: 55 36 24 18 18 17 16 15 15 15 14 14 14 13 12 12 12 12 12 12 11 11 11 11 10 10 10 10
      skipping 190 smaller than 10
    inf tree: calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 1 = 0.0025 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 78/93 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
    (AA inf tree, iclust 0): calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 1 = 0.0025 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 56/62 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 43/45 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 3): skipped 20/27 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 4): skipped 9/21 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 5): skipped 19/26 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 6): skipped 29/30 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 7): skipped 19/24 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 8): skipped 24/26 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 9): skipped 16/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 10): skipped 23/25 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 12): skipped 14/19 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 13): skipped 19/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 14): skipped 21/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 15): skipped 21/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 16): skipped 20/21 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 17): skipped 15/19 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 18): skipped 21/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 19): skipped 21/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 20): skipped 17/19 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 21): skipped 16/18 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 22): skipped 13/17 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 23): skipped 19/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 24): skipped 13/16 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 25): skipped 15/17 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 26): skipped 6/12 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 27): skipped 3/11 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      tree origins: 28 made from cpath
  writing selection metrics to test/new-results-slow/get-selection-metrics-new-simu.yaml
      total time: 4.9
