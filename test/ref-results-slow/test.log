[92mcache-parameters-data[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --infname test/mishmash.fa --parameter-dir test/new-results-slow/test/parameters/data --sw-cachefname test/new-results-slow/test/parameters/data/sw-cache.yaml --n-max-queries -1 --input-metafname test/input-meta.yaml --random-seed 1 --n-procs 10
  --input-metafname: added meta info for 4 sequences from test/input-meta.yaml: multiplicities
  note: running on a lot of sequences (1412) without setting --outfname. Which is ok, but there will be no persistent record of the results (except the parameter directory).
caching parameters
  vsearch: 1268 / 1412 v annotations (144 failed) with 191 v genes in 0.2 sec
    keeping 61 / 220 v genes
smith-waterman  (new-allele fitting)
  vsearch: 1264 / 1412 v annotations (148 failed) with 61 v genes in 0.2 sec
  removing old sw cache test/new-results-slow/test/parameters/data/sw-cache.yaml
    running 10 procs for 1412 seqs
    running 13 procs for 71 seqs
      info for 1370 / 1412 = 0.970   (removed: 42 failed)
      kept 437 (0.309) unproductive
    water time: 1.9  (ig-sw 0.1  processing 0.2)
  no queries for allele finding
smith-waterman  (writing parameters)
  vsearch: 1264 / 1412 v annotations (148 failed) with 61 v genes in 0.2 sec
    running 10 procs for 1370 seqs
    running 13 procs for 29 seqs
      info for 1370 / 1412 = 0.970   (removed: 42 failed)
      kept 437 (0.309) unproductive
        writing sw results to test/new-results-slow/test/parameters/data/sw-cache.yaml
    writing parameters to test/new-results-slow/test/parameters/data/sw (2.0 sec)
    water time: 4.6  (ig-sw 2.8  processing 0.2)
  writing hmms (0.9 sec)
hmm
    skipping matches from 4 genes without enough counts: [95mh[0m[91mj[0m[95m4[0m[93m01[0m [95mh[0m[91mj[0m[95m6[0m[93m04[0m [95mh[0m[91mj[0m[95m4[0m[93m03[0m [95mh[0m[91mj[0m[95m6[0m[93m01[0m
    running 10 procs
                    calcd:         vtb 1370        fwd    0
             min-max time:  4.1 - 5.0 sec
    reading output
        read 1370 hmm output lines with 1365 sequences in 1365 events  (5 failures)
          [91mwarning[0m no valid paths: -5294497590599348090 -1651760806376077044 -3094020580816257316 6182728664197942741 6880877555932742798
    writing parameters to test/new-results-slow/test/parameters/data/hmm (1.6 sec)
         infra time: 2.7
      hmm step time: 7.7
  writing hmms (0.8 sec)
      total time: 16.7
[92msimulate[0m                         /home/dralph/work/partis/bin/partis simulate --dont-write-git-info --parameter-dir test/new-results-slow/test/parameters/data --n-sim-events 200 --n-trees 200 --n-leaf-distribution geometric --n-leaves 5 --random-seed 1 --n-procs 10 --outfname test/new-results-slow/test/simu.yaml --indel-frequency 0.2
simulating
      --> proc 0
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 68 seqs in 3.4s (3.1s of which was running bppseqgen)
      total time: 5.3

      --> proc 4
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 85 seqs in 3.7s (3.3s of which was running bppseqgen)
      total time: 5.5

      --> proc 2
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 93 seqs in 3.7s (3.3s of which was running bppseqgen)
      total time: 5.7

      --> proc 1
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 107 seqs in 3.8s (3.3s of which was running bppseqgen)
      total time: 5.7

      --> proc 9
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 119 seqs in 3.8s (3.5s of which was running bppseqgen)
      total time: 5.6

      --> proc 7
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 92 seqs in 3.9s (3.5s of which was running bppseqgen)
      total time: 5.7

      --> proc 5
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 116 seqs in 4.0s (3.5s of which was running bppseqgen)
      total time: 5.9

      --> proc 6
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 126 seqs in 4.0s (3.6s of which was running bppseqgen)
      total time: 5.9

      --> proc 8
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 100 seqs in 4.1s (3.6s of which was running bppseqgen)
      total time: 5.9

      --> proc 3
    reco params: test/new-results-slow/test/parameters/data/hmm     shm params: test/new-results-slow/test/parameters/data/hmm
    made 20 events with 120 seqs in 4.1s (3.7s of which was running bppseqgen)
      total time: 5.9

   read 200 events with 1026 seqs from 10 .yaml files
      total time: 6.7
[92mcache-parameters-simu[0m            /home/dralph/work/partis/bin/partis cache-parameters --dont-write-git-info --infname test/new-results-slow/test/simu.yaml --parameter-dir test/new-results-slow/test/parameters/simu --sw-cachefname test/new-results-slow/test/parameters/simu/sw-cache.yaml --is-simu --random-seed 1 --n-procs 10
  note: running on a lot of sequences (1026) without setting --outfname. Which is ok, but there will be no persistent record of the results (except the parameter directory).
caching parameters
  vsearch: 1020 / 1026 v annotations (6 failed) with 73 v genes in 0.1 sec
    keeping 42 / 220 v genes
    [91mmissing[0m 13 simulation genes (counts): [95mh[0m[91mv[0m[95m1[0m[95m-24[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-3[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69-2[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-20[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-21[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-43[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-73[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-74[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-9[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-2[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-4[0m[93m07[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93m10[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 1020 / 1026 v annotations (6 failed) with 40 v genes in 0.3 sec
  removing old sw cache test/new-results-slow/test/parameters/simu/sw-cache.yaml
    running 10 procs for 1026 seqs
    running 13 procs for 36 seqs
      info for 1026 / 1026 = 1.000   (removed: 0 failed)
      kept 656 (0.639) unproductive
    water time: 1.8  (ig-sw 0.1  processing 0.2)
smith-waterman  (writing parameters)
  vsearch: 1020 / 1026 v annotations (6 failed) with 40 v genes in 0.3 sec
    running 10 procs for 1026 seqs
    running 13 procs for 36 seqs
      info for 1026 / 1026 = 1.000   (removed: 0 failed)
      kept 656 (0.639) unproductive
        writing sw results to test/new-results-slow/test/parameters/simu/sw-cache.yaml
    writing parameters to test/new-results-slow/test/parameters/simu/sw (2.2 sec)
    water time: 4.9  (ig-sw 2.9  processing 0.3)
  writing hmms (0.6 sec)
hmm
    skipping matches from 3 genes without enough counts: [95mh[0m[91mj[0m[95m3[0m[93m01[0m [95mh[0m[91mj[0m[95m4[0m[93m01[0m [95mh[0m[91mj[0m[95m4[0m[93m03[0m
    running 10 procs
                    calcd:         vtb 1026        fwd    0
             min-max time:  2.1 - 2.4 sec
    reading output
        read 1026 hmm output lines with 1026 sequences in 1026 events  (0 failures)
    writing parameters to test/new-results-slow/test/parameters/simu/hmm (1.9 sec)
    writing parameters to test/new-results-slow/test/parameters/simu/true (1.9 sec)
         infra time: 5.4
      hmm step time: 8.0
  writing hmms (1.1 sec)
      total time: 18.2
[92mannotate-new-simu[0m                /home/dralph/work/partis/bin/partis annotate --dont-write-git-info --infname test/new-results-slow/test/simu.yaml --parameter-dir test/new-results-slow/test/parameters/simu --sw-cachefname test/new-results-slow/test/parameters/simu/sw-cache.yaml --plot-annotation-performance --is-simu --plotdir test/new-results-slow/annotate-new-simu-annotation-performance --only-csv-plots --random-seed 1 --n-procs 10 --outfname test/new-results-slow/annotate-new-simu.yaml
annotating    (with test/new-results-slow/test/parameters/simu/hmm)
smith-waterman
  vsearch: 1020 / 1026 v annotations (6 failed) with 40 v genes in 0.3 sec
        reading sw results from test/new-results-slow/test/parameters/simu/sw-cache.yaml
      info for 1026 / 1026 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 656 (0.639) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 55 queries with different true and inferred net shm indel lengths: 4777290622024385517 4732638098651962386 5956845155556020142 4999530475943846830 5529595052006000261 1420512012172628976 9137342635559226893 7345200321981110598 7410422430398199200 7423565846323818162 7911215360874970228 2659072139582755612 5788466811053155663 6056256726585810395 6350438668073464091 4513532919056631645 1149613973223769416 1051942552960780586 5998617262116711862 2084766260956091123 5002088609693091534 8800133256033921718 4037409418259451775 1790726256523740481 5210855817825286317 1632308509999052946 6013981858393765397 8599230751232947691 6573090021774117441 0045610977169263993 3298903786046404753 4456223632834332176 5443601811981978372 4600783374037304762 0425531810241509889 8666583568833898780 7815264963537972858 7997983189621976239 6891961031777574454 1283149354348662917 7093895658746756694 7722244057175391440 9219504801302075685 8657669394381163308 3845052717027318577 7135751034640280107 7615245074831214398 2587149021754440184 3740852116228277996 7336112427621948265 6884289445410691773 4584292685624034653 3784961526112309284 6965481766615318033 0501059967747087483
(0.0 sec)
        water time: 1.1
hmm
    running 10 procs
                    calcd:         vtb 1026        fwd    0
             min-max time:  2.1 - 2.4 sec
    reading output
        read 1026 hmm output lines with 1026 sequences in 1026 events  (0 failures)
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 55 queries with different true and inferred net shm indel lengths: 1051942552960780586 5210855817825286317 1632308509999052946 6013981858393765397 7336112427621948265 4777290622024385517 5443601811981978372 2587149021754440184 5956845155556020142 7345200321981110598 6350438668073464091 2084766260956091123 7997983189621976239 7093895658746756694 3784961526112309284 4732638098651962386 1420512012172628976 8599230751232947691 4600783374037304762 6891961031777574454 9219504801302075685 3845052717027318577 6884289445410691773 4999530475943846830 5998617262116711862 7722244057175391440 9137342635559226893 7423565846323818162 6573090021774117441 0425531810241509889 7135751034640280107 0501059967747087483 2659072139582755612 1149613973223769416 4584292685624034653 7911215360874970228 5788466811053155663 4037409418259451775 0045610977169263993 3298903786046404753 4456223632834332176 7815264963537972858 8657669394381163308 7615245074831214398 3740852116228277996 5529595052006000261 4513532919056631645 8800133256033921718 8666583568833898780 6965481766615318033 7410422430398199200 6056256726585810395 5002088609693091534 1790726256523740481 1283149354348662917
(0.0 sec)
         infra time: 1.1
      hmm step time: 3.5
      total time: 5.6
[92mmulti-annotate-new-simu[0m          /home/dralph/work/partis/bin/partis annotate --dont-write-git-info --infname test/new-results-slow/test/simu.yaml --parameter-dir test/new-results-slow/test/parameters/simu --sw-cachefname test/new-results-slow/test/parameters/simu/sw-cache.yaml --plot-annotation-performance --simultaneous-true-clonal-seqs --is-simu --plotdir test/new-results-slow/multi-annotate-new-simu-annotation-performance --only-csv-plots --random-seed 1 --n-procs 10 --outfname test/new-results-slow/multi-annotate-new-simu.yaml
annotating    (with test/new-results-slow/test/parameters/simu/hmm)
smith-waterman
  vsearch: 1020 / 1026 v annotations (6 failed) with 40 v genes in 0.3 sec
        reading sw results from test/new-results-slow/test/parameters/simu/sw-cache.yaml
      info for 1026 / 1026 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 656 (0.639) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 55 queries with different true and inferred net shm indel lengths: 4777290622024385517 4732638098651962386 5956845155556020142 4999530475943846830 5529595052006000261 1420512012172628976 9137342635559226893 7345200321981110598 7410422430398199200 7423565846323818162 7911215360874970228 2659072139582755612 5788466811053155663 6056256726585810395 6350438668073464091 4513532919056631645 1149613973223769416 1051942552960780586 5998617262116711862 2084766260956091123 5002088609693091534 8800133256033921718 4037409418259451775 1790726256523740481 5210855817825286317 1632308509999052946 6013981858393765397 8599230751232947691 6573090021774117441 0045610977169263993 3298903786046404753 4456223632834332176 5443601811981978372 4600783374037304762 0425531810241509889 8666583568833898780 7815264963537972858 7997983189621976239 6891961031777574454 1283149354348662917 7093895658746756694 7722244057175391440 9219504801302075685 8657669394381163308 3845052717027318577 7135751034640280107 7615245074831214398 2587149021754440184 3740852116228277996 7336112427621948265 6884289445410691773 4584292685624034653 3784961526112309284 6965481766615318033 0501059967747087483
(0.0 sec)
        water time: 1.1
hmm
  --simultaneous-true-clonal-seqs: grouping seqs according to true partition
  [93mwarning[0m split apart 39 clusters that contained multiple cdr3 lengths (total clusters: 197 --> 242)
      cluster splits:  15 --> 1 14,   4 --> 3 1,   5 --> 1 4,   7 --> 1 6,   3 --> 2 1,  12 --> 1 11,  13 --> 1 11 1,   4 --> 1 2 1,   9 --> 8 1,  12 --> 1 11,   8 --> 1 6 1,  12 --> 1 11,   2 --> 1 1,   4 --> 1 2 1,   7 --> 1 6,   4 --> 3 1,  12 --> 1 11,  19 --> 18 1,  12 --> 1 11,   6 --> 1 5,   4 --> 1 3,  12 --> 1 11,   7 --> 1 5 1,   7 --> 6 1,  10 --> 1 9,   9 --> 8 1,   3 --> 1 2,   7 --> 6 1,   7 --> 1 6,   3 --> 2 1,   2 --> 1 1,  12 --> 1 11,  16 --> 1 15,   3 --> 1 2,   8 --> 7 1,  16 --> 15 1,   9 --> 8 1,  14 --> 1 1 12,   5 --> 4 1
  subcluster annotating 242 clusters: 
    running 10 procs
                    calcd:         vtb  443        fwd    0
             min-max time:  1.5 - 1.8 sec
    reading output
        read 443 hmm output lines with 1026 sequences in 443 events  (0 failures)
         infra time: 0.5
      hmm step time: 2.3
    read 443 new subcluster annotations: added hashid 307   whole finished 136   subcl finished 0
    running 10 procs
                    calcd:         vtb  134        fwd    0
             min-max time:  0.6 - 1.0 sec
    reading output
        read 134 hmm output lines with 307 sequences in 134 events  (0 failures)
         infra time: 0.1
      hmm step time: 1.2
    read 134 new subcluster annotations: added hashid 134   whole finished 0   subcl finished 79
    running 10 procs
                    calcd:         vtb   27        fwd    0
             min-max time:  0.2 - 0.5 sec
    reading output
        read 27 hmm output lines with 55 sequences in 27 events  (0 failures)
      hmm step time: 0.5
    read 27 new subcluster annotations: added hashid 27   whole finished 0   subcl finished 27
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 55 queries with different true and inferred net shm indel lengths: 3740852116228277996 3845052717027318577 6013981858393765397 3784961526112309284 1149613973223769416 4513532919056631645 0425531810241509889 7345200321981110598 1051942552960780586 5998617262116711862 6891961031777574454 7997983189621976239 4037409418259451775 0501059967747087483 1420512012172628976 5529595052006000261 7722244057175391440 4777290622024385517 5956845155556020142 5788466811053155663 2659072139582755612 5443601811981978372 6056256726585810395 0045610977169263993 7911215360874970228 4732638098651962386 7815264963537972858 4456223632834332176 2084766260956091123 2587149021754440184 6350438668073464091 6884289445410691773 7336112427621948265 9137342635559226893 8599230751232947691 4999530475943846830 9219504801302075685 6965481766615318033 7410422430398199200 8666583568833898780 7423565846323818162 6573090021774117441 8800133256033921718 7615245074831214398 3298903786046404753 5002088609693091534 1283149354348662917 4584292685624034653 8657669394381163308 7135751034640280107 7093895658746756694 1632308509999052946 5210855817825286317 1790726256523740481 4600783374037304762
(0.0 sec)
    subcluster annotation time 5.2
      total time: 7.2
[92mpartition-new-simu[0m               /home/dralph/work/partis/bin/partis partition --dont-write-git-info --infname test/new-results-slow/test/simu.yaml --parameter-dir test/new-results-slow/test/parameters/simu --sw-cachefname test/new-results-slow/test/parameters/simu/sw-cache.yaml --n-precache-procs 10 --plot-annotation-performance --is-simu --persistent-cachefname test/new-results-slow/cache-new-partition.csv --plotdir test/new-results-slow/partition-new-simu-annotation-performance --only-csv-plots --no-partition-plots --random-seed 1 --n-procs 10 --outfname test/new-results-slow/partition-new-simu.yaml
partitioning     (with test/new-results-slow/test/parameters/simu/hmm)
smith-waterman
  vsearch: 1020 / 1026 v annotations (6 failed) with 40 v genes in 0.3 sec
        reading sw results from test/new-results-slow/test/parameters/simu/sw-cache.yaml
      info for 1026 / 1026 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 656 (0.639) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 55 queries with different true and inferred net shm indel lengths: 4777290622024385517 4732638098651962386 5956845155556020142 4999530475943846830 5529595052006000261 1420512012172628976 9137342635559226893 7345200321981110598 7410422430398199200 7423565846323818162 7911215360874970228 2659072139582755612 5788466811053155663 6056256726585810395 6350438668073464091 4513532919056631645 1149613973223769416 1051942552960780586 5998617262116711862 2084766260956091123 5002088609693091534 8800133256033921718 4037409418259451775 1790726256523740481 5210855817825286317 1632308509999052946 6013981858393765397 8599230751232947691 6573090021774117441 0045610977169263993 3298903786046404753 4456223632834332176 5443601811981978372 4600783374037304762 0425531810241509889 8666583568833898780 7815264963537972858 7997983189621976239 6891961031777574454 1283149354348662917 7093895658746756694 7722244057175391440 9219504801302075685 8657669394381163308 3845052717027318577 7135751034640280107 7615245074831214398 2587149021754440184 3740852116228277996 7336112427621948265 6884289445410691773 4584292685624034653 3784961526112309284 6965481766615318033 0501059967747087483
(0.0 sec)
        water time: 1.1
hmm
caching all 1026 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 1026        fwd    0
                   merged:       hfrac    0     lratio    0
             min-max time:  2.1 - 2.4 sec
         infra time: 0.1
      hmm step time: 2.6
   collapsed 1026 queries into 572 clusters with identical naive seqs (0.0 sec)
572 clusters with 10 procs
       naive hfrac bounds: 0.015 0.096
    running 10 procs
          read from cache:  naive-seqs 1026   logprobs    0
                    calcd:         vtb  248        fwd  420
                   merged:       hfrac   64     lratio   38
             min-max time:  1.9 - 4.2 sec
         infra time: 0.3
      hmm step time: 4.5
470 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 1274   logprobs  420
                    calcd:         vtb   72        fwd  222
                   merged:       hfrac   41     lratio   25
             min-max time:  1.4 - 2.9 sec
         infra time: 0.2
      hmm step time: 3.2
404 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 1346   logprobs  642
                    calcd:         vtb   61        fwd  139
                   merged:       hfrac   47     lratio   11
             min-max time:  1.7 - 4.9 sec
         infra time: 0.3
      hmm step time: 5.3
346 clusters with 3 procs
    running 3 procs
          read from cache:  naive-seqs 1411   logprobs  781
                    calcd:         vtb   55        fwd  134
                   merged:       hfrac   45     lratio   13
             min-max time:  3.7 - 6.2 sec
         infra time: 0.2
      hmm step time: 6.4
288 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 1472   logprobs  915
                    calcd:         vtb   31        fwd   94
                   merged:       hfrac   28     lratio    6
             min-max time:  3.7 - 6.9 sec
         infra time: 0.2
      hmm step time: 7.1
254 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 1510   logprobs 1009
                    calcd:         vtb   22        fwd   58
                   merged:       hfrac   18     lratio    3
             min-max time:  2.7 - 5.3 sec
         infra time: 0.2
      hmm step time: 5.5
233 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 1532   logprobs 1067
                    calcd:         vtb    7        fwd   34
                   merged:       hfrac    6     lratio    1
             min-max time:  1.9 - 2.8 sec
         infra time: 0.2
      hmm step time: 3.0
226 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 1539   logprobs 1101
                    calcd:         vtb    5        fwd   18
                   merged:       hfrac    4     lratio    1
             min-max time:  1.2 - 1.3 sec
         infra time: 0.2
      hmm step time: 1.5
221 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 1544   logprobs 1119
                    calcd:         vtb    3        fwd  148
                   merged:       hfrac    2     lratio    1
                     time:  7.3 sec
         infra time: 0.1
      hmm step time: 7.5
  [93mnote[0m not merging entire cpath history
      loop time: 44.0
getting annotations for final partition
  subcluster annotating 218 clusters: 
    running 10 procs
                    calcd:         vtb  433        fwd    0
             min-max time:  1.5 - 1.8 sec
    reading output
        read 433 hmm output lines with 1026 sequences in 433 events  (0 failures)
         infra time: 0.5
      hmm step time: 2.4
    read 433 new subcluster annotations: added hashid 310   whole finished 123   subcl finished 0
    running 10 procs
                    calcd:         vtb  130        fwd    0
             min-max time:  0.7 - 1.1 sec
    reading output
        read 130 hmm output lines with 310 sequences in 130 events  (0 failures)
      hmm step time: 1.2
    read 130 new subcluster annotations: added hashid 130   whole finished 0   subcl finished 69
    running 10 procs
                    calcd:         vtb   28        fwd    0
             min-max time:  0.2 - 0.5 sec
    reading output
        read 28 hmm output lines with 61 sequences in 28 events  (0 failures)
      hmm step time: 0.6
    read 28 new subcluster annotations: added hashid 28   whole finished 0   subcl finished 24
    running 10 procs
                    calcd:         vtb    2        fwd    0
             min-max time:  0.0 - 0.3 sec
    reading output
        read 2 hmm output lines with 4 sequences in 2 events  (0 failures)
      hmm step time: 0.3
    read 2 new subcluster annotations: added hashid 2   whole finished 0   subcl finished 2
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 55 queries with different true and inferred net shm indel lengths: 7135751034640280107 0045610977169263993 7911215360874970228 4513532919056631645 6965481766615318033 6573090021774117441 8599230751232947691 8800133256033921718 0425531810241509889 0501059967747087483 1051942552960780586 1149613973223769416 1283149354348662917 1420512012172628976 1632308509999052946 1790726256523740481 2084766260956091123 2587149021754440184 2659072139582755612 3298903786046404753 3740852116228277996 3784961526112309284 3845052717027318577 4037409418259451775 4456223632834332176 4584292685624034653 4600783374037304762 4732638098651962386 4777290622024385517 4999530475943846830 5002088609693091534 5210855817825286317 5443601811981978372 5529595052006000261 5788466811053155663 5956845155556020142 5998617262116711862 6013981858393765397 6056256726585810395 6350438668073464091 6884289445410691773 6891961031777574454 7093895658746756694 7336112427621948265 7345200321981110598 7410422430398199200 7423565846323818162 7615245074831214398 7722244057175391440 7815264963537972858 7997983189621976239 8657669394381163308 8666583568833898780 9137342635559226893 9219504801302075685
(0.0 sec)
    subcluster annotation time 5.7
      total time: 55.5
[92mseed-partition-new-simu[0m          /home/dralph/work/partis/bin/partis partition --dont-write-git-info --infname test/new-results-slow/test/simu.yaml --parameter-dir test/new-results-slow/test/parameters/simu --sw-cachefname test/new-results-slow/test/parameters/simu/sw-cache.yaml --is-simu --persistent-cachefname test/new-results-slow/cache-new-partition.csv --seed-unique-id 3199440326939429484 --random-seed 1 --n-procs 10 --outfname test/new-results-slow/seed-partition-new-simu.yaml
partitioning     (with test/new-results-slow/test/parameters/simu/hmm)
smith-waterman
  vsearch: 1020 / 1026 v annotations (6 failed) with 40 v genes in 0.3 sec
        reading sw results from test/new-results-slow/test/parameters/simu/sw-cache.yaml
      info for 1026 / 1026 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 656 (0.639) unproductive
      removed 947 / 1026 = 0.92 sequences with cdr3 length different from seed sequence (leaving 79)
        water time: 0.5
hmm
   collapsed 79 queries into 40 clusters with identical naive seqs (0.0 sec)
40 clusters with 10 procs
       naive hfrac bounds: 0.015 0.096
    running 10 procs
          read from cache:  naive-seqs 1548   logprobs 1267
                    calcd:         vtb   25        fwd    7
                   merged:       hfrac    2     lratio    0
             min-max time:  0.1 - 0.3 sec
         infra time: 0.1
      hmm step time: 0.4
47 clusters with 7 procs
  [93mwarning[0m cluster occurs 8 times in the <nsets> we're sending to bcrham: 7880156369886939406:3199440326939429484:8714409258097677271:6150363217392689565
    running 7 procs
          read from cache:  naive-seqs 1564   logprobs 1273
                    calcd:         vtb    0        fwd    3
                   merged:       hfrac    0     lratio    0
             min-max time:  0.0 - 0.1 sec
         infra time: 0.1
      hmm step time: 0.3
44 clusters with 5 procs
  [93mwarning[0m cluster occurs 5 times in the <nsets> we're sending to bcrham: 7880156369886939406:3199440326939429484:8714409258097677271:6150363217392689565
    running 5 procs
          read from cache:  naive-seqs 1564   logprobs 1276
                    calcd:         vtb    0        fwd    0
                   merged:       hfrac    0     lratio    0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/281072/hmm_cached_info.csv
      hmm step time: 0.1
      removed 73 sequences in unseeded clusters, split 5 seeded clusters into 6 singletons, and merged these into 3 clusters with identical naive seqs
        new n_procs 1 (initial seqs/proc: 7.90   new seqs/proc: 3.00
3 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 1564   logprobs 1276
                    calcd:         vtb    0        fwd    2
                   merged:       hfrac    2     lratio    0
                     time:  0.1 sec
      hmm step time: 0.1
      loop time: 1.0
getting annotations for final partition
  subcluster annotating 1 cluster: 
    running 1 proc
                    calcd:         vtb    2        fwd    0
                     time:  0.1 sec
    reading output
        read 2 hmm output lines with 6 sequences in 2 events  (0 failures)
      hmm step time: 0.1
    read 2 new subcluster annotations: added hashid 2   whole finished 0   subcl finished 0
    running 1 proc
                    calcd:         vtb    1        fwd    0
                     time:  0.1 sec
    reading output
        read 1 hmm output lines with 2 sequences in 1 events  (0 failures)
      hmm step time: 0.1
    read 1 new subcluster annotation: added hashid 1   whole finished 0   subcl finished 1
    subcluster annotation time 0.3
  seed cluster size in best partition: 6, excluding seed seq: 5
      total time: 2.8
[92mvsearch-partition-new-simu[0m       /home/dralph/work/partis/bin/partis partition --dont-write-git-info --infname test/new-results-slow/test/simu.yaml --parameter-dir test/new-results-slow/test/parameters/simu --sw-cachefname test/new-results-slow/test/parameters/simu/sw-cache.yaml --naive-vsearch --is-simu --persistent-cachefname test/new-results-slow/cache-new-partition.csv --random-seed 1 --n-procs 10 --outfname test/new-results-slow/vsearch-partition-new-simu.yaml
partitioning     (with test/new-results-slow/test/parameters/simu/hmm)
smith-waterman
  vsearch: 1020 / 1026 v annotations (6 failed) with 40 v genes in 0.3 sec
        reading sw results from test/new-results-slow/test/parameters/simu/sw-cache.yaml
      info for 1026 / 1026 = 1.000   (removed: 0 failed, 0 duplicates)
      kept 656 (0.639) unproductive
        water time: 0.5
hmm
       naive hfrac bounds: 0.027 0.027
        collapsed 1026 sequences into 572 unique naive sequences
    using hfrac bound for vsearch 0.027
    running vsearch 48 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 3.0
getting annotations for final partition
  subcluster annotating 233 clusters: 
    running 10 procs
                    calcd:         vtb  443        fwd    0
             min-max time:  1.5 - 1.9 sec
    reading output
        read 443 hmm output lines with 1026 sequences in 443 events  (0 failures)
         infra time: 0.5
      hmm step time: 2.5
    read 443 new subcluster annotations: added hashid 298   whole finished 145   subcl finished 0
    running 10 procs
                    calcd:         vtb  125        fwd    0
             min-max time:  0.7 - 0.9 sec
    reading output
        read 125 hmm output lines with 298 sequences in 125 events  (0 failures)
      hmm step time: 1.0
    read 125 new subcluster annotations: added hashid 125   whole finished 0   subcl finished 64
    running 10 procs
                    calcd:         vtb   28        fwd    0
             min-max time:  0.2 - 0.4 sec
    reading output
        read 28 hmm output lines with 61 sequences in 28 events  (0 failures)
      hmm step time: 0.5
    read 28 new subcluster annotations: added hashid 28   whole finished 0   subcl finished 20
    running 10 procs
                    calcd:         vtb    4        fwd    0
             min-max time:  0.0 - 0.3 sec
    reading output
        read 4 hmm output lines with 8 sequences in 4 events  (0 failures)
      hmm step time: 0.3
    read 4 new subcluster annotations: added hashid 4   whole finished 0   subcl finished 4
    subcluster annotation time 4.9
      total time: 9.4
[92mget-selection-metrics-new-simu[0m   /home/dralph/work/partis/bin/partis get-selection-metrics --dont-write-git-info --random-seed 1 --n-procs 10 --outfname test/new-results-slow/partition-new-simu.yaml --selection-metric-fname test/new-results-slow/get-selection-metrics-new-simu.yaml --ab-choice-cfg /home/dralph/work/partis/test/ab-choice-slow.yaml
  note: --parameter-dir not set, so using default: xxx-dummy-xxx
getting selection metrics
    calculating selection metrics for 26 clusters with sizes: 51 43 24 22 18 17 15 15 15 14 13 13 12 12 12 11 11 11 11 11 11 11 10 10 10 10
      skipping 192 smaller than 10
    inf tree: calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 20 = 0.0500 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 0): skipped 86/93 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
    (AA inf tree, iclust 0): calculating normalized lb metrics with tau values 0.0025 (lbi) and 0.0025 * 20 = 0.0500 (lbr)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 1): skipped 81/83 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 2): skipped 43/45 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 3): skipped 41/42 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 4): skipped 12/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 5): skipped 23/28 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 6): skipped 27/28 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 7): skipped 9/18 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 8): skipped 23/26 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 9): skipped 23/25 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 10): skipped 23/24 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 11): skipped 23/24 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 12): skipped 21/22 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 13): skipped 20/21 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 14): skipped 19/21 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 15): skipped 17/19 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 16): skipped 19/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 17): skipped 15/18 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 18): skipped 19/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 19): skipped 19/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 20): skipped 17/19 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 21): skipped 19/20 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 22): skipped 15/17 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 23): skipped 17/18 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 24): skipped 11/15 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      [93mwarning[0m get_aa_tree() (AA inf tree, iclust 25): skipped 9/14 edges for which we didn't have sequences for both nodes (i.e. left the original branch length unmodified)
      tree origins: 26 made from cpath
  writing selection metrics to test/new-results-slow/get-selection-metrics-new-simu.yaml
      total time: 4.8
